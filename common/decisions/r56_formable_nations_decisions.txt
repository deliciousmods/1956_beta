unite_the_levant_category = {
    form_greater_syria = {
        icon = generic_form_nation

        allowed = {
            OR = {
                original_tag = LEB
                original_tag = SYR
                original_tag = PAL
                original_tag = JOR
            }
        }
        fire_only_once = yes
        available = {
            is_subject = no
            custom_trigger_tooltip = {
                tooltip = form_country_levant_required_states_tt
                all_state = {
                    OR = {
                        NOT = { OR = { is_core_of = SYR is_core_of = LEB is_core_of = PAL is_core_of = JOR } }
                        is_core_of = TUR
                        is_controlled_by = ROOT
                    }
                }
            }
            NOT = { has_cosmetic_tag = ARA_UNIFIED }
        }
        complete_effect = {
            set_cosmetic_tag = SYR_UNIFIED
            set_province_name = { id = 1086 name = "Al-Quds" }
            every_state = {
                limit = { is_core_of = CYP is_core_of = IRQ is_core_of = JOR is_core_of = LEB is_core_of = PAL is_core_of = SYR }
                add_core_of = ROOT
                #Cyprus, Siria, Libano, Palestina, Jordan, Iraq, Kuwait (656)
            }
            
            453 = { add_claim_by = ROOT } #Sinai
            344 = { add_claim_by = ROOT } #Adana

            350 = { add_claim_by = ROOT }
            352 = { add_claim_by = ROOT }

            413 = { add_claim_by = ROOT }
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
        }

        ai_will_do = {
            factor = 200
            modifier = {
                factor = 0
                is_historical_focus_on = yes
            }
        }
    }
}

form_peru_bolivia_category = {
    form_peru_bolivia = {
        fire_only_once = yes
        icon = generic_form_nation
        
        allowed = {
            OR = {
                original_tag = PRU
                original_tag = BOL
            }
        }
        available = {
            NOT = { has_country_flag = formed_peru_bolivia }
            all_state = {
                OR = {
                    NOT = { is_core_of = PRU }
                    is_core_of = ECU
                    is_controlled_by = ROOT
                }
            }
            all_state = {
                OR = {
                    NOT = { is_core_of = BOL }
                    is_core_of = PAR
                    is_core_of = CHL
                    is_controlled_by = ROOT
                }
            }
        }
        
        complete_effect = {
            set_country_flag = formed_peru_bolivia
            set_cosmetic_tag = PRB
            688 = { add_core_of = ROOT }
            506 = { add_core_of = ROOT }
            490 = { add_core_of = ROOT }
        }
        remove_effect = {
            hidden_effect = {
                every_state = {
                    limit = {
                        OR = { is_core_of = BOL is_core_of = PRU }
                    }
                    add_core_of = PREV
                }
            }
        }
        remove_effect = {
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
        }
        ai_will_do = {
            factor = 1
        }
    }
}

form_prussia_category = {

    form_prussia = {
        icon = generic_form_nation
        cost = 0
        fire_only_once = yes

        allowed = { original_tag = DNZ }
    
        available = {
            controls_state = 64
            controls_state = 68
            controls_state = 63
            controls_state = 66
            controls_state = 67
            controls_state = 810
            controls_state = 86
            controls_state = 762
            controls_state = 85
            controls_state = 62
        }
        
        ai_will_do = {
            factor = 150
        }
        
        visible = {
            OR = {
                controls_state = 64
                controls_state = 5
                controls_state = 63
                controls_state = 810
                has_completed_focus = DNZ_prussia_legacy
            }
        }
        
        modifier = { }
        
        complete_effect = {
            add_state_core = 64
            add_state_core = 68
            add_state_core = 63
            add_state_core = 66
            add_state_core = 67
            add_state_core = 810
            add_state_core = 86
            add_state_core = 762
            add_state_core = 763
            add_state_core = 188
            add_state_core = 85
            add_state_core = 62
            #set_cosmetic_tag = PRS
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
        }
    }
}

recreate_belgium_category = {

    recreate_belgium = {
        allowed = {
            OR = {
                original_tag = WLL
                original_tag = VLA
            }
        }
        fire_only_once = yes
        available = {
            if = {
                limit = { original_tag = VLA }
                NOT = { has_government = fascism }
            }
            is_subject = no
            6 = { is_controlled_by = ROOT }
            34 = { is_controlled_by = ROOT }
        }
        icon = generic_form_nation
        complete_effect = {
#            set_cosmetic_tag = BEL_REUNIFIED
            set_country_flag = reunified_belgium_flag

            if = {
                limit  = {
                    ROOT = { has_government = democratic }
                }
                if = {
                    limit = { BEL = { democratic < 0.5 } }
                    BEL = {
                        add_popularity = { ideology = democratic popularity = 0.33 }
                        set_politics = {
                            ruling_party = democratic elections_allowed = yes
                        }
                    }
                }
                else = {
                    BEL = {
                        unlock_national_focus = tblra_form_coalition_government
                    }
                }
            }

            if = {
                limit  = {
                    ROOT = { has_government = neutrality }
                }
                if = {
                    limit = {
                        BEL = { neutrality < 0.5 }
                    }
                    BEL = {
                        add_popularity = { ideology = neutrality popularity = 0.33 }
                        set_politics = {
                            ruling_party = neutrality elections_allowed = yes
                        }
                    }
                }
                else = {
                    BEL = {
                        unlock_national_focus = tblra_king_reaction
                    }
                }
            }

            if = {
                limit  = {
                    ROOT = { has_government = communism }
                }
                if = {
                    limit  = {
                        BEL = { communism < 0.5 }
                    }
                    BEL = {
                        add_popularity = { ideology = communism popularity = 0.33 }
                        set_politics = {
                            ruling_party = communism elections_allowed = no
                        }
                    }
                }
                if = { #Check. If exclusive, then use else_if.
                    limit  = {
                        BEL = { has_idea = tblra_leopold3 }
                    }
                    BEL = {
                        swap_ideas = {
                            remove_idea = tblra_leopold3
                            add_idea = tblra_leopold3_exile
                        }
                    }
                }
                else = {
                    BEL = {
                        unlock_national_focus = tblra_go_left
                    }
                }
            }

            else = { #Fascist branch
#                limit = { ROOT = { has_government = fascism } }
                if = {
                    limit  = {
                        BEL = { fascism < 0.5 }
                    }
                    BEL = {
                        add_popularity = { ideology = fascism popularity = 0.33 }
                        set_politics = {
                             ruling_party = fascism elections_allowed = no
                        }
                    }
                }
                if = { #Check. If exclusive, then use else_if.
                    limit  = {
                        BEL = { has_idea = tblra_leopold3 }
                    }
                    BEL = {
                        swap_ideas = {
                            remove_idea = tblra_leopold3
                            add_idea = tblra_leopold3_exile
                        }
                    }
                }
                else = {
                    BEL = {
                        unlock_national_focus = tblra_go_right
                        unlock_national_focus = tblra_choose_Rex
                    }
                }
            }

            BEL = {
                set_capital = 6
                add_ideas = generic_recent_political_unification
                add_ideas = generic_recent_army_unification
                add_ideas = generic_recent_economic_unification
                set_country_flag = tblra_1936_election
                annex_country = {
                    target = ROOT
                    transfer_troops = yes
                }
                change_tag_from = ROOT
            }
            VLA = {
                every_unit_leader = {
                    set_nationality = BEL
                }
                # exclude regional nationalists
            }
            WLL = {
                every_unit_leader = {
                    set_nationality = BEL
                }
            }
        }

        ai_will_do = {
            factor = 200
            modifier = {
                factor = 0
                is_historical_focus_on = yes
            }
        }
    }
}

form_united_netherlands_category2 = {
    form_united_netherlands2_BEL = {
        icon = generic_form_nation

        allowed = { original_tag = BEL }
        visible = {
            NOT = { has_global_flag = form_united_netherlands_flag }
        }
        available = {
            is_subject = no
            OR = {
                has_country_flag = Chose_Verdinaso
                has_completed_focus = tblra_go_left
            }
        
            # Netherlands
                custom_trigger_tooltip = {
                    tooltip = form_eu_netherlands_required_states_tt
                    controls_state = 7
                    controls_state = 35
                    controls_state = 36
                    owns_state = 7
                    owns_state = 35
                    owns_state = 36
                }
            # Belgium
                custom_trigger_tooltip = {
                    tooltip = form_eu_belgium_required_states_tt
                    controls_state = 6
                    controls_state = 34
                    owns_state = 6
                    owns_state = 34
                }
            }

        complete_effect = {
            custom_effect_tooltip = form_eu_netherlands_coring_states_tt
            hidden_effect = {
                set_cosmetic_tag = BEL5
                every_state = {
                    limit = { region = 5 NOT = { state = 8 } }
                    add_core_of = ROOT
                }
            }
            hidden_effect = {
                news_event = { id = wtt_news.58 hours = 6 }
                set_global_flag = form_united_netherlands_flag
            }
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
        }
        ai_will_do = {
            factor = 200
            modifier = {
                factor = 0
                is_historical_focus_on = yes
            }
        }
    }

    form_united_netherlands2_HOL = {
        icon = generic_form_nation

        allowed = { original_tag = HOL }

        visible = {
            NOT = { has_global_flag = form_united_netherlands_flag }
        }

        available = {
            is_subject = no
            OR = {
                has_government = fascism
                has_government = communism
            }
            # Netherlands
                custom_trigger_tooltip = {
                    tooltip = form_eu_netherlands_required_states_tt
                    controls_state = 7
                    controls_state = 35
                    controls_state = 36
                    owns_state = 7
                    owns_state = 35
                    owns_state = 36
                }
            # Belgium
                custom_trigger_tooltip = {
                    tooltip = form_eu_belgium_required_states_tt
                    controls_state = 6
                    controls_state = 34
                    owns_state = 6
                    owns_state = 34
                }
            }

        complete_effect = {
            custom_effect_tooltip = form_eu_belgium_coring_states_tt
            hidden_effect = {
                set_cosmetic_tag = BEL5
                every_state = {
                    limit = { region = 5 NOT = { state = 8 } }
                    add_core_of = ROOT
                }
            }
            hidden_effect = {
                news_event = { id = wtt_news.58 hours = 6 }
                set_global_flag = form_united_netherlands_flag
            }
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
        }
        ai_will_do = {
            factor = 200
            modifier = {
                factor = 0
                is_historical_focus_on = yes
            }
        }
    }
}

form_carribean_category = {
    form_caribbean = {
        icon = generic_form_nation
        days_re_enable = 0
        
        allowed = {
            OR = {
                original_tag = DOM
                original_tag = HAI
                original_tag = CUB
            }
        }
        fire_only_once = yes
        available = {
            315 = { is_controlled_by = ROOT }
            318 = { is_controlled_by = ROOT }
            319 = { is_controlled_by = ROOT }
        }
        complete_effect = {
            set_cosmetic_tag = CAB
            hidden_effect = {
                every_state = { #This has a day of lag, for reasons
                    limit = {
                        OR = { is_core_of = CUB is_core_of = DOM is_core_of = HAI }
                    }
                    add_core_of = ROOT
                }
            }
            every_state = { #This has a day of lag, for reasons
                limit = {
                    OR = { is_core_of = TRI is_core_of = PUE is_core_of = BAS is_core_of = GDL is_core_of = BAH is_core_of = CRC is_core_of = JAM     }
                }
                add_core_of = ROOT
            }
        }
        ai_will_do = {
            factor = 50
        }
    }
}

ENG_restore_the_UK = {
    unite_britain = {
        days_re_enable = 0
        fire_only_once = yes
        
        visible = { original_tag = ENG }
        available = { #Scotland & Wales
            is_subject = no
            all_state = {
                OR = {
                    is_core_of = SCO 
                    is_core_of = WLS
                    state = 812
                }
                OR = {
                    is_controlled_by = ROOT
                    OWNER = {
                        is_puppet_of = ROOT
                    }
                }
                
            }
            #119 = { is_controlled_by = ROOT }
        }
        icon = eng_install_government

        complete_effect = {
            drop_cosmetic_tag = yes
            every_state = {
                limit = {
                    OR = {
                        is_core_of = SCO 
                        is_core_of = WLS
                        state = 119
                    }
                }
                add_core_of = ROOT
            }
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
        }
        ai_will_do = {
            factor = 50
        }
    }
}

celtic_unification_category = {
    form_celtic_union = {
        icon = generic_form_nation
        fire_only_once = yes
        allowed = {
            OR = {
                original_tag = SCO
                original_tag = IRE
                original_tag = NIR
                original_tag = BRI
                original_tag = WLS
            }
        }
        available = {
            is_subject = no
            #IRE
            113 = { is_controlled_by = ROOT }
            119 = { is_controlled_by = ROOT }
            134 = { is_controlled_by = ROOT }
            135 = { is_controlled_by = ROOT }
            #WLS
            122 = { is_controlled_by = ROOT }
            #SCO
            133 = { is_controlled_by = ROOT }
            121 = { is_controlled_by = ROOT }
            136 = { is_controlled_by = ROOT }
            120 = { is_controlled_by = ROOT }
            841 = { is_controlled_by = ROOT }
            #BRI
            14 = { is_controlled_by = ROOT }
        }
        complete_effect = {
            set_cosmetic_tag = CEL_UNIFIED
            hidden_effect = {
                113 = { add_core_of = ROOT }
                119 = { add_core_of = ROOT }
                114 = { add_core_of = ROOT }
                134 = { add_core_of = ROOT }
                135 = { add_core_of = ROOT }
                122 = { add_core_of = ROOT }
                133 = { add_core_of = ROOT }
                121 = { add_core_of = ROOT }
                136 = { add_core_of = ROOT }
                120 = { add_core_of = ROOT }
                841 = { add_core_of = ROOT }
                14 = { add_core_of = ROOT }
            }
            123 = { add_core_of = ROOT }
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
            set_party_name = {
                ideology = neutrality
                long_name = CEL_UNIFIED_neutrality_party_long
                name = CEL_UNIFIED_neutrality_party
            }
            set_party_name = {
                ideology = democratic
                long_name = CEL_UNIFIED_democratic_party_long
                name = CEL_UNIFIED_democratic_party
            }
            set_party_name = {
                ideology = communism
                long_name = CEL_UNIFIED_communism_party_long
                name = CEL_UNIFIED_communism_party
            }
            set_party_name = {
                ideology = fascism
                long_name = CEL_UNIFIED_fascism_party_long
                name = CEL_UNIFIED_fascism_party
            }
        }

        ai_will_do = {
            factor = 200
            modifier = {
                factor = 0
                is_historical_focus_on = yes
            }
        }
    }

    CEL_UNIFIED_integrate_galicia = {
        icon = generic_form_nation

        allowed = {
            OR = {
                original_tag = SCO
                original_tag = IRE
                original_tag = NIR
                original_tag = BRI
                original_tag = WLS
            }
        }

        cost = 50

        available = {
            is_subject = no
            # Galicia
            controls_state = 171
            171 = { compliance > 40 }
        }

        visible = {
            has_cosmetic_tag = CEL_UNIFIED
        }

        days_remove = 90
        
        remove_effect = {
            171 = { add_core_of = ROOT }
        }

        ai_will_do = {
            factor = 200
            modifier = {
                factor = 0
                is_historical_focus_on = yes
            }
        }
    }
}

form_turkestan_category = {
    form_turkestan = {
        icon = generic_form_nation
        fire_only_once = yes

        allowed = {
            OR = {
                original_tag = KAZ
                original_tag = UZB
                original_tag = TMS
                original_tag = TAJ
                original_tag = KYR
                original_tag = TAN
                #AND = { #Can't add Sinkiang until a solution is found regarding the political struggle in China
                #    original_tag = SIK
                #    NOT = {
                #        tag = event_target:WTT_current_china_leader
                #    }
                #}
            }
        }

        available = {
            is_subject = no
            # Kazakhstan
            custom_trigger_tooltip = {
                tooltip = form_country_kazakhstan_required_states_tt
                all_state = {
                    OR = {
                        NOT = { is_core_of = KAZ }
                        is_controlled_by = ROOT
                    }
                }
            }
            # Uzbekistan
            custom_trigger_tooltip = {
                tooltip = form_country_uzbekistan_required_states_tt
                controls_state = 405
                controls_state = 585
            }
            # Turkmenistan
            custom_trigger_tooltip = {
                tooltip = form_country_turkmenistan_required_states_tt
                controls_state = 584
            }
            # Tajikistan
            custom_trigger_tooltip = {
                tooltip = form_country_tajikistan_required_states_tt
                controls_state = 742
            }
            # Kyrgyzstan
            custom_trigger_tooltip = {
                tooltip = form_country_kyrgyzstan_required_states_tt
                controls_state = 732
            }
        }

        complete_effect = {
            set_cosmetic_tag = TRK_UNITED
            hidden_effect = {
                every_state = {
                    limit = {
                        OR = {
                            region = 136 #The Great Steppe, contains most of the provinces.
                            region = 145 #Sinkiang
                            is_core_of = TAN #Tannu Tuva
                            is_core_of = KAZ #Kazakhstan
                        }
                    }
                    add_core_of = ROOT
                }
            }
            # Kazakhstan
            custom_effect_tooltip = form_country_kazakhstan_coring_states_tt
            # Uzbekistan
            custom_effect_tooltip = form_country_uzbekistan_coring_states_tt
            # Turkmenistan
            custom_effect_tooltip = form_country_turkmenistan_coring_states_tt
            # Tajikistan
            custom_effect_tooltip = form_country_tajikistan_coring_states_tt
            # Kyrgyzstan
            custom_effect_tooltip = form_country_kyrgyzstan_coring_states_tt
            #Uyguristan - Sinkiang
            custom_effect_tooltip = form_country_sinkiang_coring_states_tt
            654 = { add_core_of = ROOT }
#            329 = { add_core_of = ROOT }

            ROOT = {
                add_state_claim = 40
                add_state_claim = 570

                add_state_claim = 569
                add_state_claim = 572
                add_state_claim = 582
                add_state_claim = 651

                add_state_claim = 652
                add_state_claim = 251
                add_state_claim = 249

                add_state_claim = 401
                add_state_claim = 236
            }
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
            hidden_effect = {
                #news_event = { id = wtt_news.1003 hours = 6 }
                #country_event = { id = armenia.28 days = 2 }
                set_global_flag = turkestan_formed
            }
        }

        ai_will_do = {
            factor = 200
            modifier = {
                factor = 0
                is_historical_focus_on = yes
            }
        }
    }
}

form_nation_mod_category = {

    form_la_plata = {
        fire_only_once = yes
        icon = generic_form_nation
        days_re_enable = 0

        allowed = {
            OR = {
                original_tag = BOL
                original_tag = ARG
                original_tag = URG
                original_tag = PAR
                original_tag = CHL
            }

        }
        visible = {
            if = {
                limit = {
                    original_tag = CHL
                }
                NOT = { has_country_flag = r56_hide_formables }
            }            
        }
        available = { #Argentina, Uruguay, Paraguay
            all_state = {
                OR = {
                    NOT = { is_core_of = ARG }
                    is_controlled_by = ROOT
                }
            }
            all_state = {
                OR = {
                    NOT = { is_core_of = URG }
                    is_controlled_by = ROOT
                }
            }
            all_state = {
                OR = {
                    NOT = { is_core_of = PAR }
                    is_controlled_by = ROOT
                }
            }
        }
        complete_effect = {
            set_cosmetic_tag = PLA
            if = {
                limit = {
                    278 = { is_capital = no }
                }
                set_capital = 278
            }
            hidden_effect = {
                every_state = { #This has a day of lag, for some reason.
                    limit = { OR = { is_core_of = ARG is_core_of = PAR is_core_of = URG } }
                    add_core_of = PREV #ROOT
                }
                506 = { add_core_of = ROOT }
            }
            299 = { add_claim_by = ROOT }
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
        }

        ai_will_do = {
            factor = 50
        }
    }

    reunite_germany = {
        days_re_enable = 0

        allowed = {
            OR = {
                original_tag = WGR
                original_tag = DDR
                original_tag = SAX
                original_tag = HAN
                original_tag = MEK
                original_tag = SHL
                original_tag = WUR
                original_tag = PRE
                original_tag = BAY
                original_tag = BAD
                original_tag = DNZ
            }
        }
        fire_only_once = yes
        available = {
            is_subject = no
            42 = { is_controlled_by = ROOT }
            50 = { is_controlled_by = ROOT }
            51 = { is_controlled_by = ROOT }
            52 = { is_controlled_by = ROOT }
            53 = { is_controlled_by = ROOT }
            54 = { is_controlled_by = ROOT }
            55 = { is_controlled_by = ROOT }
            56 = { is_controlled_by = ROOT }
            57 = { is_controlled_by = ROOT }
            58 = { is_controlled_by = ROOT }
            59 = { is_controlled_by = ROOT }
            807 = { is_controlled_by = ROOT }
            808 = { is_controlled_by = ROOT }
            809 = { is_controlled_by = ROOT }
            #DDR IRL
            60 = { is_controlled_by = ROOT }
            61 = { is_controlled_by = ROOT }
            62 = { is_controlled_by = ROOT }
            64 = { is_controlled_by = ROOT }
            65 = { is_controlled_by = ROOT }
            #119 = { is_controlled_by = ROOT }
        }
        icon = generic_form_nation
        complete_effect = { #Region 7: 42, 50, 51, 52, 53, 54, 55, 807, 808, 809
            every_state = {
                limit = { region = 7 }
                add_core_of = ROOT
            }

            56 = { add_core_of = ROOT }
            57 = { add_core_of = ROOT }
            58 = { add_core_of = ROOT }
            59 = { add_core_of = ROOT }

            60 = { add_core_of = ROOT }
            61 = { add_core_of = ROOT }
            62 = { add_core_of = ROOT }
            64 = { add_core_of = ROOT }
            65 = { add_core_of = ROOT }
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
            set_country_flag = reunited_germany
            set_cosmetic_tag = GER_REUNITED
        }
        ai_will_do = {
            factor = 50
        }
    }

    reintegrate_lands_beyond_the_oder_neisse_line = {
        days_re_enable = 0

        allowed = {
            OR = {
                original_tag = WGR
                original_tag = SAX
                original_tag = HAN
                original_tag = MEK
                original_tag = SHL
                original_tag = WUR
                original_tag = BAY
                original_tag = BAD
                original_tag = DNZ
            }
        }
        visible = { has_country_flag = reunited_germany }
        fire_only_once = yes
        available = {
            is_subject = no
            63 = { is_controlled_by = ROOT }
            66 = { is_controlled_by = ROOT }
            67 = { is_controlled_by = ROOT }
            68 = { is_controlled_by = ROOT }
            5 = { is_controlled_by = ROOT }
            763 = { is_controlled_by = ROOT }
        }
        icon = generic_form_nation
        complete_effect = {
            every_state = {
                limit = { region = 8 NOT = { is_core_of = ROOT } }
                add_core_of = ROOT
            }
            5 = { add_core_of = ROOT }
            763 = { add_core_of = ROOT }
        }
        ai_will_do = {
            factor = 50
        }
    }

    form_idel_ural = {
        icon = generic_form_nation
        fire_only_once = yes
        allowed = { original_tag = TTS }

        available = {
            is_subject = no
            controls_state = 652
            controls_state = 251
            controls_state = 651
            controls_state = 582
            controls_state = 401
        }

        complete_effect = {
            652 = { add_core_of = ROOT }
            251 = { add_core_of = ROOT }
            651 = { add_core_of = ROOT }
            582 = { add_core_of = ROOT }
            401 = { add_core_of = ROOT }
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
            set_country_flag = reunited_idel_ural
            set_cosmetic_tag = IDEL_URAL
        }

        ai_will_do = {
            factor = 200
        }
    }


    form_sardinia_piedmont = {
        icon = generic_form_nation
        fire_only_once = yes
        allowed = { original_tag = SAD }

        available = {
            is_subject = no
            controls_state = 114
            controls_state = 158
        }

        visible = {
            NOT = {
                has_cosmetic_tag = ITA_REBORN
            }
        }

        complete_effect = {
            158 = { add_core_of = ROOT }
            
            set_country_flag = formed_sardinia_piedmont
            set_cosmetic_tag = SAD_PIEDMONT
        }

        ai_will_do = {
            factor = 200
        }
    }

	reunite_italy = {

		icon = generic_form_nation

		allowed = {
			
			OR = {
                original_tag = SIC
                original_tag = SAD
                original_tag = VNZ
                original_tag = NAP
			}
		}

		available = {
			is_subject = no
			NOT = {
				has_idea = generic_recent_political_unification
				has_idea = generic_recent_army_unification
				has_idea = generic_recent_economic_unification		
			}
			# Italy
			custom_trigger_tooltip = {
				tooltip = form_eu_italy_required_states_tt
				controls_state = 158
				controls_state = 159
				controls_state = 39
				controls_state = 160
				controls_state = 161
				controls_state = 162
				controls_state = 157
				controls_state = 2
				controls_state = 117
				controls_state = 114
				controls_state = 156
				controls_state = 115
				controls_state = 736
				controls_state = 163
            }
            NOT = {
                country_exists = ITA
            }
		}

        fire_only_once = yes

		visible = {

			
		}

		complete_effect = {
			# Italy
			custom_effect_tooltip = form_eu_italy_coring_states_tt
			hidden_effect = {
				158 = { add_core_of = ROOT }
				159 = { add_core_of = ROOT }
				39 = { add_core_of = ROOT }
				160 = { add_core_of = ROOT }
				161 = { add_core_of = ROOT }
				162 = { add_core_of = ROOT }
				157 = { add_core_of = ROOT }
				2 = { add_core_of = ROOT }
				117 = { add_core_of = ROOT }
				156 = { add_core_of = ROOT }
				115 = { add_core_of = ROOT }
				736 = { add_core_of = ROOT }
				163 = { add_core_of = ROOT }
				114 = { add_core_of = ROOT }
				838 = { add_core_of = ROOT }
				837 = { add_core_of = ROOT }				
				set_global_flag = italy_reborn
            }
            if = {
                limit = {
                    original_tag = NAP
                }
                set_cosmetic_tag = ITA_REBORN_NAP
            }
            if = {
                limit = {
                    original_tag = SAD
                }
                set_cosmetic_tag = ITA_REBORN_SAD
            }
            if = {
                limit = {
                    original_tag = SIC
                }
                set_cosmetic_tag = ITA_REBORN_SIC
            }
            if = {
                limit = {
                    original_tag = VNZ
                }
                set_cosmetic_tag = ITA_REBORN_VNZ
            }
            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification            
		}

		ai_will_do = {
			factor = 200
		}
	}
    #### FINALIZE UNIFICATION ####
    political_unification = {
        visible = {
            has_idea = generic_recent_political_unification
        }
        #fire_only_once = yes
        available = { has_idea = generic_recent_political_unification }

        icon = generic_form_nation
        cost = 75
        days_remove = 90
        
        remove_effect = {
            remove_ideas = generic_recent_political_unification
        }

        ai_will_do = {
            factor = 50
        }
    }

    army_unification = {
        visible = {
            has_idea = generic_recent_army_unification
        }
       # fire_only_once = yes
        available = {
            has_idea = generic_recent_army_unification
        }

        icon = attache
        cost = 75
        days_remove = 90
        
        remove_effect = {
            remove_ideas = generic_recent_army_unification
        }

        ai_will_do = {
            factor = 50
        }
    }

    economic_unification = {
        visible = {
            has_idea = generic_recent_economic_unification
        }
        #fire_only_once = yes
        available = {
            has_idea = generic_recent_economic_unification
        }

        icon = generic_construction
        cost = 75
        days_remove = 90
        
        remove_effect = {
            remove_ideas = generic_recent_economic_unification
        }

        ai_will_do = {
            factor = 50
        }
    }
}

form_arabia_category = {
    assert_control_over_the_holy_sites = {
        icon = generic_form_nation
        fire_only_once = yes
        cost = 25
        days_remove = 90

        allowed = {
            OR = {
                original_tag = ADU
                original_tag = MOR
                original_tag = ALG
                original_tag = TUN
                original_tag = EGY
                original_tag = PAL
                original_tag = SUD
                original_tag = SOM
                original_tag = SYR
                original_tag = TUR
                original_tag = PAL
                original_tag = JOR
                original_tag = IMA
                original_tag = IRQ
                original_tag = PER
                original_tag = PAK
                original_tag = AZR
                original_tag = XSM
                original_tag = SIK
                original_tag = KAZ
                original_tag = INS
                original_tag = LBA
                original_tag = KUW
                original_tag = BOS
                original_tag = MLD
                original_tag = MLI
                original_tag = LEB
                original_tag = KYR
                original_tag = MRT
                original_tag = TAJ
                original_tag = TMS
                original_tag = CRI
                original_tag = UZB
                original_tag = BAN
                original_tag = ALB
            }
        }

        visible = {
            NOT = { has_government = communism }
            controls_state = 679
        }

        available = {
            controls_state = 679
        }

        ai_will_do = {
            factor = 50
        }

        complete_effect = { }

        remove_effect = {
            add_stability = 0.05
        }
    }
}

form_hispanoamerica_category = {
    form_hispanoamerica = {
        icon = generic_form_nation

        allowed = {
            OR = {
                original_tag = ARG
                original_tag = ECU
                original_tag = PAR
                original_tag = CHL
                original_tag = COL
                original_tag = PAN
                original_tag = PRU
                original_tag = BOL
                original_tag = URG
                original_tag = VEN
            }
        }
        fire_only_once = yes
        available = {
            any_state = {
                AND = {
                    is_core_of = ARG
                    is_controlled_by = ROOT
                }
            }
            any_state = {
                AND = {
                    is_core_of = ECU 
                    is_controlled_by = ROOT
                }
            }
            any_state = {
                AND = {
                    is_core_of = CHL
                    is_controlled_by = ROOT
                }
            }
            any_state = {
                AND = {
                    is_core_of = COL
                    is_controlled_by = ROOT
                }
            }
            any_state = {
                AND = {
                    is_core_of = PAN
                    is_controlled_by = ROOT
                }
            }
            any_state = {
                AND = {
                    is_core_of = PRU
                    is_controlled_by = ROOT
                }
            }
            any_state = {
                AND = {
                    is_core_of = BOL
                    is_controlled_by = ROOT
                }
            }
            any_state = {
                AND = {
                    is_core_of = URG
                    is_controlled_by = ROOT
                }
            }
            any_state = {
                AND = {
                    is_core_of = VEN
                    is_controlled_by = ROOT
                }
            }
            any_state = {
                AND = {
                    is_core_of = PAR
                    is_controlled_by = ROOT
                }
            }
        }

        complete_effect = {
            set_cosmetic_tag = HIS_UNIFIED
            every_state = {
                limit = {
                    OR = {
                        is_core_of = ARG is_core_of = ECU is_core_of = PAR is_core_of = CHL is_core_of = COL is_core_of = PAN is_core_of = PRU is_core_of = BOL is_core_of = URG is_core_of = VEN is_core_of = ELS is_core_of = COS is_core_of = GUA is_core_of = HON is_core_of = NIC is_core_of = MEX is_core_of = CUB is_core_of = DOM
                        state = 311 #Belize
                        state = 686 #Puerto Rico
                        state = 695 #Curação
                    }
                }
                add_core_of = PREV
            }

            every_state = {
                limit = {
                    OR = {
                        region = 53 is_core_of = BAH #Caribbean + Bahamas
                        state = 366 state = 375 state = 376 state = 377 state = 378 state = 379 state = 380 state = 382 #Mexican old clay
                        state = 687 state = 299 state = 720 state = 502 state = 503 #Historical claims
                    }
                    NOT = { is_core_of = ROOT }
                }
                add_claim_by = ROOT
            }
 
            hidden_effect = {
                news_event = { id = r56.news_event.18 hours = 6 }
                set_global_flag = form_hispanomerica_flag
            }

            add_ideas = generic_recent_political_unification
            add_ideas = generic_recent_army_unification
            add_ideas = generic_recent_economic_unification
        }

        ai_will_do = {
            factor = 200
            modifier = {
                factor = 0
                is_historical_focus_on = yes
            }
        }
    }

    core_mexican_america = {
        fire_only_once = yes
        available = {
            controls_state = 378
            controls_state = 379
            controls_state = 377
            controls_state = 376
            controls_state = 382
            controls_state = 380
            controls_state = 375
        }
        visible = {
            has_cosmetic_tag = HIS_UNIFIED
        }

        complete_effect = {
            366 = { add_core_of = ROOT }
            375 = { add_core_of = ROOT }
            376 = { add_core_of = ROOT }
            377 = { add_core_of = ROOT }
            378 = { add_core_of = ROOT }
            379 = { add_core_of = ROOT }
            380 = { add_core_of = ROOT }
            382 = { add_core_of = ROOT }
            hidden_effect = {
                remove_state_claim = 366
                remove_state_claim = 375
                remove_state_claim = 376
                remove_state_claim = 377
                remove_state_claim = 378
                remove_state_claim = 379
                remove_state_claim = 380
                remove_state_claim = 382
            }
        }
    }
}
