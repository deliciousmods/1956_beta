CW_occupation_negotations = {
	#opening decisions - I might regret this later, but there seems little need to make this dynamic
	discuss_the_german_issue = {
		visible = {
			has_global_flag = r56_unlocked_fate_of_germany_decisions
			any_controlled_state = {
				is_core_of = GER
			}
			NOT = {
				has_country_flag = r56_yalta_open_germany_category
				has_country_flag = r56_yalta_fate_of_germany_decided
			}
		}
		complete_effect = {
			set_country_flag = r56_yalta_open_germany_category
		}
		ai_will_do = {
			base = 1
		}
	}
	close_the_german_issue = {
		visible = {
			has_global_flag = r56_unlocked_fate_of_germany_decisions
			any_controlled_state = {
				is_core_of = GER
			}
			has_country_flag = r56_yalta_open_germany_category
		}
		complete_effect = {
			clr_country_flag = r56_yalta_open_germany_category
		}
		ai_will_do = {
			base = 0
		}
 	}
	merge_occupation_zones_germany = {	#is there a point? probably just compliance gain, IRL it helped fix the famine to do economic coop, but you cant assume thered be in with in-game war
		visible = {
			has_global_flag = r56_unlocked_fate_of_germany_decisions
			any_controlled_state = {
				is_core_of = GER
			}
			has_country_flag = r56_yalta_open_germany_category
		}
		available = {
			OR = {
				FROM = {
					NOT = {
						has_government = communism
					}
				}
				NOT = {
					has_country_flag = TO_joined_brussels_treaty
				}
			}
			FROM = {
				NOT = {
					has_war_with = ROOT
				}
				OR = {
					is_ally_with = ROOT
					AND = {
						count_triggers = {
							amount = 2
							gives_military_access_to = ROOT
							has_military_access_to = ROOT
							has_non_aggression_pact_with = ROOT
							AND = {
								has_guaranteed = ROOT
								is_guaranteed_by = ROOT
							}
						}
					}
				}
			}
		}
		target_trigger = {
			FROM = {
				any_controlled_state = {
					is_core_of = GER
					NOT = {	#in case of CZE/AUS/POL/BEL owning German land
						is_core_of = FROM
					}
				}
			}
		}
		icon = hol_exchange_intelligence_data
		complete_effect = { #meta effect to set country flag of name FROM about who to work with?
			custom_effect_tooltip = r56_shared_zone_action_required_tt
		}
	}
	prepare_formation_of_german_state_in_control_zone = {
		visible = {
			has_global_flag = r56_unlocked_fate_of_germany_decisions
			any_controlled_state = {
				is_core_of = GER
			}
			has_country_flag = r56_yalta_open_germany_category
		}
		available = {
			#if merged zone, must do some agreement decision first
		}
		fire_only_once = yes
		days_remove = 330
		remove_effect = {
			set_country_flag = r56_yalta_prepared_german_state
		}
	}
	approve_form_german_state_in_control_zone = {
		visible = {
			has_global_flag = r56_unlocked_fate_of_germany_decisions
			any_controlled_state = {
				is_core_of = GER
			}
			has_country_flag = r56_yalta_open_germany_category
			has_country_flag = r56_yalta_prepared_german_state
			if = {
				limit = {
					original_tag = SOV
				}
				DDR = {
					exists = no
				}
			}
		}
		fire_only_once = yes
		available = {
			#will only have an effect if all countries in shared zone do this
		}
		days_remove = 30
		remove_effect = {
			if = {
				limit = {
					#USA FRA ENG have merged zones and all approved, then form WGR
				}
			}
			if = {
				limit = {
					original_tag = SOV
				}
				every_owned_state = {
					limit = {
						is_core_of = GER
					}
					add_core_of = DDR
					transfer_state_to = DDR
				}
				set_autonomy = {
					target = DDR
					autonomy_state = autonomy_puppet
					end_wars = no
					end_civil_wars = no
				}
			}
		}
	}
	r56_yalta_propose_neutral_germany = {
		visible = {
			has_global_flag = r56_unlocked_fate_of_germany_decisions
			any_controlled_state = {
				is_core_of = AUS
			}
			has_country_flag = r56_yalta_open_germany_category
			NOT = {
				country_exists = GER
			}
		}
		available = {
			always = yes
		}
		days_re_enable = 360
		cost = 25
		complete_effect = {
			country_event = cold_war.39
		}
		ai_will_do = {
			base = 0
			modifier = {
				add = 1000	#need to be high since it costs pp
				original_tag = SOV
				NOT = {	#Soviets get to propose this once
					has_country_flag = r56_yalta_proposing_undemocratic_germany
				}
			}
		}
 	}
	r56_yalta_neutral_germany_forming = {
		allowed = {
			always = no
		}
		is_good = yes
		available = {
			NOT = {
				any_owned_state = {
					is_core_of = GER
				}
			}
		}
		days_mission_timeout = 100 #a government already existed
		timeout_effect = {	#probably put the effect on one side, and a tooltip on the rest
			every_state = {
				limit = {
					is_core_of = GER
					NOT = {
						owner = {
							PREV = {
								is_core_of = PREV
							}
						}
					}
				}
				transfer_state_to = GER
			}
			#put government in event so it doesnt need to be stored
		}
	}
	dismantle_german_war_industry = {	#every 3 mils becomes 1 civ for GER, and 1 mil for the occupier
		icon = generic_construction
		state_target = yes
		visible = {
			has_global_flag = r56_unlocked_fate_of_germany_decisions
			any_controlled_state = {
				is_core_of = GER
			}
			has_country_flag = r56_yalta_open_germany_category
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_fully_controlled_by = ROOT
				is_core_of = GER
				arms_factory > 0
			}
		}
		days_remove = 200
		remove_effect = {
			if = {
				limit = {
					FROM = {
						arms_factory > 2
					}
				}
				FROM = {
					remove_building = {
						type = arms_factory
						level = 3
					}
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				}
				random_owned_controlled_state = {
					limit = {
						is_core_of = ROOT
						free_building_slots = {
							building = arms_factory
							size > 0
							include_locked = no
						}
					}
					add_building_construction = {
						type = arms_factory
						level = 1
						instant_build = yes
					}
				}
			}
			else = {
				FROM = {
					remove_building = {
						type = arms_factory
						level = building_level@arms_factory
					}
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				}
			}
			add_threat = -1
		}
		ai_will_do = {
			base = 1
			modifier = {
				factor = 0
				any_enemy_country = {
					is_major = yes
				}
			}
		}
	}
 	discuss_the_austrian_issue = {
		visible = {
			has_global_flag = r56_unlocked_fate_of_austria_decisions
			any_controlled_state = {
				is_core_of = AUS
			}
			NOT = {
				has_country_flag = r56_yalta_open_austria_category
				has_country_flag = r56_yalta_fate_of_austria_decided
			}
		}
		complete_effect = {
			set_country_flag = r56_yalta_open_austria_category
		}
		ai_will_do = {
			base = 1
		}
 	}
	close_the_austrian_issue = {
		visible = {
			has_global_flag = r56_unlocked_fate_of_austria_decisions
			any_controlled_state = {
				is_core_of = AUS
			}
			has_country_flag = r56_yalta_open_austria_category
		}
		complete_effect = {
			clr_country_flag = r56_yalta_open_austria_category
		}
		ai_will_do = {
			base = 0
		}
 	}
	r56_yalta_propose_neutral_austria = {
		visible = {
			has_global_flag = r56_unlocked_fate_of_austria_decisions
			any_controlled_state = {
				is_core_of = AUS
			}
			has_country_flag = r56_yalta_open_austria_category
			NOT = {
				country_exists = AUS
			}
		}
		days_re_enable = 360
		cost = 25
		complete_effect = {
			country_event = cold_war.37
		}
		ai_will_do = {
			base = 0
			modifier = {
				add = 1000	#need to be high since it costs pp
				original_tag = SOV
				OR = {
					date > 1955.06.06
					AND = {
						NOT = {
							has_country_leader = {
								character = SOV_iosif_stalin
								ruling_only = yes
							}
						}
						date < 1952.06.06	#other leader before death of Stalin = earlier
					}
				}
			}
		}
 	}
	r56_yalta_neutral_austria_forming = {
		allowed = {
			always = no
		}
		is_good = yes
		available = {
			NOT = {
				any_owned_state = {
					is_core_of = AUS
				}
			}
		}
		days_mission_timeout = 100 #a government already existed
		timeout_effect = {
			every_state = {
				limit = {
					is_core_of = AUS
					NOT = {
						owner = {
							PREV = {
								is_core_of = PREV
							}
						}
					}
				}
				transfer_state_to = AUS
			}
			#put government in event so it doesnt need to be stored
		}
	}
	occupation_of_iran_decision = {	#itd be nicer if garrison divisions existed, so the decision below this wouldnt be needed, but no data
		allowed = {
			always = no
		}
		is_good = no
		days_mission_timeout = 142
		available = {
			NOT = {
				#has_subject = PER
				any_owned_state = {
					is_core_of = PER
				}
				any_subject_country = {	#includes Soviet puppets
					any_owned_state = {
						is_core_of = PER
					}
				}
			}
		}
		timeout_effect = {	#Iran complains
			add_threat = 5
		}
	}
	withdraw_occupation_of_iran_decision = {
		allowed = {
			OR = {
				original_tag = SOV
				original_tag = ENG
			}
		}
		icon = generic_prepare_civil_war
		available = {
			# if = {	#Ive made some scoping mistakes
			# 	limit = {
			# 		has_subject = PER
			# 	}
			# 	PER = {
			# 		NOT = {
			# 			any_owned_state = {
			# 				ROOT = {
			# 					divisions_in_state = {
			# 						size < 1
			# 						state = PREV
			# 					}
			# 				}
			# 			}
			# 		}
			# 	}
			# }
			# else = {
			# 	NOT = {
			# 		any_owned_state = {
			# 			is_core_of = PER
			# 			PREV = {
			# 				divisions_in_state = {
			# 					size < 1
			# 					state = PREV
			# 				}
			# 			}
			# 		}
			# 	}
			# }
		}
		visible = {
			PER = {
				exists = yes
			}
			OR = {
				has_subject = PER
				any_owned_state = {
					is_core_of = PER
				}
			}
		}
		remove_effect = {
			every_owned_state = {
				limit = {
					is_core_of = PER
				}
				transfer_state_to = PER
			}
			if = {
				limit = {
					has_subject = PER
				}
				set_autonomy = {
					target = PER
					autonomous_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
				PER = {
					add_ideas = PER_anglo_iranian_oil_company
				}
			}
			#if they dont have the mission that pressures for withdrawing, they failed it, so remove some of the tension they caused
			if = {
				limit = {
					NOT = {
						has_active_mission = occupation_of_iran_decision
					}
				}
				add_threat = -3
			}
		}
		ai_will_do = {	#UK should historically retreat from Germany
			base = 0
			modifier = {	#dont withdraw from Iran during WW2
				add = 1
				OR = {
					has_war = no
					has_active_mission = occupation_of_iran_decision
				}
			}			
			modifier = {	#if UK is agressive ideology but got yalta, keep Iran
				factor = 0
				OR = {
					has_government = neutrality
					has_government = fascism
				}
			}
			modifier = {	#Soviets shouldnt withdraw from Iran for a while, but do it later
				factor = 0
				original_tag = SOV
				has_active_mission = occupation_of_iran_decision	#Soviets historically let it expire, then did it later anyway
			}
		}
	}
	SOV_release_AZE_puppet = {

		icon = generic_nationalism

		allowed = {
			original_tag = SOV
		}

		available = {
			owns_state = 419
			owns_state = 987
			NOT = {
				AZR = {
					country_exists = yes
				}
			}
		}

		visible = {
			any_controlled_state = {
				is_core_of = PER
			}
		}

		days_remove = 45
		
		fire_only_once = yes

		remove_effect = {
			AZR = {
				transfer_state = 419
				transfer_state = 987
			}
			if = {
				limit = {
					has_dlc = "Together for Victory"
				}
				set_autonomy = {
					target = AZR
					autonomy_state = autonomy_dominion
					end_wars = no
					end_civil_wars = no
				}
			}
			else = {
				puppet = AZR
			}
		}			
		ai_will_do = {
			factor = 50
		}
	}

	SOV_release_KUR_puppet = {

		icon = generic_nationalism

		allowed = {
			original_tag = SOV
		}

		available = {
			owns_state = 988
			NOT = {
				KUR = {
					country_exists = yes
				}
			}
		}

		visible = {
			any_controlled_state = {
				is_core_of = PER
			}
		}

		days_remove = 45
		
		fire_only_once = yes

		remove_effect = {
			KUR = {
				transfer_state = 988
				hidden_effect = {
					load_oob = "KUR_peshmerga"
				}
			}
			set_autonomy = {
				target = KUR
				autonomy_state = autonomy_dominion
				end_wars = no
				end_civil_wars = no
			}
		}			
		ai_will_do = {
			factor = 50
		}
	}
	SOV_withdraw_from_puppets_in_iran = {
		allowed = {
			original_tag = SOV
		}
		visible = {
			OR = {
				has_subject = AZR
				has_subject = KUR
			}
		}
		remove_effect = {
			if = {
				limit = {
					has_subject = AZR
				}
				end_puppet = AZR
				PER = {
					create_wargoal = {
						type = annex_everything
						target = AZR
					}
				}
			}
			if = {
				limit = {
					has_subject = KUR
				}
				end_puppet = KUR
				PER = {
					create_wargoal = {
						type = annex_everything
						target = KUR
					}
				}
			}
		}
		ai_will_do = {
			base = 0
			modifier = {
				add = 1
				NOT = {
					any_owned_state = {
						is_core_of = PER
					}
				}
			}
		}
	}
	SOV_demand_iranian_oil_rights = {
		allowed = {
			original_tag = SOV
		}
		visible = {
			any_owned_state = {
				is_core_of = PER
			}
		}
	}
	discuss_the_korean_issue = {
		visible = {
			any_controlled_state = {
				is_core_of = KOR
			}
		}
 	}
	 SOV_return_manchuria_to_PRC = {

		icon = generic_nationalism

		allowed = {
			original_tag = SOV
		}

		available = {
			PRC = {
				exists = yes
			}
			owns_state = 328
			owns_state = 610
			owns_state = 714
			owns_state = 715
			owns_state = 716
			owns_state = 717
			owns_state = 761
			owns_state = 941
			owns_state = 942
			owns_state = 943
			owns_state = 944
			owns_state = 945
			owns_state = 946
			owns_state = 947
		}
		
		visible = {
			NOT = {
				has_global_flag = SOV_ceded_manchuria
			}
			any_controlled_state = {
				OR = {	#manchurian cores are removed
					is_core_of = CHI
					is_core_of = PRC
				}
			}
		}

		days_remove = 30

		cost = 25
		
		fire_only_once = yes
		
		complete_effect = {
			give_military_access = PRC
		}

		remove_effect = {
			PRC = {
				transfer_state = 328
				transfer_state = 610
				transfer_state = 714
				transfer_state = 715
				transfer_state = 716
				transfer_state = 717
				transfer_state = 761
				transfer_state = 941
				transfer_state = 942
				transfer_state = 943
				transfer_state = 944
				transfer_state = 945
				transfer_state = 946
				transfer_state = 947
			}
			diplomatic_relation = {
				country = PRC
				relation = military_access
				active = no
			}
			set_global_flag = SOV_ceded_manchuria
			CHI = {
				country_event = cold_war.30
			}
		}
		ai_will_do = {
			factor = 50
			modifier = {
				factor = 10
				date > 1946.03.01
			}
		}
	}
	SOV_return_manchuria_to_ROC = {

		icon = generic_nationalism

		allowed = {
			original_tag = SOV
		}

		available = {
			CHI = {
				exists = yes
			}
			owns_state = 328
			owns_state = 610
			owns_state = 714
			owns_state = 715
			owns_state = 716
			owns_state = 717
			owns_state = 761
			owns_state = 941
			owns_state = 942
			owns_state = 943
			owns_state = 944
			owns_state = 945
			owns_state = 946
			owns_state = 947
		}

		visible = {
			NOT = {
				has_global_flag = SOV_ceded_manchuria
			}
			any_controlled_state = {
				OR = {	#manchurian cores are removed
					is_core_of = CHI
					is_core_of = PRC
				}
			}
		}

		days_remove = 30
		
		fire_only_once = yes

		remove_effect = {
			CHI = {
				transfer_state = 328
				transfer_state = 610
				transfer_state = 714
				transfer_state = 715
				transfer_state = 716
				transfer_state = 717
				transfer_state = 761
				transfer_state = 941
				transfer_state = 942
				transfer_state = 943
				transfer_state = 944
				transfer_state = 945
				transfer_state = 946
				transfer_state = 947
			}
			set_global_flag = SOV_ceded_manchuria
		}			
		ai_will_do = {
			factor = 0
		}
	}
}

political_actions = {
	ISR_proclaim_the_state_early = {
		
		icon = generic_nationalism

		allowed = {
			original_tag = ISR
		}

		visible = {
			has_war_with = PAL
			has_active_mission = ISR_mandate_collapse_mission
		}
		
		available = {
			has_country_flag = {
				flag = ISR_started_revolution_flag
				days > 120
				date > 1945.1.1
			}
			count_triggers = {
				amount = 2
				966 = {
					is_controlled_by = ISR
				}
				454 = {
					is_controlled_by = ISR
				}
				1016 = {
					is_controlled_by = ISR
				}
				1017 = {
					is_controlled_by = ISR
				}
				#intentionally excluding Gaza
			}
		}

		fire_only_once = yes

		remove_effect = {
			complete_national_focus = ISR_win
		}			
		ai_will_do = {
			factor = 50
		}
	}
	PAK_attack_kashmir = {
		allowed = {
			original_tag = PAK
		}
		days_remove = 60
		visible = {
			any_country = {
				has_cosmetic_tag = Kashmir
				NOT = {
					has_war_with = ROOT
				}
			}
		}
		cost = 25
		war_with_target_on_remove = yes
		targets = { RAJ }
		targets_dynamic = yes
		target_trigger = {
			FROM = {
				has_cosmetic_tag = Kashmir
			}
		}
		remove_effect = {
			declare_war_on = {
                target = FROM
                type = annex_everything
            }
		}
		ai_will_do = {
			base = 1000	#do ASAP
			modifier = {
				factor = 0
				OR = {
					has_war = yes
					date < 1947.8.10	#slightly earlier to build up pp cost
					any_other_country = {
						has_cosmetic_tag = Kashmir
						any_country = {
							has_guaranteed = PREV
						}
					}
				}
			}
		}
	}
	RAJ_kashmir_request_support = {
		
		icon = generic_nationalism

		allowed = {
			original_tag = RAJ
		}

		fire_only_once = yes

		available = {
			NOT = {
				has_war_with = RAJ
			}
		}

		visible = {
			has_cosmetic_tag = Kashmir
			has_war = yes
			country_exists = RAJ
		}

		ai_will_do = {
			base = 100	#no cost, so should be done
		}

		days_remove = 6

		remove_effect = {
			RAJ = {
				country_event = cold_war.26
			}
		}
	}
	JAP_surrender_mission = {

		icon = generic_nationalism

		allowed = {
			always = no
		}

		days_remove = 14
		
		fire_only_once = yes

		remove_effect = {
			remove_state_core = 524
			CHI = {
				transfer_state = 524
			}
			every_owned_state = {
				transfer_state_to = USA
			}
		}			
		ai_will_do = {
			factor = 50
		}
	}
	PRC_recruit_chahar_japanese_puppet_troops = {
		allowed = {
			original_tag = PRC
		}
		days_remove = 14

		available = {
			controls_state = 612
			controls_state = 611
		}
		
		fire_only_once = yes

		remove_effect = {
			hidden_effect = {
				load_oob = "MEN_1936"
			}
			custom_effect_tooltip = PRC_recruit_remnants_tt
			add_war_support = -0.05
			add_stability = -0.05
		}
	}
	PRC_recruit_manchuria_japanese_puppet_troops = {
		allowed = {
			original_tag = PRC
		}

		visible = {
			has_global_flag = SOV_ceded_manchuria
		}

		available = {
			controls_state = 328
			controls_state = 610
			controls_state = 714
			controls_state = 715
			controls_state = 716
			controls_state = 717
			controls_state = 761
			controls_state = 941
			controls_state = 942
			controls_state = 943
			controls_state = 944
			controls_state = 945
			controls_state = 946
			controls_state = 947
		}

		days_remove = 14
		
		fire_only_once = yes

		remove_effect = {
			hidden_effect = {
				load_oob = "MAN_1936"
			}
			custom_effect_tooltip = PRC_recruit_remnants_tt
			add_war_support = -0.05
			add_stability = -0.05
		}
	}
}