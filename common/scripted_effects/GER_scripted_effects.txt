give_SOV_armor_research_bonuses = { #this effect is run for the Soviets!
	if = {
		limit = {
			NOT = {
				has_dlc = "No Step Back"
			}
		}
		add_tech_bonus = {
			name = med_armor_bonus
			ahead_reduction = 2
			category = cat_medium_armor
		}
		add_tech_bonus = {
			name = armor_bonus
			bonus = 1.0
			uses = 1
			category = armor
		}
	}
	if = { #double if because history files don't like else and this effect is run in the Soviet history file
		limit = {
			has_dlc = "No Step Back"
		}
		create_equipment_variant = {
			name = "A-20"
			type = medium_tank_chassis_1
			parent_version = 0
			allow_without_tech = no
			modules = {
				main_armament_slot = tank_small_cannon_2
				turret_type_slot = tank_medium_two_man_tank_turret
				suspension_type_slot = tank_christie_suspension
				armor_type_slot = tank_welded_armor
				engine_type_slot = tank_diesel_engine
				special_type_slot_1 = sloped_armor
			}
			upgrades = {
				tank_nsb_engine_upgrade = 8
				tank_nsb_armor_upgrade = 2
			}
			icon = "GFX_SOV_basic_medium_tank_medium"
		}
		create_equipment_variant = {
			name = "KV-1"
			type = heavy_tank_chassis_1
			parent_version = 0
			modules = {
				main_armament_slot = tank_medium_cannon
				turret_type_slot = tank_heavy_three_man_tank_turret
				suspension_type_slot = tank_torsion_bar_suspension
				armor_type_slot = tank_welded_armor
				engine_type_slot = tank_diesel_engine		
			}
			upgrades = {
				tank_nsb_engine_upgrade = 10
				tank_nsb_armor_upgrade = 9
			}
			icon = "GFX_SOV_improved_heavy_tank_medium"
		}
		add_tech_bonus = {
			name = armor_bonus
			bonus = 1.0
			uses = 2
			category = armor
		}
	}
}

MR_pact_transfer_state_effect = {
	if = {
		limit = {
			96 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 96
						is_subject_of = ROOT
					}
				}
			}
		}
		if = {
			limit = {
				NOT = {
					any_other_country = {
						is_in_faction_with = SOU
						has_country_flag = BLT_soviets_said_yes_to_belarus_flag
					}
				}
			}
			SOU = { transfer_state = 96 }
		}
		else = {
			random_other_country = {
				limit = {
					is_in_faction_with = SOU
					OR = {
						has_cosmetic_tag = LIT_belarus
						has_cosmetic_tag = LAT_belarus
						has_cosmetic_tag = EST_belarus
						has_cosmetic_tag = BAL_UNIFIED
					}
				}
				transfer_state = 96
			}
		}
	}
	if = {
		limit = {
			95 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 95
						is_subject_of = ROOT
					}
				}
			}
		}
		if = {
			limit = {
				NOT = {
					any_other_country = {
						is_in_faction_with = SOU
						has_country_flag = BLT_soviets_said_yes_to_belarus_flag
					}
				}
			}
			SOU = { transfer_state = 95 }
		}
		else = {
			random_other_country = {
				limit = {
					is_in_faction_with = SOU
					OR = {
						has_cosmetic_tag = LIT_belarus
						has_cosmetic_tag = LAT_belarus
						has_cosmetic_tag = EST_belarus
						has_cosmetic_tag = BAL_UNIFIED
					}
				}
				transfer_state = 95
			}
		}
	}
	if = {
		limit = {
			94 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 94
						is_subject_of = ROOT
					}
				}
			}
		}
		if = {
			limit = {
				NOT = {
					any_other_country = {
						is_in_faction_with = SOU
						has_country_flag = BLT_soviets_said_yes_to_belarus_flag
					}
				}
			}
			SOU = { transfer_state = 94 }
		}
		else = {
			random_other_country = {
				limit = {
					is_in_faction_with = SOU
					OR = {
						has_cosmetic_tag = LIT_belarus
						has_cosmetic_tag = LAT_belarus
						has_cosmetic_tag = EST_belarus
						has_cosmetic_tag = BAL_UNIFIED
					}
				}
				transfer_state = 94
			}
		}
	}
	if = {
		limit = {
			93 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 93
						is_subject_of = ROOT
					}
				}
			}
		}
		SOU = { transfer_state = 93 }
	}
	if = {
		limit = {
			91 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 91
						is_subject_of = ROOT
					}
				}
			}
		}
		SOU = { transfer_state = 91 }
	}
	if = {
		limit = {
			97 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 97
						is_subject_of = ROOT
					}
				}
			}
		}
		if = {
			limit = {
				NOT = {
					any_other_country = {
						is_in_faction_with = SOU
						has_country_flag = BLT_soviets_said_yes_to_belarus_flag
					}
				}
			}
			SOU = { transfer_state = 97 }
		}
		else = {
			random_other_country = {
				limit = {
					is_in_faction_with = SOU
					OR = {
						has_cosmetic_tag = LIT_belarus
						has_cosmetic_tag = LAT_belarus
						has_cosmetic_tag = EST_belarus
						has_cosmetic_tag = BAL_UNIFIED
					}
				}
				transfer_state = 97
				97 = {
					add_core_of = PREV
				}
			}
		}
	}
	if = {
		limit = {
			89 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 89
						is_subject_of = ROOT
					}
				}
			}
		}
		SOU = { transfer_state = 89 }
	}
	if = {
		limit = {
			784 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 784
						is_subject_of = ROOT
					}
				}
			}
		}
		if = {
			limit = {
				OR = {
					has_global_flag = LIT_gets_vilnius
					LIT = { controls_state = 784 }
					LIT = { is_in_faction_with = SOU }
				}
				LIT = { exists = yes }
			}
			LIT = { transfer_state = 784 }
		}
		else_if = {
			limit = {
				NOT = {
					any_other_country = {
						is_in_faction_with = SOU
						has_country_flag = BLT_soviets_said_yes_to_belarus_flag
					}
				}
			}
			SOU = { transfer_state = 784 }
		}
		else = {
			random_other_country = {
				limit = {
					is_in_faction_with = SOU
					OR = {
						has_cosmetic_tag = LIT_belarus
						has_cosmetic_tag = LAT_belarus
						has_cosmetic_tag = EST_belarus
						has_cosmetic_tag = BAL_UNIFIED
					}
				}
				transfer_state = 784
			}
		}
	}
}

MR_pact_transfer_faction_state_effect = {
	if = {
		limit = {
			96 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 96
						is_in_faction_with = ROOT
					}
				}
			}
		}
		SOU = { transfer_state = 96 }
	}
	if = {
		limit = {
			95 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 95
						is_in_faction_with = ROOT
					}
				}
			}
		}
		SOU = { transfer_state = 95 }
	}
	if = {
		limit = {
			94 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 94
						is_in_faction_with = ROOT
					}
				}
			}
		}
		SOU = { transfer_state = 94 }
	}
	if = {
		limit = {
			93 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 93
						is_in_faction_with = ROOT
					}
				}
			}
		}
		SOU = { transfer_state = 93 }
	}
	if = {
		limit = {
			91 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 91
						is_in_faction_with = ROOT
					}
				}
			}
		}
		SOU = { transfer_state = 91 }
	}
	if = {
		limit = {
			97 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 97
						is_in_faction_with = ROOT
					}
				}
			}
		}
		SOU = { transfer_state = 97 }
	}
	if = {
		limit = {
			89 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = {
						controls_state = 89
						is_in_faction_with = ROOT
					}
				}
			}
		}
		SOU = { transfer_state = 89 }
	}
	if = {
		limit = {
			784 = {
				OR = {
					is_controlled_by = ROOT
					any_other_country = { 
						controls_state = 784
						is_in_faction_with = ROOT
					}
				}
			}
		}
		if = {
			limit = {
				OR = {
					has_global_flag = LIT_gets_vilnius
					LIT = { controls_state = 784 }
				}
				LIT = { exists = yes }
			}
			LIT = { transfer_state = 784 }
		}
		else = {
			SOU = { transfer_state = 784 }
		}
	}
}
GER_add_o_class_battlecruiser_template = {
	create_equipment_variant = {
		name = "O-Class"
		type = ship_hull_heavy_3
		parent_version = 0
		modules = {
			fixed_ship_battery_slot = ship_heavy_battery_3
			fixed_ship_anti_air_slot = ship_anti_air_2
			fixed_ship_fire_control_system_slot = ship_fire_control_system_2
			fixed_ship_radar_slot = ship_radar_2
			fixed_ship_engine_slot = heavy_ship_engine_2
			fixed_ship_secondaries_slot = ship_secondaries_2
			fixed_ship_armor_slot = ship_armor_bc_1
			front_1_custom_slot = ship_heavy_battery_3
			mid_1_custom_slot = ship_anti_air_2
			mid_2_custom_slot = ship_secondaries_2
			rear_1_custom_slot = ship_heavy_battery_3
		}
	}
	add_equipment_production = {
		equipment = {
			type = ship_hull_heavy_3
			creator = GER
			version_name = "O-Class"
		}
		name = "Schlachtkreuzer O"
		requested_factories = 1
		progress = 0.31 
		amount = 1
	}
	add_equipment_production = {
		equipment = {
			type = ship_hull_heavy_3
			creator = GER
			version_name = "O-Class"
		}
		name = "Schlachtkreuzer P"
		requested_factories = 1
		progress = 0.27 
		amount = 1
	}
	add_equipment_production = {
		equipment = {
			type = ship_hull_heavy_3
			creator = GER
			version_name = "O-Class"
		}
		name = "Schlachtkreuzer Q"
		requested_factories = 1
		progress = 0.19
		amount = 1
	}
}


GER_civil_war_make_this_communist_preview = {
	transfer_state = 60
	transfer_state = 65
	set_province_controller = 9560
	set_province_controller = 9375
	set_province_controller = 6218
	set_province_controller = 6377
	set_province_controller = 6487
	set_province_controller = 11468
	set_province_controller = 11402
	set_province_controller = 11493
	set_province_controller = 6513
	set_province_controller = 526
	set_province_controller = 3522
	set_province_controller = 6298
	set_province_controller = 6389 #Kiel
	set_politics = {
		ruling_party = communism
	}
	set_popularities = {
		communism = 40
		democratic = 25
		neutrality = 15
		fascism = 20
	}

	set_cosmetic_tag = GER_communist

	set_capital = {state = 65} #largest communist share


	if = {
		limit = {
			NOT = {
				has_character = GER_ernst_thalmann
			}
		}
		GER = {
			GER_ernst_thalmann = {
				set_nationality = PREV.PREV
			}
		}
	}

	GER_ernst_thalmann = {
		promote_character = yes
		promote_character = stalinism
		set_portraits = { #temporarily doesnt use his fancy uniform
			civilian = {
				large="gfx/leaders/GER/r56_portrait_Ernst_Thalmann.dds"
			}
		}
		promote_character = stalinism
	}
}

# makes THIS the communist country in the threeway civil war. Does NOT create a country.
GER_civil_war_make_this_communist = {
	set_country_flag = is_commie_ger_cw
	
	GER_civil_war_make_this_communist_preview = yes

	if = {
		limit = {
			NOT = {
				has_focus_tree = german_focus
			}
		}
		load_focus_tree = {
			tree = german_focus
			keep_completed = yes
		}
		unlock_national_focus = GER_kill_hitler # force path
		unlock_national_focus = GER_political_turmoil # force path
	}
	complete_national_focus = GER_repeal_reichstag_fire_decree
	
	add_ideas = {
		extensive_conscription
		war_economy
	}
	set_rule = {
		can_send_volunteers = yes
	}

	log = "GER_civil_war_make_this_communist: Targeting '[THIS.GetTag]:[THIS.GetName]'"

	save_event_target_as = communist_germany
	set_country_flag = r56_communist_germany_aliases_set

	if = {
		limit = {
			NOT = {
				tag = GER
			}
		}
		add_ideas = {
			sour_loser
			GER_enigma_machine0
			general_staff
		}
		add_timed_idea = {
			idea = GER_political_turmoil_idea
			days = 270
		}

		GER = {
			every_character = {
				limit = {
					GER_civil_war_is_communist_character = yes
				}
				set_nationality = event_target:communist_germany
			}

			transfer_units_fraction= {
				target = event_target:communist_germany
				size = 0.2
				stockpile_ratio = 0.2 #bit of raiding
				army_ratio = 0.23 #fascists are already transfered so increased to compensate, was 0.15, 0.15*(1/(1-0.35))
				navy_ratio = 0.1 #no majorities in naval regions
				air_ratio = 0.05
				keep_unit_leaders_trigger = {
					always = yes 
				}
			}
		}
	}


	add_command_power = 50
	#Thalmann was imprisoned in the communist area, make him leader here and fire an event about him being freed if communists are chosen

	set_variable = {
		var = GER_commie_soviet_influence
		value = 0
	}
	add_equipment_to_stockpile = { #buff to compensate for lack of industry, 5-divisions worth
		type = infantry_equipment
		amount = 5000
		producer = GER
	}
	division_template = {
		name = "Rotes Regiment"
		is_locked = yes
	
		division_names_group = GER_Inf_01
	
		regiments = {
			infantry = { x = 0 y = 0 }
			infantry = { x = 0 y = 1 }
			infantry = { x = 0 y = 2 }
			infantry = { x = 0 y = 3 }
		}
		support = { 
			engineer = { x = 0 y = 0 }
		}
	}
	every_controlled_state = { #16 weak units in stronghold
		limit = {
			OR = {
				state = 60
				state = 65
			}
		}
		create_unit = {
			division = "name = \"Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
		}
		create_unit = {
			division = "name = \"Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
		}
		create_unit = {
			division = "name = \"Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
		}
		create_unit = {
			division = "name = \"Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
		}
		create_unit = {
			division = "name = \"Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
		}
		create_unit = {
			division = "name = \"Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
		}
		create_unit = {
			division = "name = \"Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
		}
		create_unit = {
			division = "name = \"Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
		}
	}
	every_state = { #8 divisions in contested areas
		limit = {
			OR = {
				state = 59
				state = 64
			}
		}
		create_unit = {
			division = "name = \"Hamburger Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
			allow_spawning_on_enemy_provs = no
		}
		create_unit = {
			division = "name = \"Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
			allow_spawning_on_enemy_provs = no
		}
		create_unit = {
			division = "name = \"Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
			allow_spawning_on_enemy_provs = no
		}
		create_unit = {
			division = "name = \"Rotes Regiment\" division_template = \"Rotes Regiment\" start_experience_factor = 0.05"
			owner = PREV
			allow_spawning_on_enemy_provs = no
		}
	}
}


GER_civil_war_make_this_democratic_preview = {
	transfer_state = 989 #East Rhineland
	transfer_state = 50 
	transfer_state = 51 #Rhineland
	transfer_state = 52 #Bavaria
	transfer_state = 53 #Bavaria
	transfer_state = 54 #Bavaria
	transfer_state = 55 #Bavaria
	transfer_state = 42 #Mosselland
	transfer_state = 922
	transfer_state = 923 #Baden
	transfer_state = 67 #Oppeln
	transfer_state = 1053

	set_province_controller = 495

	set_capital = {state = 922} 

	set_cosmetic_tag = GER_democratic

	set_politics = {
		ruling_party = democratic
	}
	set_popularities = {
		democratic = 45
		neutrality = 25
		fascism = 10
		communism = 20
	}

	if = {
		limit = {
			NOT = {
				has_character = GER_erwin_von_witzleben
			}
		}
		GER = {
			GER_erwin_von_witzleben = {
				set_nationality = PREV.PREV
			}
		}
	}

	GER_erwin_von_witzleben = {
		if = {
			limit = {
				can_be_country_leader = yes
			}
			promote_character = conservatism
		}
		else = {
			add_country_leader_role = {
				promote_leader = yes
				country_leader = {
					  ideology = conservatism
					  expire = "1942.1.1.1" #health
					  traits = { infantry_officer_political }
				}
			}
		}
	}
}

# makes THIS the democratic country in the threeway civil war. Does NOT create a country.

GER_civil_war_make_this_democratic = {
	set_country_flag = is_democratic_ger_cw

	GER_civil_war_make_this_democratic_preview = yes

	if = {
		limit = {
			NOT = {
				has_focus_tree = german_focus
			}
		}
		load_focus_tree = {
			tree = german_focus
			keep_completed = yes
		}
		unlock_national_focus = GER_kill_hitler # force path
		unlock_national_focus = GER_political_turmoil # force path
	}
	complete_national_focus = GER_restore_weimar  #no switching ideology afterwards :P
	
	add_ideas = {
		limited_conscription
		partial_economic_mobilisation
	}
	set_rule = {
		can_send_volunteers = yes
	}
	save_event_target_as = conservative_germany
	set_country_flag = r56_conservative_germany_aliases_set

	log = "GER_civil_war_make_this_democratic: Targeting '[THIS.GetTag]:[THIS.GetName]'"

	if = {
		limit = {
			NOT = {
				tag = GER
			}
		}
		add_ideas = {
			sour_loser
			GER_enigma_machine0
			general_staff
		}
		add_timed_idea = {
			idea = GER_political_turmoil_idea
			days = 270
		}

		GER = {
			every_character = { #move over advisors and leaders
				limit = {
					GER_civil_war_is_democratic_character = yes
				}
				set_nationality = event_target:conservative_germany
			}

			transfer_units_fraction= {
				target = event_target:conservative_germany
				size = 0.4
				stockpile_ratio = 0.55 #industrial core
				army_ratio = 0.77	#fascists are already transfered so increased to compensate, was 0.5, 0.5*(1/(1-0,35))
				navy_ratio = 0.3 #no majorities in naval regions
				air_ratio = 0.35
				keep_unit_leaders_trigger = {
					always = yes 
				}
			}
		}
	}

	every_unit_leader = {
		limit = {
			has_id = 19 #Johannes Blaskowitz
		}
		remove_unit_leader_trait = unpopular #Should be less controversial if Germany is being good
	}

	
	division_template = {
		name = "Landsturmregiment"
		is_locked = yes
	
		division_names_group = GER_Inf_01
	
		regiments = {
			infantry = { x = 0 y = 0 }
			infantry = { x = 0 y = 1 }
			infantry = { x = 0 y = 2 }
			infantry = { x = 0 y = 3 }
		}
		support = { 
			engineer = { x = 0 y = 0 }
		}
	}
	every_controlled_state = {
		limit = {
			OR = {
				state = 67 #Poland enclave
				state = 54 #East
				state = 989 #Upper
				state = 922 #Center
			}
		}
		create_unit = {
			division = "name = \"Landsturmregiment\" division_template = \"Landsturmregiment\" start_experience_factor = 0.05"
			owner = PREV
		}
		create_unit = {
			division = "name = \"Landsturmregiment\" division_template = \"Landsturmregiment\" start_experience_factor = 0.05"
			owner = PREV
		}
		create_unit = {
			division = "name = \"Landsturmregiment\" division_template = \"Landsturmregiment\" start_experience_factor = 0.05"
			owner = PREV
		}
	}
}

# makes THIS the fascist country in the threeway civil war. Does NOT create a country.
GER_civil_war_make_this_fascist = {
	save_event_target_as = fascist_germany
	set_country_flag = r56_fascist_germany_aliases_set

	set_cosmetic_tag = GER_fascist

	transfer_state = 56
	transfer_state = 57
	transfer_state = 58
	transfer_state = 59
	transfer_state = 998
	transfer_state = 61
	transfer_state = 62
	transfer_state = 63
	transfer_state = 64
	transfer_state = 66
	transfer_state = 68
	transfer_state = 763
	transfer_state = 5

	set_popularities = {
		democratic = 10
		neutrality = 25
		fascism = 60
		communism = 5
	}

	set_politics = {
		ruling_party = fascism
		elections_allowed = no
	}

	log = "GER_civil_war_make_this_fascist: Targeting '[THIS.GetTag]:[THIS.GetName]'"

	set_rule = {
		can_create_factions = no
	}
	
	load_focus_tree = {
		tree = german_focus
		keep_completed = yes
	}
	complete_national_focus = GER_denounce_versailles # force fascist path
	remove_ideas = GER_denounce_versailles_idea # They dont really denounce versailles in the civil war
	unlock_national_focus = GER_rhineland

	if = {
		limit = {
			NOT = {
				tag = GER
			}
		}
		add_ideas = {
			sour_loser
			GER_enigma_machine0
			general_staff
		}
		add_timed_idea = {
			idea = GER_political_turmoil_idea
			days = 270
		}
	}

	# GER = { # I have no idea why scoping into GER doesnt work. It works for the other dynamic nations.....
	FROM = {
		every_character = { #move over advisors and leaders
			if = {
				limit = {
					GER_civil_war_is_fascist_character = yes
				}
				set_nationality = event_target:fascist_germany
			}
		}


		transfer_units_fraction= {
			target = event_target:fascist_germany
			size = 0.4
			stockpile_ratio = 0.25
			army_ratio = 0.35
			navy_ratio = 0.3 #no majorities in naval regions
			air_ratio = 0.6
			keep_unit_leaders_trigger = {
				always = yes 
			}
		}
	}

	# get back the correct nazi leader we flagged in the civil war setup
	every_character = {
		limit = {
			has_character_flag = GER_fascist_leader_flag
		}
		promote_character = nazism
	}

	set_capital = {state = 64}

	civil_war_anti_exploiter_punitive_action = yes

	#create fascist paramilitaries here, after splitting and after the player can mess with them
	division_template = {
		name = "SS-Sturmbrigade"
		is_locked = yes
	
		division_names_group = GER_Inf_01
	
		regiments = {
			infantry = { x = 0 y = 0 }
			infantry = { x = 0 y = 1 }
			infantry = { x = 0 y = 2 }
			infantry = { x = 0 y = 3 }
		}
		support = { 
			engineer = { x = 0 y = 0 }
		}
	}
	every_controlled_state = {
		create_unit = {
			division = "name = \"SS-Sturmbrigade\" division_template = \"SS-Sturmbrigade\" start_experience_factor = 0.05"
			owner = event_target:fascist_germany
			allow_spawning_on_enemy_provs = no
		}
	}
}

GER_civil_war_teleport_armies = {
	every_owned_state = {
		teleport_armies = {
			limit = {
				original_tag = GER
			}
		}
	}
}

# TP troops into the fascist area, dismatle one member faction and spawn preview countries
GER_civil_war_setup_and_preview = { 
	hidden_effect={
		#get out of warzones
		every_owned_state = { 
			limit = {
				OR = {
					state = 60
					state = 65
					state = 989 #East Rhineland
					state = 50 
					state = 51 #Rhineland
					state = 52 #Bavaria
					state = 53 #Bavaria
					state = 54 #Bavaria
					state = 59 #Hannover, heavily contested
					state = 42 #Mosselland
					state = 922
					state = 923 #Baden
					state = 67 #Oppeln
				}
			}
			teleport_armies = {
				limit = {
					tag = GER
				}
				to_state = 56 #tried array, didnt work right, this is a strategic place
			}
		}
		
		# dismatle one member faction
		if = {
			limit = {
				is_faction_leader = yes
				NOT = {
					any_other_country = {
						is_in_faction_with = GER
					}
				}
			}
			dismantle_faction = yes
			set_rule = {
				can_create_factions = no
			}
		}

		# flag the current fascist leader for correct leadership later
		var:country_leader = {
			set_character_flag = GER_fascist_leader_flag
		}

		# create the dynamic countries
		create_dynamic_country = {
			original_tag = GER
			GER_civil_war_make_this_democratic_preview = yes
			reserve_dynamic_country = yes #reserved because we need to change stuff around in the event and also may need to get characters back for the communists after the civil war

			GER = {
				set_variable = { 
					cw_dem_preview = PREV
				}
			}
			# give_military_access = GER
		}
		create_dynamic_country = {
			original_tag = GER
			GER_civil_war_make_this_communist_preview = yes
			reserve_dynamic_country = yes
			
			GER = {
				set_variable = { 
					cw_com_preview = PREV
				}
			}
			# give_military_access = GER
		}
	}
}


# fires of the civil war by declaring wars
GER_civil_war_declare_wars = {
	every_country = {
		limit = {
			original_tag = GER
		}
		every_other_country = {
			limit = {
				original_tag = GER
				NOT = {
					has_war_with = PREV
				}
			}
			declare_war_on = {
				target = PREV
				type = civil_war
			}
			add_civil_war_target = PREV
		}
	}
}