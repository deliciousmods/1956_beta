add_namespace = r56.ger

country_event = { #Endsieg
	id = r56.ger.1
	title = r56.ger.1.t
	desc = r56.ger.1.desc
	picture = GFX_report_event_german_reichstag_bombed

	fire_only_once = yes

	trigger = {
		original_tag = GER
		has_civil_war = no
		date > 1940.1.1 #You don't get a bailout for being dumb early 
		ROOT = {
			#has_completed_focus = GER_total_war
			has_war = yes
			surrender_progress > 0.24
			casualties > 699999 #cheese prevention 
			NOT = {
				has_government = democratic
			}
			OR = {
				any_enemy_country = {
					is_major = yes 
					OR = {
						original_tag = ENG
						original_tag = USA
						original_tag = SOV
						original_tag = FRA
						original_tag = POL
						original_tag = ITA
					}
				}
				has_global_flag = had_yalta_conference
				AND = { #just incase the above stuff doesn't cause a fire and Germany is losing hard
					surrender_progress > 0.35
					casualties > 1200000 
				}
			}
		}
	}

	mean_time_to_happen = { days = 4 }

	option = { #Final Victory
		name = r56.ger.1.a
		add_ideas = r56_endsieg_idea
		ROOT = {
			custom_effect_tooltip = r56_GER_endsieg_tt
		}
		set_country_flag = r56_GER_endsieg_event_happened
		hidden_effect = {
			if = {
				limit = {
					ROOT = {
						is_ai = yes
					}
				}
				add_manpower = 20000
				add_fuel = 225
				add_offsite_building = { type = arms_factory level = 3 }
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = 5000
					producer = GER
				}
				add_equipment_to_stockpile = { 
					type = support_equipment
					amount = 235
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = light_tank_chassis
					amount = 25
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = medium_tank_chassis
					amount = 200
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = anti_air_equipment
					amount = 50
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = anti_tank_equipment 
					amount = 20
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = artillery_equipment
					amount = 100
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = motorized_equipment
					amount = 100
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = train_equipment
					amount = 15
				}
			}
			else = {
				add_manpower = 1250
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = 1000
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = train_equipment
					amount = 5
				}
			}

			if = {
				limit = {
					NOT = {
						has_tech = r56_militia_tech
					}
				}
				set_technology = {
					r56_militia_tech = 1
				}
				set_country_flag = r56_militia_formation_flag
			}
			load_oob = r56_GER_endsieg
			if = { #Cannon Endsieg units
				limit = {
					ROOT = {
						has_full_control_of_state = 60
						casualties > 2000000
					}
				}
				load_oob = r56_GER_endsieg_units_1
			}	
			if = {
				limit = {
					ROOT = {
						has_full_control_of_state = 60
					}
				}
				load_oob = r56_GER_endsieg_units_2
			}
			if = {
				limit = {
					ROOT = {
						has_full_control_of_state = 61
					}
				}
				load_oob = r56_GER_endsieg_units_3
			}
			if = {
				limit = {
					ROOT = {
						has_full_control_of_state = 52
					}
				}
				load_oob = r56_GER_endsieg_units_4
			}
			if = {
				limit = {
					ROOT = {
						has_full_control_of_state = 54
					}
				}
				load_oob = r56_GER_endsieg_units_5
			}
			if = {
				limit = {
					ROOT = {
						has_full_control_of_state = 59
					}
				}
				load_oob = r56_GER_endsieg_units_6
			}
			if = {
				limit = {
					ROOT = {
						has_full_control_of_state = 58
					}
				}
				load_oob = r56_GER_endsieg_units_7
			}
		}
	}
}

country_event = { #Pulled back from endsieg
	id = r56.ger.2
	title = r56.ger.2.t
	desc = r56.ger.2.desc
	picture = GFX_report_event_german_troops

	fire_only_once = yes

	trigger = {
		original_tag = GER
		ROOT = {
			has_war = yes
			has_capitulated = no
			surrender_progress < 0.02
			has_country_flag = r56_GER_endsieg_event_happened
		}
	}

	mean_time_to_happen = { days = 3 }

	option = { #Closer to Final Victory
		name = r56.ger.2.a
		add_war_support = 0.03
		ROOT = {
			custom_effect_tooltip = r56_GER_endsieg_2_tt
		}
		hidden_effect = {
			set_country_flag = r56_GER_endsieg_event_pullback_happened
			if = {
				limit = {
					has_idea = r56_endsieg_idea 
				}
				remove_ideas = r56_endsieg_idea 
			}
			delete_unit_template_and_units = {
				division_template = "Volkssturm"
				disband = yes 
			}
			delete_unit_template_and_units = {
				division_template = "Heeresgruppe"
				disband = yes 
			}
		}
	}	
}

country_event = { #Resolves Europe Post Yalta 
	id = r56.ger.3
	title = r56.ger.3.t
	desc = r56.ger.3.d
	picture = GFX_report_event_generic_sign_treaty2

	fire_only_once = yes

	hidden = yes

	is_triggered_only = yes

	option = { #Don't force anything on a player if possible!
		name = r56.ger.3.a
		set_province_name = { id = 587 name = "Bonn"}
		51 = {
			set_victory_points = {
				province = 587
				value = 20
			}
		}
		if = { #If WW2 ends early this flag will push every tag to want to go for their nearest WW3 option in thier FT
			limit = {
				has_global_flag = r56_yalta_script_is_a_go
				#is_historical_focus_on = no
				date < 1943.01.01
				NOT = {
					SOV = {
						OR = {
							has_war_with = USA
							has_war_with = FRA
							has_war_with = ENG
						}
					}
				}
			}
			set_global_flag = r56_ww2_got_done_early_make_ai_move_toward_ww3
		}
		if = { 
			limit = {
				has_global_flag = r56_yalta_script_is_a_go
				GER = {
					is_ai = yes
				}
			}
			if = { #first things first
				limit = {
					85 = {
						is_claimed_by = GER
					}
				}
				85 = {
					remove_claim_by = GER
				}
			}
			if = { 
				limit = {
					188 = {
						is_claimed_by = GER
					}
				}
				188 = {
					remove_claim_by = GER
				}
			}
			GER = { #This happened once and it was werid
				if = {
					limit = {
						is_ai = yes
						has_dlc = "Man the Guns"
						is_government_in_exile = yes
						is_ai = yes
					}
					end_exile = yes
				}
			}
			if = {
				limit = {
					has_global_flag = r56_ITA_in_yalta
					has_global_flag = r56_yalta_origin_is_neutrality
					ITA = {
						is_ai = yes
						NOT = {
							has_government = neutrality
						}
					}
				}
				ITA = {
					set_politics = { ruling_party = neutrality elections_allowed = no }
					add_popularity = {
						ideology = neutrality
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_ITA_in_yalta
					has_global_flag = r56_yalta_origin_is_fascism
					ITA = {
						is_ai = yes
						NOT = {
							has_government = fascism
						}
					}
				}
				ITA = {
					set_politics = { ruling_party = fascism elections_allowed = no }
					add_popularity = {
						ideology = fascism
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_ITA_in_yalta
					has_global_flag = r56_yalta_origin_is_communism
					ITA = {
						is_ai = yes
						NOT = {
							has_government = communism
						}
					}
				}
				ITA = {
					set_politics = { ruling_party = communism elections_allowed = no }
					add_popularity = {
						ideology = communism
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_ITA_in_yalta
				}
				if = {
					limit = {
						ITA = {
							is_subject_of = SOV
						}
					}
					SOV = {
						end_puppet = ITA
					}
				}
				every_state = { 
					limit = {
						is_core_of = ITA
						is_owned_and_controlled_by = AUS
						NOT = {
							is_core_of = CZE
							is_core_of = DDR
							is_core_of = SOV
							is_core_of = POL
							is_core_of = AUS
							is_core_of = DEN
							is_core_of = BEL
							is_core_of = HOL
							is_core_of = FRA
							is_core_of = SWI
						}
					}
					ITA = {
						transfer_state = PREV
					}
				}
				if = {
					limit = {
						SAD = {
							is_ai = yes
							NOT = {
								is_subject_of = ITA
							}
						}
					}
					every_state = { 
						limit = {
							is_core_of = ITA
							owner = {
								is_ai = yes
							}
							is_owned_and_controlled_by = SAD
							NOT = {
								is_core_of = CZE
								is_core_of = DDR
								is_core_of = SOV
								is_core_of = POL
								is_core_of = AUS
								is_core_of = DEN
								is_core_of = BEL
								is_core_of = HOL
								is_core_of = FRA
								is_core_of = SWI
							}
						}
						ITA = {
							transfer_state = PREV
						}
					}
				}
				if = {
					limit = {
						NAP = {
							is_ai = yes
							NOT = {
								is_subject_of = ITA
							}
						}
					}
					every_state = { 
						limit = {
							is_core_of = ITA
							owner = {
								is_ai = yes
							}
							is_owned_and_controlled_by = NAP
							NOT = {
								is_core_of = CZE
								is_core_of = DDR
								is_core_of = SOV
								is_core_of = POL
								is_core_of = AUS
								is_core_of = DEN
								is_core_of = BEL
								is_core_of = HOL
								is_core_of = FRA
								is_core_of = SWI
							}
						}
						ITA = {
							transfer_state = PREV
						}
					}
				}
				if = {
					limit = {
						SLV = {
							is_ai = yes
							NOT = {
								is_subject_of = ITA
							}
						}
					}
					every_state = { 
						limit = {
							is_core_of = ITA
							owner = {
								is_ai = yes
							}
							is_owned_and_controlled_by = SLV
							NOT = {
								is_core_of = CZE
								is_core_of = DDR
								is_core_of = SOV
								is_core_of = POL
								is_core_of = AUS
								is_core_of = DEN
								is_core_of = BEL
								is_core_of = HOL
								is_core_of = FRA
								is_core_of = SWI
							}
						}
						ITA = {
							transfer_state = PREV
						}
					}
				}
				if = {
					limit = {
						CRO = {
							is_ai = yes
							NOT = {
								is_subject_of = ITA
							}
						}
					}
					every_state = { 
						limit = {
							is_core_of = ITA
							owner = {
								is_ai = yes
							}
							is_owned_and_controlled_by = CRO
							NOT = {
								is_core_of = CZE
								is_core_of = DDR
								is_core_of = SOV
								is_core_of = POL
								is_core_of = AUS
								is_core_of = DEN
								is_core_of = BEL
								is_core_of = HOL
								is_core_of = FRA
								is_core_of = SWI
							}
						}
						ITA = {
							transfer_state = PREV
						}
					}
				}
				if = {
					limit = {
						VNZ = {
							is_ai = yes
							NOT = {
								is_subject_of = ITA
							}
						}
					}
					every_state = { 
						limit = {
							is_core_of = ITA
							owner = {
								is_ai = yes
							}
							is_owned_and_controlled_by = VNZ
							NOT = {
								is_core_of = CZE
								is_core_of = DDR
								is_core_of = SOV
								is_core_of = POL
								is_core_of = AUS
								is_core_of = DEN
								is_core_of = BEL
								is_core_of = HOL
								is_core_of = FRA
								is_core_of = SWI
							}
						}
						ITA = {
							transfer_state = PREV
						}
					}
				}
				if = {
					limit = {
						SIC = {
							is_ai = yes
							NOT = {
								is_subject_of = ITA
							}
						}
					}
					every_state = { 
						limit = {
							is_core_of = ITA
							owner = {
								is_ai = yes
							}
							is_owned_and_controlled_by = SIC
							NOT = {
								is_core_of = CZE
								is_core_of = DDR
								is_core_of = SOV
								is_core_of = POL
								is_core_of = AUS
								is_core_of = DEN
								is_core_of = BEL
								is_core_of = HOL
								is_core_of = FRA
								is_core_of = SWI
							}
						}
						ITA = {
							transfer_state = PREV
						}
					}
				}
			}
			every_state = { 
				limit = {
					is_core_of = WGR
					OR = {
						is_owned_and_controlled_by = GER
						is_owned_and_controlled_by = BAY
						is_owned_and_controlled_by = SOV
						is_owned_and_controlled_by = FRA
						is_owned_and_controlled_by = USA
						is_owned_and_controlled_by = ENG
						is_owned_and_controlled_by = CHI
					}
					NOT = {
						is_core_of = CZE
						is_core_of = DDR
						is_core_of = SOV
						is_core_of = POL
						is_core_of = AUS
						is_core_of = DEN
						is_core_of = BEL
						is_core_of = HOL
						is_core_of = FRA
						is_core_of = SWI
					}
				}
				WGR = {
					transfer_state = PREV
				}
			}
			every_state = { 
				limit = {
					OR = {
						is_core_of = SOV
						is_core_of = LIT
					}
					owner = {
						is_ai = yes
					}
					OR = {
						is_owned_and_controlled_by = GER
						is_owned_and_controlled_by = HUN
						is_owned_and_controlled_by = ENG
					}
					NOT = {
						is_core_of = DDR
						is_core_of = POL
						is_core_of = ROM
					}
				}
				SOV = {
					transfer_state = PREV
				}
			}
			every_state = { 
				limit = {
					is_core_of = DDR
					owner = {
						is_ai = yes
					}
					OR = {
						is_owned_and_controlled_by = GER
						is_owned_and_controlled_by = SOV
						is_owned_and_controlled_by = ITA
						is_owned_and_controlled_by = POL
						is_owned_and_controlled_by = CHI
					}
					NOT = {
						is_core_of = CZE
						is_core_of = WGR
						is_core_of = SOV
						is_core_of = POL
						is_core_of = AUS
					}
				}
				DDR = {
					transfer_state = PREV
				}
			}
			#The fact I have to double check for everything is upsetting. Fix your on actions PDX
			if = { #Double check. Effects don't fire sometimes
				limit = {
					DDR = {
						NOT = {
							is_puppet_of = SOV
						}
					}
				}
				SOV = {
					puppet = DDR
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = DDR
					61 = { 
						is_core_of = GER
						is_owned_and_controlled_by = DDR
					}
				}
				61 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = DDR
					62 = { 
						is_core_of = GER
						is_owned_and_controlled_by = DDR
					}
				}
				62 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = DDR
					64 = { 
						is_core_of = GER
						is_owned_and_controlled_by = DDR
					}
				}
				64 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = DDR
					65 = { 
						is_core_of = GER
						is_owned_and_controlled_by = DDR
					}
				}
				65 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = DDR
					60 = { 
						is_core_of = GER
						is_owned_and_controlled_by = DDR
					}
				}
				60 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					51 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				51 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					923 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				923 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					42 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				42 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					50 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				50 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					52 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				52 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					53 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				53 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					54 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				54 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					55 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				55 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					59 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				59 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					56 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				56 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					58 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				58 = {
					remove_core_of = GER
				}
			}
			if = { #Double check. Effects don't fire sometimes
				limit = {
					country_exists = WGR
					998 = { 
						is_core_of = GER
						is_owned_and_controlled_by = WGR
					}
				}
				998 = {
					remove_core_of = GER
				}
			}
			if = {
				limit = {
					has_global_flag = r56_CZE_in_yalta
				}
				SOV = {
					puppet = CZE
				}
				every_state = { 
					limit = {
						is_core_of = CZE
						OR = {
							is_owned_and_controlled_by = GER
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = WGR
							is_owned_and_controlled_by = DDR
						}
						NOT = {
							is_core_of = DDR
							is_core_of = WGR
							is_core_of = SOV
							is_core_of = POL
							is_core_of = RUT
						}
					}
					CZE = {
						transfer_state = PREV
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_AUS_in_yalta
				}
				if = {
					limit = {
						AUS = {
							is_subject_of = SOV
						}
					}
					SOV = {
						end_puppet = AUS
					}
				}
				if = {
					limit = {
						AUS = {
							is_in_faction_with = SOV
						}
					}
					SOV = { remove_from_faction = AUS }
				}
				if = {
					limit = {
						NOT = {
							has_global_flag = r56_yalta_origin_is_communism
							has_global_flag = r56_yalta_origin_is_fascism
							has_global_flag = r56_yalta_origin_is_neutrality
						}
						AUS = {
							NOT = {
								has_government = democratic
							}
						}
					}
					AUS = {
						set_politics = { ruling_party = democratic elections_allowed = yes }
						add_popularity = {
							ideology = democratic
							popularity = 0.5
						}
					}
				}
				every_state = { 
					limit = {
						is_core_of = AUS
						owner = {
							is_ai = yes
						}
						OR = {
							is_owned_and_controlled_by = GER
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = WGR
							if = {
								limit = {
									has_global_flag = r56_YUG_in_yalta
								}
								is_owned_and_controlled_by = YUG
							}
						}
						NOT = {
							is_core_of = CZE
							is_core_of = ITA
							is_core_of = WGR
						}
					}
					AUS = {
						transfer_state = PREV
					}
				}

			}
			if = {
				limit = {
					has_global_flag = r56_SLO_in_yalta
				}
				every_state = { 
					limit = {
						is_core_of = SLO
						owner = {
							is_ai = yes
						}
						OR = {
							is_owned_and_controlled_by = GER
							is_owned_and_controlled_by = SLO
							is_owned_and_controlled_by = SOV
						}
						NOT = {
							is_core_of = RUT
							is_core_of = POL
							is_core_of = SOV
						}
					}
					CZE = {
						transfer_state = PREV
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_POL_in_yalta
				}
				SOV = {
					puppet = POL
				}
				every_state = { 
					limit = {
						is_core_of = POL
						owner = {
							is_ai = yes
						}
						OR = {
							is_owned_and_controlled_by = GER
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = SLO
							is_owned_and_controlled_by = ENG
							is_owned_and_controlled_by = CHI
						}
						NOT = {
							is_core_of = BLR
							is_core_of = CZE
							is_core_of = SOV
							is_core_of = RUT
							is_core_of = SLO
							is_core_of = LIT
						}
					}
					POL = {
						transfer_state = PREV
					}
				}
				if = {
					limit = {
						has_global_flag = r56_ITA_in_yalta
					}
					every_state = { 
						limit = {
							is_core_of = POL
							is_owned_and_controlled_by = ITA
							owner = {
								is_ai = yes
							}
							NOT = {
								is_core_of = BLR
								is_core_of = CZE
								is_core_of = SOV
								is_core_of = RUT
								is_core_of = SLO
							}
						}
						POL = {
							transfer_state = PREV
						}
					}
				}
				if = {
					limit = {
						85 = {
							OR = {
								is_owned_and_controlled_by = GER
								is_owned_and_controlled_by = SOV
								is_owned_and_controlled_by = SLO
								is_owned_and_controlled_by = ENG
								is_owned_and_controlled_by = ITA
								is_owned_and_controlled_by = FRA
							}
							is_claimed_by = POL
						}
					}
					POL = {
						transfer_state = 85
					}
				}
				if = {
					limit = {
						97 = {
							OR = {
								is_owned_and_controlled_by = GER
								is_owned_and_controlled_by = SOV
								is_owned_and_controlled_by = SLO
								is_owned_and_controlled_by = ENG
								is_owned_and_controlled_by = ITA
								is_owned_and_controlled_by = FRA
							}
							is_claimed_by = POL
						}
					}
					POL = {
						transfer_state = 97
					}
				}
			}
			every_state = { 
				limit = {
					is_core_of = SOV
					owner = {
						is_ai = yes
					}
					OR = {
						is_owned_and_controlled_by = HUN
						is_owned_and_controlled_by = RUT
						is_core_of = RUT
					}
				}
				SOV = {
					transfer_state = PREV
				}
			}
			if = {
				limit = {
					has_global_flag = r56_YUG_in_yalta
				}
				if = {
					limit = {
						CRO = {
							is_ai = yes
							NOT = {
								is_subject_of = YUG
							}
						}
					}
					every_state = { 
						limit = {
							owner = {
								is_ai = yes
							}
							is_core_of = YUG
							is_owned_and_controlled_by = CRO
						}
						YUG = {
							transfer_state = PREV
						}
					}
				}
				if = {
					limit = {
						YUG = {
							is_ai = yes
							NOT = {
								has_government = communism
							}
						}
						SOV = {
							has_government = communism
						}
					}
					YUG = {	
						add_popularity = {
							ideology = communism
							popularity = 0.55
						}
						set_politics = { ruling_party = communism elections_allowed = no }
						if = {
							limit = {
								NOT = {
									has_completed_focus = YUG_join_comintern
								}
								SOV = {
									has_country_leader = { character = SOV_iosif_stalin }
								}
								has_country_leader = { character = YUG_josip_broz_tito }
							}
							add_country_leader_trait = dislikes_russia
						}
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_HUN_in_yalta
				}
				if = {
					limit = {
						HUN = {
							is_ai = yes
						}
					}
					SOV = {
						puppet = HUN
					}
				}
				every_state = { 
					limit = {
						is_core_of = HUN
						owner = {
							is_ai = yes
						}
						OR = {
							is_owned_and_controlled_by = GER
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = ITA
							is_owned_and_controlled_by = YUG
							is_owned_and_controlled_by = ROM #new 11/2023 - please dont bordergore Hungary
							is_owned_and_controlled_by = CZE #new 11/2023 - please dont bordergore Hungary
							is_owned_and_controlled_by = AUS #new 11/2023 - please dont bordergore Hungary
						}
						NOT = {
							is_core_of = ROM
							is_core_of = CZE
							is_core_of = SOV
							is_core_of = RUT
							is_core_of = YUG
							is_core_of = GER
						}
					}
					HUN = {
						transfer_state = PREV
					}
				}
			}
			if = { #No double puppets
				limit = {
					has_global_flag = r56_ROM_in_yalta
				}
				if = {
					limit = {
						ROM = {
							is_ai = yes
							is_subject = no
						}
						SOV = {
							exists = yes
						}
					}
					SOV = {
						puppet = ROM
					}
				}
				if = {
					limit = {
						TRA = {
							is_ai = yes
							is_puppet_of = SOV
						}
					}
					every_state = { 
						limit = {
							is_core_of = ROM
							owner = {
								is_ai = yes
							}
							OR = {
								is_owned_and_controlled_by = GER
								is_owned_and_controlled_by = SOV
								is_owned_and_controlled_by = TRA
							}
							NOT = {
								is_core_of = CZE
								is_core_of = SOV
								is_core_of = RUT
								is_core_of = BUL
							}
						}
						ROM = {
							transfer_state = PREV
						}
					}
				}	
			}
			if = { #No double puppets
				limit = {
					has_global_flag = r56_ROM_in_yalta
				}
				if = {
					limit = {
						ROM = {
							is_subject_of = SOV
						}
						SZK = {
							is_ai = yes
							is_puppet_of = SOV
						}
					}
					every_state = { 
						limit = {
							is_core_of = ROM
							owner = {
								is_ai = yes
							}
							OR = {
								is_owned_and_controlled_by = GER
								is_owned_and_controlled_by = SOV
								is_owned_and_controlled_by = SZK
							}
							NOT = {
								is_core_of = CZE
								is_core_of = SOV
								is_core_of = RUT
								is_core_of = BUL
							}
						}
						ROM = {
							transfer_state = PREV
						}
					}
				}
				if = { #Bessarabia
					limit = {
						565 = {
							is_owned_and_controlled_by = ROM
							is_claimed_by = SOV
						}
					}
					SOV = {
						transfer_state = 565 
					}
				}
				if = {
					limit = {
						766 = {
							is_owned_and_controlled_by = ROM
							is_claimed_by = SOV
						}
					}
					SOV = {
						transfer_state = 766
					}
				}	
			}
			if = {
				limit = {
					has_global_flag = r56_BUL_in_yalta
					SOV = {
						exists = yes
					}
				}
				if = {
					limit = {
						BUL = {
							is_ai = yes
							is_subject = no
						}
					}
					SOV = {
						puppet = BUL
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_BUL_in_yalta
					has_global_flag = r56_GRE_in_yalta
					BUL = {
						is_ai = yes
					}
				}
				every_state = { 
					limit = {
						is_core_of = GRE
						is_core_of = BUL
						owner = {
							is_ai = yes
						}
						OR = {
							is_owned_and_controlled_by = BUL
							is_owned_and_controlled_by = GER
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = GRE
							is_owned_and_controlled_by = YUG
							is_owned_and_controlled_by = ITA
							is_owned_and_controlled_by = ENG
							is_owned_and_controlled_by = FRA
							is_owned_and_controlled_by = USA
						}
						NOT = {
							is_core_of = TUR
							is_core_of = ITA
							is_core_of = ALB
						}
					}
					GRE = {
						transfer_state = PREV
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_ALB_in_yalta
				}
				every_state = { 
					limit = {
						is_core_of = ALB
						owner = {
							is_ai = yes
						}
						OR = {
							is_owned_and_controlled_by = GER
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = GRE
							is_owned_and_controlled_by = YUG
							is_owned_and_controlled_by = ITA
							is_owned_and_controlled_by = ENG
							is_owned_and_controlled_by = FRA
							is_owned_and_controlled_by = USA
						}
						NOT = {
							is_core_of = ITA
							is_core_of = YUG
						}
					}
					ALB = {
						transfer_state = PREV
					}
				}
				if = {
					limit = {
						ALB = {
							is_ai = yes
						}
					}
					if = {
						limit = {
							ALB = {
								NOT = {
									has_government = communism
								}
								SOV = {
									has_government = communism
								}
							}
						}
						ALB = {
							set_politics = { ruling_party = communism elections_allowed = no }
							add_popularity = {
								ideology = communism
								popularity = 0.5
							}
						}
					}
					
				}
			}
			if = {
				limit = {
					has_global_flag = r56_LUX_in_yalta
				}
				if = {
					limit = {
						LUX = {
							is_subject_of = SOV
						}
					}
					SOV = {
						end_puppet = LUX
					}
				}
				if = {
					limit = {
						has_global_flag = r56_LUX_in_yalta
						has_global_flag = r56_yalta_origin_is_fascism
						LUX = {
							NOT = {
								has_government = fascism
							}
						}
					}
					LUX = {
						set_politics = { ruling_party = fascism elections_allowed = no }
						add_popularity = {
							ideology = fascism
							popularity = 0.5
						}
					}
				}
				if = {
					limit = {
						has_global_flag = r56_LUX_in_yalta
						has_global_flag = r56_yalta_origin_is_communism
						LUX = {
							NOT = {
								has_government = communism
							}
						}
					}
					LUX = {
						set_politics = { ruling_party = communism elections_allowed = no }
						add_popularity = {
							ideology = communism
							popularity = 0.5
						}
					}
				}
				every_state = { 
					limit = {
						is_core_of = LUX
						OR = {
							is_owned_and_controlled_by = WGR
							is_owned_and_controlled_by = DDR
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = GER
							is_owned_and_controlled_by = FRA
						}
						NOT = {
							is_core_of = CZE
							is_core_of = WGR
							is_core_of = FRA
							is_core_of = BEL
							is_core_of = HOL
						}
					}
					LUX = {
						transfer_state = PREV
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_DEN_in_yalta
				}
				if = {
					limit = {
						DEN = {
							is_subject_of = SOV
						}
					}
					SOV = {
						end_puppet = DEN
					}
					if = {
						limit = {
							has_global_flag = r56_DEN_in_yalta
							NOT = {
								has_global_flag = r56_yalta_origin_is_communism
								has_global_flag = r56_yalta_origin_is_fascism
								has_global_flag = r56_yalta_origin_is_neutrality
							}
							DEN = {
								NOT = {
									has_government = democratic
								}
							}
						}
						DEN = {
							add_popularity = {
								ideology = democratic
								popularity = 0.5
							}
							set_politics = { ruling_party = democratic elections_allowed = no }
						}
					}
				}
				every_state = { 
					limit = {
						is_core_of = DEN
						OR = {
							is_owned_and_controlled_by = WGR
							is_owned_and_controlled_by = DDR
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = GER
							is_owned_and_controlled_by = FRA
						}
						NOT = {
							is_core_of = CZE
							is_core_of = WGR
							is_core_of = FRA
							is_core_of = BEL
							is_core_of = HOL
							is_core_of = NOR
						}
					}
					DEN = {
						transfer_state = PREV
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_BEL_in_yalta
				}
				if = {
					limit = {
						BEL = {
							is_subject_of = SOV
						}
					}
					SOV = {
						end_puppet = BEL
					}
				}
				every_state = { 
					limit = {
						is_core_of = BEL
						OR = {
							is_owned_and_controlled_by = WGR
							is_owned_and_controlled_by = DDR
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = GER
						}
						NOT = {
							is_core_of = CZE
							is_core_of = WGR
							is_core_of = FRA
							is_core_of = LUX
							is_core_of = HOL
							is_core_of = NOR
						}
					}
					BEL = {
						transfer_state = PREV
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_BEL_in_yalta
					has_global_flag = r56_yalta_origin_is_neutrality
					BEL = {
						NOT = {
							has_government = neutrality
						}
					}
				}
				BEL = {
					set_politics = { ruling_party = neutrality elections_allowed = no }
					add_popularity = {
						ideology = neutrality
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_BEL_in_yalta
					has_global_flag = r56_yalta_origin_is_fascism
					BEL = {
						NOT = {
							has_government = fascism
						}
					}
				}
				BEL = {
					set_politics = { ruling_party = fascism elections_allowed = no }
					add_popularity = {
						ideology = fascism
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_BEL_in_yalta
					has_global_flag = r56_yalta_origin_is_communism
					BEL = {
						NOT = {
							has_government = communism
						}
					}
				}
				BEL = {
					set_politics = { ruling_party = communism elections_allowed = no }
					add_popularity = {
						ideology = communism
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_HOL_in_yalta
				}
				if = {
					limit = {
						HOL = {
							is_subject_of = SOV
						}
					}
					SOV = {
						end_puppet = HOL
					}
				}
				every_state = { 
					limit = {
						is_core_of = HOL
						owner = {
							is_ai = yes
						}
						OR = {
							is_owned_and_controlled_by = GER
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = WGR
							is_owned_and_controlled_by = DDR
						}
					}
					HOL = {
						transfer_state = PREV
					}
				}
				every_state = { 
					limit = {
						owner = {
							is_ai = yes
						}
						OR = {
							is_core_of = HOL
							is_core_of = SUR
						}
						OR = {
							is_owned_and_controlled_by = WGR
							is_owned_and_controlled_by = GER
							is_owned_and_controlled_by = DDR
							is_owned_and_controlled_by = SOV
						}
						NOT = {
							is_core_of = CZE
							is_core_of = WGR
							is_core_of = FRA
							is_core_of = BEL
							is_core_of = LUX
							is_core_of = NOR
						}
					}
					HOL = {
						transfer_state = PREV
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_HOL_in_yalta
					has_global_flag = r56_yalta_origin_is_neutrality
					HOL = {
						NOT = {
							has_government = neutrality
						}
					}
				}
				HOL = {
					set_politics = { ruling_party = neutrality elections_allowed = no }
					add_popularity = {
						ideology = neutrality
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_HOL_in_yalta
					has_global_flag = r56_yalta_origin_is_fascism
					HOL = {
						NOT = {
							has_government = fascism
						}
					}
				}
				HOL = {
					set_politics = { ruling_party = fascism elections_allowed = no }
					add_popularity = {
						ideology = fascism
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_HOL_in_yalta
					has_global_flag = r56_yalta_origin_is_communism
					HOL = {
						NOT = {
							has_government = communism
						}
					}
				}
				HOL = {
					set_politics = { ruling_party = communism elections_allowed = no }
					add_popularity = {
						ideology = communism
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_NOR_in_yalta
				}
				if = {
					limit = {
						NOR = {
							is_subject_of = SOV
						}
					}
					SOV = {
						end_puppet = NOR
					}
					if = {
						limit = {
							has_global_flag = r56_NOR_in_yalta
							NOT = {
								has_global_flag = r56_yalta_origin_is_communism
								has_global_flag = r56_yalta_origin_is_fascism
								has_global_flag = r56_yalta_origin_is_neutrality
							}
							NOR = {
								NOT = {
									has_government = democratic
								}
							}
						}
						NOR = {
							set_politics = { ruling_party = democratic elections_allowed = no }
							add_popularity = {
								ideology = democratic
								popularity = 0.5
							}
						}
					}
				}
				every_state = { 
					limit = {
						is_core_of = NOR
						OR = {
							is_owned_and_controlled_by = WGR
							is_owned_and_controlled_by = DDR
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = GER
						}
						NOT = {
							is_core_of = CZE
							is_core_of = WGR
							is_core_of = FRA
							is_core_of = BEL
							is_core_of = HOL
							is_core_of = NOR
						}
					}
					NOR = {
						transfer_state = PREV
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_NOR_in_yalta
					has_global_flag = r56_yalta_origin_is_neutrality
					NOR = {
						NOT = {
							has_government = neutrality
						}
					}
				}
				NOR = {
					set_politics = { ruling_party = neutrality elections_allowed = no }
					add_popularity = {
						ideology = neutrality
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_NOR_in_yalta
					has_global_flag = r56_yalta_origin_is_fascism
					NOR = {
						NOT = {
							has_government = fascism
						}
					}
				}
				NOR = {
					set_politics = { ruling_party = fascism elections_allowed = no }
					add_popularity = {
						ideology = fascism
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_NOR_in_yalta
					has_global_flag = r56_yalta_origin_is_communism
					NOR = {
						NOT = {
							has_government = communism
						}
					}
				}
				NOR = {
					set_politics = { ruling_party = communism elections_allowed = no }
					add_popularity = {
						ideology = communism
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_SWE_in_yalta
				}
				if = {
					limit = {
						SOV = {
							is_ai = yes
						}
						SWE = {
							is_subject_of = SOV
							NOT = {
								has_completed_focus = SWE_sven_olov_addresses_aland_convention #Willing went evil. You don't get to opt out now
							}
						}
					}
					SOV = {
						end_puppet = SWE
					}
					if = {
						limit = {
							has_global_flag = r56_SWE_in_yalta
							NOT = {
								has_global_flag = r56_yalta_origin_is_communism
								has_global_flag = r56_yalta_origin_is_fascism
								has_global_flag = r56_yalta_origin_is_neutrality
							}
							SWE = {
								NOT = {
									has_government = democratic
								}
							}
						}
						SWE = {
							set_politics = { ruling_party = democratic elections_allowed = no }
							add_popularity = {
								ideology = democratic
								popularity = 0.5
							}
						}
					}
				}
				every_state = { 
					limit = {
						is_core_of = SWE
						owner = {
							is_ai = yes
						}
						OR = {
							is_owned_and_controlled_by = WGR
							is_owned_and_controlled_by = DDR
							is_owned_and_controlled_by = SOV
							is_owned_and_controlled_by = GER
						}
						NOT = {
							is_core_of = DEN
							is_core_of = WGR
							is_core_of = FRA
							is_core_of = BEL
							is_core_of = HOL
							is_core_of = NOR
							is_core_of = AHV
							is_core_of = FIN
						}
					}
					SWE = {
						transfer_state = PREV
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_SWE_in_yalta
					has_global_flag = r56_yalta_origin_is_neutrality
					SWE = {
						NOT = {
							has_government = neutrality
						}
					}
				}
				SWE = {
					set_politics = { ruling_party = neutrality elections_allowed = no }
					add_popularity = {
						ideology = neutrality
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_SWE_in_yalta
					has_global_flag = r56_yalta_origin_is_fascism
					SWE = {
						NOT = {
							has_government = fascism
						}
					}
				}
				SWE = {
					set_politics = { ruling_party = fascism elections_allowed = no }
					add_popularity = {
						ideology = fascism
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_SWE_in_yalta
					has_global_flag = r56_yalta_origin_is_communism
					SWE = {
						NOT = {
							has_government = communism
						}
					}
				}
				SWE = {
					set_politics = { ruling_party = communism elections_allowed = no }
					add_popularity = {
						ideology = communism
						popularity = 0.5
					}
				}
			}
			if = { #If Finland doesn't peace out, it pays the price 
				limit = {
					has_global_flag = r56_FIN_in_yalta
					has_global_flag = r56_yalta_origin_is_neutrality
					FIN = {
						NOT = {
							has_government = neutrality
						}
					}
				}
				FIN = {
					set_politics = { ruling_party = neutrality elections_allowed = no }
					add_popularity = {
						ideology = neutrality
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_FIN_in_yalta
					has_global_flag = r56_yalta_origin_is_fascism
					FIN = {
						NOT = {
							has_government = fascism
						}
					}
				}
				FIN = {
					set_politics = { ruling_party = fascism elections_allowed = no }
					add_popularity = {
						ideology = fascism
						popularity = 0.5
					}
				}
			}
			if = {
				limit = {
					has_global_flag = r56_FIN_in_yalta
					has_global_flag = r56_yalta_origin_is_communism
					FIN = {
						NOT = {
							has_government = communism
						}
					}
				}
				FIN = {
					set_politics = { ruling_party = communism elections_allowed = no }
					add_popularity = {
						ideology = communism
						popularity = 0.5
					}
				}
			}
			if = { #No double puppets
				limit = {
					has_global_flag = r56_FIN_in_yalta
				}
				#if = {	#no effects? - Fantom
				#	limit = {
				#		SOV = {
				#			is_ai = yes
				#		}
				#		FIN = {
				#			is_ai = yes
				#			is_puppet_of = SOV
				#		}
				#		SMI = {
				#			is_ai = yes
				#		}
				#	}
				#}
				if = {
					limit = {
						SMI = {
							is_ai = yes
							is_puppet_of = SOV
						}
					}
					every_state = { 
						limit = {
							is_core_of = FIN
							owner = {
								is_ai = yes
							}
							OR = {
								is_owned_and_controlled_by = GER
								is_owned_and_controlled_by = SOV
								is_owned_and_controlled_by = SMI
							}
							NOT = {
								is_core_of = GER
								is_core_of = SOV
								is_core_of = NOR
								is_core_of = EST
							}
						}
						FIN = {
							transfer_state = PREV
						}
					}
				}	
			}
			if = { #No double puppets
				limit = {
					has_global_flag = r56_FIN_in_yalta
					SOV = {
						is_ai = yes
					}
				}
				#if = {	#no effects? - Fantom
				#	limit = {
				#		FIN = {
				#			is_ai = yes
				#			is_puppet_of = SOV
				#		}
				#	}
				#}
				if = {
					limit = {
						AHV = {
							is_ai = yes
							is_puppet_of = SOV
						}
					}
					every_state = { 
						limit = {
							is_core_of = FIN
							OR = {
								is_owned_and_controlled_by = GER
								is_owned_and_controlled_by = SOV
								is_owned_and_controlled_by = AHV
							}
							NOT = {
								is_core_of = GER
								is_core_of = SOV
								is_core_of = NOR
								is_core_of = EST
							}
						}
						FIN = {
							transfer_state = PREV
						}
					}
				}	
			}
		}
	}
}

country_event = { #Wilhelm III dies
	id = r56.ger.4
	title = r56.ger.4.t
	desc = r56.ger.4.desc
	picture = GFX_report_event_europe_funeral

	fire_only_once = yes
	#trigger = {
	#	OR = {
	#		has_idea = GER_wilhelm_iii
	#		has_country_leader = { character = GER_wilhelm_iii  }
	#	}
	#	
	#	date > 1951.04.03
	#}
	#mean_time_to_happen = {
	#	days = 42
	#}
	is_triggered_only = yes # Obsolete event, replaced by another

	option = { 
		name = r56.ger.4.a
		if = {
			limit = {
				has_country_leader = { character = GER_wilhelm_iii  }
			}
			every_country = {
				limit = {
					has_country_leader = { character = GER_wilhelm_iii  }
				}
				kill_ideology_leader = neutrality
				#add_ideas = GER_wilhelm_iv
			}

		}
		if = {
			limit = {
				has_idea = GER_wilhelm_iii_idea
			}
			every_country = {
				limit ={
					has_country_leader = { character = GER_wilhelm_iii  }
				}
				#swap_ideas = { remove_idea = GER_wilhelm_iii add_idea = GER_wilhelm_iv }
			}
			
		}		
		
	}
}

country_event = { #Historical post yalta fixing by marijn211
	id = r56.ger.5
	title = soviet.106.t
	desc = soviet.106.d
	picture = GFX_report_event_spanish_emigres

	fire_only_once = yes
	
	hidden = yes

	is_triggered_only = yes

	option = {
		name = soviet.106.a
		if = { #Dont bother fixing DDR/GDR fixing if too ahistorical
			limit = {
				has_global_flag = r56_historical_occupation_yalta_allowed
			}
			news_event = {
				id = r56.news_event.30
			}
			USA = {
				annex_country = {
					target = WGR
					transfer_troops = no
				}
			}
			SOV = {
				annex_country = {
					target = DDR
					transfer_troops = no
				}
			}
			#French occupation zone
			if = { #Wurttemberg
				limit = {
					#Someone changed my code with is_ai CHECKS WERE HERE, but thats  stupid as Im giving them a load of land for free to divide, if its a player they shouldnt just keep that
					50 = {
						is_owned_by = USA
					}
				}
				FRA = { transfer_state = 50 }
			}
			if = { #Baden
				limit = {
					923 = {  
						is_owned_by = USA
					}
				}
				FRA = { transfer_state = 923 }
			}
			if = { #Moselland
				limit = {
					42 = { 
						is_owned_by = USA
					}
				}
				FRA = { transfer_state = 42 }
			}
			if = { #Saarland
				limit = {
					1053 = { 
						is_owned_by = USA
					}
				}
				FRA = { transfer_state = 1053 }
			}
			#British occupation zone
			if = { #Wesser-Ems
				limit = {
					56 = {  
						is_owned_by = USA
					}
				}
				ENG = { transfer_state = 56 }
			}
			if = { #Westfalen
				limit = {
					57 = {  
						is_owned_by = USA
					}
				}
				ENG = { transfer_state = 57 }
			}
			if = { #Holstein
				limit = {
					58 = {  
						is_owned_by = USA
					}
				}
				ENG = { transfer_state = 58 }
			}
			if = { #Southern Schweslig
				limit = {
					998 = {  
						is_owned_by = USA
					}
				}
				ENG = { transfer_state = 998 }
			}
			if = { #Hanover
				limit = {
					59 = {  
						is_owned_by = USA
					}
				}
				ENG = { transfer_state = 59 }
			}
			if = { #Rhineland
				limit = {
					51 = {  
						is_owned_by = USA
					}
				}
				ENG = { transfer_state = 51 }
			}
			if = { #Ost-Rhineland
				limit = {
					989 = {  
						is_owned_by = USA
					}
				}
				ENG = { transfer_state = 989 }
			}
			every_state = {
				remove_claim_by = GER #lets not
			}
			every_state = {	#prevent premature WGR/DDR formation, but reinstate GER cores for decisions
				limit = {
					OR = {
						is_core_of = DDR
						is_core_of = WGR
					}
				}
				add_core_of = GER	#simplifies occupation decisions, people releasing GER manually should be accounted for in the decisions
				remove_core_of = DDR
				remove_core_of = WGR
			}
			set_global_flag = r56_unlocked_fate_of_germany_decisions #unlock decisions that allow DDR/WGR formation
			if = {
				limit = {
					has_global_flag = r56_AUS_in_yalta
				}
				USA = {
					annex_country = {
						target = AUS
						transfer_troops = no
					}
				}
				if = { #Tyrol - Austria
					limit = {
						153 = {  
							is_owned_by = USA
						}
					}
					FRA = { transfer_state = 153 }
				}
				if = { #Vorarlberg - Austria
					limit = {
						848 = {  
							is_owned_by = USA
						}
					}
					FRA = { transfer_state = 848 }
				}
				if = { #Soviet Austria
					limit = {
						4 = { #Lower Austria
							is_owned_by = USA
						}
					}
					SOV = { transfer_state = 4 }
				}
				if = { #Bri'ish Austria
					limit = {
						1054 = { #Lower Austria
							is_owned_by = USA
						}
					}
					ENG = { transfer_state = 1054 }
				}
				set_global_flag = r56_unlocked_fate_of_austria_decisions
				every_state = {
					limit = {
						OR = {
							is_owned_by = ENG
							is_owned_by = FRA
							is_owned_by = USA
						}
						OR = {
							is_core_of = GER
							is_core_of = AUS
						}
						has_resistance = yes
						compliance < 20
					}
					set_compliance = 20
				}
				every_state = {
					limit = {
						is_owned_by = SOV
						OR = {
							is_core_of = GER
							is_core_of = AUS
						}
						has_resistance = yes
						compliance < 10
					}
					set_compliance = 10
				}
			}
		}
		if = {
			limit = {
				has_global_flag = R56_PER_countenance_has_capitulated_flag
				PER = {
					is_subject_of = ENG
				}
				SOV = {
					any_owned_state = {
						is_core_of = PER
					}
				}
			}
			SOV = {
				activate_mission = occupation_of_iran_decision
			}
			ENG = {
				activate_mission = occupation_of_iran_decision
			}
		}
		if = {
			limit = {
				has_global_flag = r56_AUS_in_yalta
			}
			every_state = {
				limit = {
					is_core_of = AUS
					is_core_of = GER
					NOT = {	#just in case a puppet Germany slips through
						is_owned_by = GER
					}
				}
				remove_core_of = GER
			}
		}
		if = { #Fix Tyrol
			limit = {
				AUS = {
					is_ai = yes
				}
				39 = { #South Tyrol
					OR = {
						is_owned_by = USA
						AND = { #If zones not managed
							has_global_flag = r56_AUS_in_yalta
							is_owned_by = AUS
						}
					}
				}
			}
			ITA = { transfer_state = 39 }
		}
		if = { #Fix  Tyrol
			limit = {
				ITA = {
					is_ai = yes
				}
				153 = { #Tyrol
					OR = {
						is_owned_by = ITA
						AND = { #If zones not managed
							has_global_flag = r56_ITA_in_yalta
							is_owned_by = AUS
						}
					}
				}
			}
			AUS = { transfer_state = 153 }
		}
		if = { #Fix released Lithuania in only Vilnius
			limit = {
				has_global_flag = r56_POL_in_yalta #Poland should cede its east
				country_exists = LIT
				LIT = {
					is_ai = yes
				}
				784 = { #Vilnius
					is_owned_by = LIT
				}
				NOT = { #Does not own any other states
					any_state = {
						is_owned_by = LIT
						NOT = { 
							state = 784
						}
					}
				}
			}
			SOV = {
				annex_country = {
					target = LIT
					transfer_troops = no
				}
			}
		}
		if = { #Fix Croatian puppet state
			limit = {
				country_exists = YUG
				country_exists = CRO
				CRO = {
					is_ai = yes
				}
				NOT = {
					CRO = {
						is_subject = yes
						NOT = {
							is_subject_of = YUG
						}
					}
				}
				OR = {
					has_global_flag = r56_YUG_in_yalta
					any_state = { #Good indicator of broken puppet
						is_core_of = CRO
						is_owned_by = YUG
					}
				}
			}
			YUG = { 
				annex_country = {
					target = CRO
					transfer_troops = no
				}
			}
		}
		if = { #Fix East Poland-> remove Belarus if allies puppeted
			limit = {
				BLR = {
					is_ai = yes
					if = {
						limit = {
							is_subject = yes
						}
						OVERLORD = {
							is_ai = yes
						}
					}
				}
				has_global_flag = r56_POL_in_yalta
				country_exists = BLR
				NOT = {
					206 = { #Minsk
						is_owned_by = BLR
					}				
				}
			}
			SOV = {
				annex_country = {
					target = BLR
					transfer_troops = no
				}
			}
		}
		if = { #Fix Zara
			limit = {
				NOT = {
					163 = {
						is_owned_by = ITA
						is_owned_by = YUG
						is_owned_by = CRO #broken puppet already fixed
					}
				}
			}
			if = {
				limit = {
					country_exists = CRO
				}
				CRO = { transfer_state = 163 }
			}
			if = {
				limit = {
					NOT = {
						country_exists = CRO
					}
					country_exists = YUG
				}
				YUG = { transfer_state = 163 }
			}
		}
		if = {
			limit = {
				has_global_flag = r56_ALB_in_yalta
			}
			ALB = {
				if = {
					limit = {
						has_autonomy_state = autonomy_supervised_state
					}
					OVERLORD = { #this function requires a different tag here
						set_autonomy = { #disable silly nations making a guided gov of Albania, which is really never removed by AI
							target = ALB
							autonomy_state = autonomy_free
						}
					}
				}
				if = {
					limit = { #in case they are made full puppet
						OR = {
							is_subject = no
							AND = {
								is_subject = yes
								OVERLORD = {
									has_government = communism
								}
							}
						}
					}
					set_politics = {  #should be decently historical
						ruling_party = communism
					}
					set_popularities = {
						democratic = 9
						neutrality = 4
						fascism = 2
						communism = 85
					}
				}
			}
		}
		if = { #Fix East Poland->Cede Remaining land
			limit = {
				has_global_flag = r56_POL_in_yalta
			}
			SOV = {
				if = {
					limit = {
						96 = { #Wilejka
							is_owned_by = POL
							owner = {
								is_ai = yes
							}
						}
					}
					transfer_state = 96
				}
				if = {
					limit = {
						936 = { #Smorgonie
							is_owned_by = POL
							owner = {
								is_ai = yes
							}
						}
					}
					transfer_state = 936
				}
				if = {
					limit = {
						935 = { #Grodno
							is_owned_by = POL
							owner = {
								is_ai = yes
							}
						}
					}
					transfer_state = 935
				}
				if = {
					limit = {
						95 = { #Nowogrodek
							is_owned_by = POL
							owner = {
								is_ai = yes
							}
						}
					}
					transfer_state = 95
				}
				if = {
					limit = {
						94 = { #Polesie
							is_owned_by = POL
							owner = {
								is_ai = yes
							}
						}
					}
					transfer_state = 94
				}
				if = {
					limit = {
						93 = { #Wolyn
							is_owned_by = POL
							owner = {
								is_ai = yes
							}
						}
					}
					transfer_state = 93
				}
				if = {
					limit = {
						91 = { #Lwow
							is_owned_by = POL
							owner = {
								is_ai = yes
							}
						}
					}
					transfer_state = 91
				}
				if = {
					limit = {
						89 = { #Stanislawow
							is_owned_by = POL
							owner = {
								is_ai = yes
							}
						}
					}
					transfer_state = 89
				}
			}
			POL = {	#return Bialystok, which the Soviets take in MolRib
				if = {
					limit = {
						is_subject_of = SOV
						SOV = {
							owns_state = 97
						}
					}
					transfer_state = 97
				}
			}
			#Removing cores that are still around
			if = {
				limit = {
					GER = {
						is_ai = yes
					}
					66 = { #Niederschlesien
						is_core_of = GER
						is_owned_by = POL
					}
				}
				GER = {
					remove_state_core = 66
				}
			}
			if = {
				limit = {
					GER = {
						is_ai = yes
					}
					67 = { #Oberschlesien
						is_core_of = GER
						is_owned_by = POL
					}
				}
				GER = {
					remove_state_core = 67
				}
			}
			if = {
				limit = {
					GER = {
						is_ai = yes
					}
					63 = { #Hinterpommern
						is_core_of = GER
						is_owned_by = POL
					}
				}
				GER = {
					remove_state_core = 63
				}
			}
		}
		if = { #This needs to go lastish!
			limit = {
				has_global_flag = r56_ITA_in_yalta
			}
			ITA = {
				if = {
					limit = {
						OR = {
							has_autonomy_state = autonomy_supervised_state
							AND = {	#Italian civil war makes one side a puppet, although its not super far fetched, it makes sense to remove post-war
								is_subject = yes
								overlord = {
									has_government = democratic
								}
								OR = {
									has_government = neutrality
									has_government = democratic
								}
							}
						}
					}
					OVERLORD = { #this function requires a different tag here
						set_autonomy = { #disable silly nations making a guided gov of Italy, which is really never removed by AI
							target = ITA
							autonomy_state = autonomy_free
						}
					}
				}
				if = { #Fix Istria
					limit = { #Havent seen broken Slovenia puppets yet
						owns_state = 911
						owns_state = 736
						OR = {
							911 = {
								owner = {
									is_ai = yes
								}
							}
							736 = {
								owner = {
									is_ai = yes
								}
							}
						}
					}
					if = {
						limit = {
							country_exists = CRO
						}
						CRO = { transfer_state = 736 }
					}
					if = {
						limit = {
							country_exists = YUG
							NOT = {
								country_exists = CRO
							}
						}
						YUG = { transfer_state = 736 }
					}
					if = {
						limit = {
							country_exists = SLV
						}
						SLV = { transfer_state = 911 }
					}
					if = {
						limit = {
							country_exists = YUG
							NOT = {
								country_exists = SLV
							}
						}
						YUG = { transfer_state = 911 }
					}
				}
				if = {
					limit = {
						NOT = {
							is_puppet = yes
							is_subject = yes
							has_autonomy_state = autonomy_supervised_state
						}
						
						NOT = { #Allied leader is democratic or non-aligned
							has_global_flag = r56_yalta_origin_is_communism
							has_global_flag = r56_yalta_origin_is_fascism
						}
					}
					set_politics = { #historical
						ruling_party = neutrality
						elections_allowed = no #handled by events
					}
					set_popularities = { #based on monarchy referendum and first election
						democratic = 33
						neutrality = 38
						fascism = 4
						communism = 25
					}
					#announce referendum
					country_event = { id = r56_italy.107 days = 2 }
				}
				if = { #fixes weird Italy owning things
					limit = {
						owns_state = 736
					}
					if = {
						limit = {
							country_exists = WGR
							736 = {
								is_core_of = WGR
							}
						}
						WGR = { transfer_state = 736 }
					}
				}
			}
			every_state = { #remove Italian claims that lead to WW3
				remove_claim_by = ITA
			}
		}
		if = {	#if Denmark was democratic in WW2, dont puppet them
			limit = {
				has_global_flag = r56_DEN_protectorate_in_yalta
				DEN = {
					is_subject = yes
					overlord = {
						has_government = democratic
					}
					has_government = democratic
				}
			}
			DEN = {
				overlord = {
					set_autonomy = {
						target = DEN
						autonomy_state = autonomy_free
					}
				}
			}
		}
		#Below are very rare edge cases that are fixed when found - SpicyAlfredo
		if = { #Niche case were Poland lived and not at war with Soviets/Other tags took new west Poland land and gets rid of Danzig aswell
			limit = {
				NOT = {
					has_global_flag = r56_POL_in_yalta
				}
				POL = {
					is_puppet = no #double checking
					is_government_in_exile = no
					has_capitulated = no
					NOT = {
						has_war_with = SOV
						has_war_with = ENG
						has_war_with = USA
						has_war_with = FRA
					}
					OR = { #Need to be in a faction or it's too bad for you Poland
						is_in_faction_with = ENG
						is_in_faction_with = SOV
						is_in_faction_with = FRA
						is_in_faction_with = USA
					}
				}
			}
			if = { #Danzig is still around lol
				limit = { 
					DNZ = {
						exists = yes
						is_ai = yes
					}
					85 = { #Danzig
						is_owned_by = DNZ
					}
				}
				POL = {
					transfer_state = 85
				}
			}
			if = {#Removing claims that are around
				limit = {
					85 = {
						is_claimed_by = GER
					}
				}
				GER = {
					remove_state_claim = 85
				}
			}
			if = {
				limit = {
					SOV = {
						is_ai = yes
					}
				}
				POL = {
					if = {
						limit = {
							63 = { #Hinterpommern
								is_owned_by = SOV
								is_core_of = POL
								owner = {
									is_ai = yes
								}
							}
						}
						transfer_state = 63
					}
					if = {
						limit = { #what
							has_global_flag = r56_ITA_in_yalta
							63 = { #Hinterpommern
								is_owned_by = ITA
								is_core_of = POL
								owner = {
									is_ai = yes
								}
							}
						}
						transfer_state = 63
					}
					if = {
						limit = { 
							63 = { #Hinterpommern
								is_owned_by = FRA
								is_core_of = POL
								owner = {
									is_ai = yes
								}
							}
						}
						transfer_state = 63
					}
					if = {
						limit = { 
							63 = { #Hinterpommern
								is_owned_by = ENG
								is_core_of = POL
								owner = {
									is_ai = yes
								}
							}
						}
						transfer_state = 63
					}
					if = {
						limit = { 
							63 = { #Hinterpommern
								is_owned_by = USA
								is_core_of = POL
								owner = {
									is_ai = yes
								}
							}
						}
						transfer_state = 63
					}
					if = {
						limit = {
							68 = { #Neumark
								is_owned_by = SOV
								is_core_of = POL
								owner = {
									is_ai = yes
								}
							}
						}
						transfer_state = 68
					}
					if = {
						limit = { 
							66 = { #Niederschlesien
								is_owned_by = SOV
								is_core_of = POL
								owner = {
									is_ai = yes
								}
							}
						}
						transfer_state = 66
					}
					if = {
						limit = { 
							67 = { #Oberschlesien
								is_owned_by = SOV
								is_core_of = POL
								owner = {
									is_ai = yes
								}
							}
						}
						transfer_state = 67
					}
					if = {
						limit = { 
							67 = { #Oberschlesien
								is_owned_by = SOV
								is_core_of = POL
								owner = {
									is_ai = yes
								}
							}
						}
						transfer_state = 67
					}
				}
			}
		}
	}
}

country_event = { # United front against fascism with France
	id = r56.ger.6
	title = r56.ger.6.t
	desc = r56.ger.6.d
	picture = GFX_report_event_generic_sign_treaty2
		
	fire_only_once = yes
	
	is_triggered_only = yes
		
	option = { # Accept
		name = r56.ger.6.a
		ai_chance = {
			base = 60
			modifier = {
                add = 10
				has_opinion = {
					target = GER
					value > 30
				}	
			}
			modifier = {
                add = 30
				has_government = communism	
			}
		}
		GER = { country_event = { id = r56.ger.10 hours = 6 } }
	}
		
	option = { # Refuse
		name = r56.ger.6.b
		ai_chance = {
			base = 40
			modifier = {
                add = 10
				has_opinion = {
					target = GER
					value < 11
				}	
			}
			modifier = {
                add = 30
				has_government = fascism
			}
		}
		GER = { country_event = { id = r56.ger.11 hours = 6 } }	
	}
}
	
country_event = { # Pressure Austria
	id = r56.ger.7
	title = r56.ger.7.t
	desc = r56.ger.7.d
	picture = GFX_report_event_generic_sign_treaty1
		
	fire_only_once = yes
	
	is_triggered_only = yes
		
	option = { # Accept
		name = r56.ger.7.a
		ai_chance = {
			base = 10
			modifier = {
                add = 10
				has_opinion = {
					target = GER
					value > 50
				}	
			}
			modifier = {
                add = 10
				communism > 0.25	
			}
			modifier = {
                add = 10
				has_stability < 0.50	
			}
		}
		effect_tooltip = {
			GER = {
				annex_country = { target = AUS transfer_troops = yes }
			}
		}
		custom_effect_tooltip = GAME_OVER_TT
		GER = { country_event = { id = r56.ger.8 hours = 6 } }
	}
		
	option = { # Refuse
		name = r56.ger.7.b
		ai_chance = {
			base = 10
			modifier = {
                add = 10
				has_army_manpower = {
					size > 200000
				}
			}
			modifier = {
                add = 25
				is_in_faction = yes	
			}
		}
		add_war_support = 0.1
		GER = { country_event = { id = r56.ger.9 hours = 6 } }
	}
}
	
country_event = {
	id = r56.ger.8
	title = r56.ger.8.t
	desc = r56.ger.8.d
	picture = GFX_report_event_hitler_handshake
		
	fire_only_once = yes
	is_triggered_only = yes
		
	option = {
		name = r56.ger.8.a
		ai_chance = {
			base = 90
		}
		annex_country = { target = AUS transfer_troops = yes }
		set_country_flag = GER_com_anschluss_accepted
	}
}
	
country_event = {
	id = r56.ger.9
	title = r56.ger.9.t
	desc = r56.ger.9.d
	picture = GFX_report_event_albanian_partisans
		
	fire_only_once = yes
	
	is_triggered_only = yes
		
	#Then it's war
	option = {
		name = r56.ger.9.a
		ai_chance = {
				base = 90
		}
		declare_war_on = {
			target = FROM
			type = annex_everything
		}
	}
}

country_event = { 
	id = r56.ger.10
	title = r56.ger.10.t
	desc = r56.ger.10.d
	picture = GFX_report_event_generic_sign_treaty2
		
	fire_only_once = yes
	
	is_triggered_only = yes
		
	option = {
		name = r56.ger.10.a
		ai_chance = {
			base = 60
		}
		give_guarantee = FRA
		FRA = {
			give_guarantee = GER
		}
		diplomatic_relation = {
			country = FRA
			relation = non_aggression_pact
			active = yes
		}
	}

}

country_event = { 
	id = r56.ger.11
	title = r56.ger.11.t
	desc = r56.ger.11.d
	picture = GFX_report_event_generic_sign_treaty2
		
	fire_only_once = yes
	
	is_triggered_only = yes
		
	option = {
		name = r56.ger.11.a
	}
}

country_event = { #Give Hungary Southern Slovakia?
	id = r56.ger.15
	title = r56.ger.15.t
	desc = r56.ger.15.d
	picture = GFX_report_event_german_politician_speech

	is_triggered_only = yes

	option = { #Yes
		name = r56.ger.15.a
		trigger = {
			OR = {
				country_exists = HUN
				AND = {
					country_exists = AUS
					has_cosmetic_tag = HUN_EMPIRE
				}
			}
		}		
		ai_chance = {
			factor = 80
		}
		if = {
			limit = {
				country_exists = HUN
			}
			HUN = {
				country_event = {
					id = germany.51
				}
			}			
		}
		if = {
			limit = {
				AUS = {
					has_cosmetic_tag = HUN_EMPIRE
				}
				NOT = {
					country_exists = HUN
				}
			}
			AUS = {
				country_event = {
					id = germany.51
				}
			}			
		}
		add_opinion_modifier = {
			target = GER modifier = GER_first_vienna_award_GER
		}
		hidden_effect = {
			set_global_flag = GER_first_vienna_award
		}
	}

	option = { #No (Annexed)
		name = r56.ger.15.b

		trigger = {
			GER = { 
				owns_state = 664
				owns_state = 996
			}
		}

		ai_chance = {
			factor = 20
			modifier = {
				factor = 0
				is_historical_focus_on = yes
				HUN = {
					exists = yes
				}				
			}
		}
	}

	option = { #No (Slovakia)
		name = r56.ger.15.c

		trigger = {
			SLO = {
			 	owns_state = 664
				is_puppet_of = GER
			}
		}

		ai_chance = {
			factor = 20
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
	}
}

country_event = { #One last ai handout
	id = r56.ger.16
	title = r56.ger.16.t
	desc = r56.ger.16.desc
	picture = GFX_report_event_german_reichstag_bombed

	fire_only_once = yes

	hidden = yes

	trigger = {
		original_tag = GER
		is_ai = yes
		has_civil_war = no
		date > 1941.9.9 #You don't get a bailout for being dumb early 
		ROOT = {
			#has_completed_focus = GER_total_war
			has_war = yes
			surrender_progress > 0.88
			has_country_flag = r56_GER_endsieg_event_happened
			casualties > 799999 
			NOT = {
				has_government = democratic
			}
			OR = {
				any_enemy_country = {
					is_major = yes 
					OR = {
						original_tag = ENG
						original_tag = USA
						original_tag = SOV
						original_tag = FRA
						original_tag = POL
						original_tag = ITA
					}
				}
				has_global_flag = had_yalta_conference
				AND = { #just incase the above stuff doesn't cause a fire and Germany is losing hard
					surrender_progress > 0.90
					casualties > 1200000 
				}
			}
		}
	}

	mean_time_to_happen = { days = 3 }

	option = { 
		name = r56.ger.16.a 
		if = {
			limit = {
				64 = {
					NOT = {
						is_controlled_by = GER
					}
				}
				has_global_flag = had_yalta_conference
				has_country_leader = {
					character = GER_adolf_hitler
					ruling_only = yes
				}
			}
			kill_ideology_leader = fascism
			set_global_flag = r56_we_killed_no_no_man
			create_country_leader = { 
				name = "Karl Donitz"
				desc = ""
				picture = "Portrait_Germany_Karl_Donitz.dds"
				expire = "1965.1.1"
				ideology = nazism
				traits = {
					retired_admiral defacto_leader 
				}
			}
		}
		ROOT = {
			add_manpower = 10000
			add_fuel = 250
			add_offsite_building = { type = arms_factory level = 1 }
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = 4000
				producer = GER
			}
			add_equipment_to_stockpile = { 
				type = support_equipment
				amount = 250
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = medium_tank_chassis
				amount = 200
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = artillery_equipment
				amount = 200
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = motorized_equipment
				amount = 100
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = train_equipment
				amount = 10
			}
		}
	}
}
country_event = { #Germany offers to "protect Poland"
	id = r56.ger.17
	title = r56.ger.17.t
	desc = r56.ger.17.d
	picture = GFX_report_event_german_reichstag_bombed

	fire_only_once = yes

	is_triggered_only = yes

	option = { #Agree
		name = r56.ger.17.a
		ai_chance = {
			base = 100
			modifier = {
				factor = 0
				strength_ratio = { #help might still be helpful but not giving you any territory
					tag = GER
					ratio > 1
				}
			}
			modifier = {
				factor = 0.5
				is_in_faction = yes
			}
			modifier = { #guarantees might not work anyway
				factor = 0
				is_faction_leader = yes
				any_other_country = {
					is_in_faction_with = POL
				}
			}
			modifier = {
				factor = 0
				threat < 0.15
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = SOV
					ratio > 0.5
				}
				SOV = { #lower strength expected
					has_civil_war = no
				}
			}
		}
		FROM = {
			country_event = {
				id = r56.ger.19
				hours = 2
				random = 20
			}
		}
		if = {
			limit = {
				owns_state = 807
			} 	
			FROM = {
				transfer_state = 807
			}
		}
		if = {
			limit = {
				owns_state = 86
			} 	
			FROM = {
				transfer_state = 86
			}
		}
		if = {
			limit = {
				owns_state = 762
			} 	
			FROM = {
				transfer_state = 762
			}
		}
		if = {
			limit = {
				OR = {	#Danzig
					owns_state = 85
					85 = {
						owner = {
							is_subject_of = ROOT
						}
					}
				}
			} 	
			FROM = {
				transfer_state = 85
			}
		}
		FROM = {
			diplomatic_relation = {
				country = ROOT
				relation = guarantee
				active = yes
		   	}
		}
		diplomatic_relation = {
			country = FROM
			relation = guarantee
			active = yes
		}
		leave_faction = yes #is not at war, ensures guarantees work
	}
	option = { #Decline
		name = r56.ger.17.b
		ai_chance = {
			base = 50
		}
		FROM = {
			country_event = {
				id = r56.ger.18
				hours = 2
				random = 20
			}
		}
	}
}

country_event = { #Poland declines
	id = r56.ger.18
	title = r56.ger.18.t
	desc = r56.ger.18.d
	picture = GFX_report_event_polish_army

	fire_only_once = yes

	is_triggered_only = yes

	option = { #Rip
		name = r56.ger.18.a
		create_wargoal = {
			type = puppet_wargoal_focus #buffer state
			target = FROM
		}
	}
}

country_event = { #Poland agrees
	id = r56.ger.19
	title = r56.ger.19.t
	desc = r56.ger.19.d
	picture = GFX_report_event_generic_sign_treaty2

	fire_only_once = yes

	is_triggered_only = yes

	option = { #Yay
		name = r56.ger.19.a 
	}
}

country_event = { #Democratic anschluss
	id = r56.ger.20
	title = r56.ger.20.t
	desc = r56.ger.20.d
	picture = GFX_report_event_generic_sign_treaty2

	fire_only_once = yes

	is_triggered_only = yes

	option = { #Yes
		name = r56.ger.20.a
		trigger = {
			communism < 0.3
		}
		ai_chance = {
			base = 10
		}
		FROM = {
			annex_country = {
				target = ROOT
				transfer_troops = yes
			}
			add_state_core = 4
			add_state_core = 152
			add_state_core = 153
			add_state_core = 848
			add_state_core = 1054
			#AI would probably do stupid things with a claim on South Tyrol, perhaps something for a future focus
			set_country_flag = GER_dem_anschluss_accepted
		}
		country_event = r56.ger.26 #world event
	}
	option = { #Yes, except the referendum doesnt pass because of commies
		name = r56.ger.20.a
		trigger = {
			communism > 0.3
		}
		ai_chance = {
			base = 10
		}
		FROM = {
			country_event = r56.ger.21
		}
		country_event = r56.ger.21 #show them the referendum failed
	}
	option = { #No
		name = r56.ger.20.b
		ai_chance = {
			base = 3
			modifier = {
				factor = 0
				communism > 0.3 #take the other option, but keep it available for players
			}
			modifier = {
				factor = 8
				strength_ratio = {
					tag = GER
					ratio > 0.6 #very strong for its size
				}
			}
			modifier = {
				factor = 100
				strength_ratio = {
					tag = GER
					ratio > 0.9 #we are the Germanic captain now
				}
			}
		}
		if = {
			limit = {
				ic_ratio = {
					tag = GER
					ratio < 0.4 #otherwise: maybe independence isnt so bad
				}
			}
			add_stability = -0.15
		}
		set_global_flag = dem_anschluss_refused #this has to be before the event for dynamic loc
		FROM = {
			country_event = r56.ger.21
		}
	}
}
country_event = { #Democratic anschluss failure, success becomes world event
	id = r56.ger.21
	title = r56.ger.21.t
	desc = {
		text = r56.ger.21.d1
		trigger = {
			has_global_flag = dem_anschluss_refused
		}
	}
	desc = {
		text = r56.ger.21.d2
		trigger = {
			NOT = {
				has_global_flag = dem_anschluss_refused
			}
		}
	}
	picture = GFX_report_event_generic_sign_treaty2

	fire_only_once = yes

	is_triggered_only = yes

	option = { #Rip
		trigger = {
			has_global_flag = dem_anschluss_refused
		}
		name = r56.ger.21.a
	}
	option = { #Rip, but commies
		trigger = {
			NOT = {
				has_global_flag = dem_anschluss_refused
			}
		}
		name = r56.ger.21.b
	}
}

country_event = { #Trade Oberschlesien for Gdynia
	id = r56.ger.22
	title = r56.ger.22.t
	desc = r56.ger.22.d
	picture = GFX_report_event_poland_rejects

	fire_only_once = yes

	is_triggered_only = yes

	option = { #Yes
		name = r56.ger.22.a
		ai_chance = { 
			factor = 75
			modifier = { #were kinda busy
				factor = 0
				has_war = yes
			}
			modifier = { #we want friendly relations
				factor = 1.5
				any_neighbor_country = {
					has_added_tension_amount > 7
					NOT = {
						tag = FROM #perhaps from civil war
					}
				}
			}
			modifier = { #we're powerful, we need that, we can trade for the steel they offer
				factor = 0.5
				is_major = yes
			}
			modifier = { #just another port
				factor = 5
				any_controlled_state = {
					is_coastal = yes
					is_core_of = ROOT
				}
			}
		}
		GER = {
			transfer_state = 807
			add_state_core = 807
			country_event = r56.ger.23
		}
		transfer_state = 67
		add_state_core = 67
	}
	option = { #No
		name = r56.ger.22.b
		ai_chance = { 
			factor = 25
		}
		set_global_flag = GER_dem_poland_trade_failed
		GER = {
			country_event = r56.ger.23
		}
	}
}
country_event = { #German reaction
	id = r56.ger.23
	title = {
		text = r56.ger.23.t1
		trigger = {
			NOT = {
				has_global_flag = GER_dem_poland_trade_failed
			}
		}
	}
	title = {
		text = r56.ger.23.t2
		trigger = {
			has_global_flag = GER_dem_poland_trade_failed
		}
	}
	desc = {
		text = r56.ger.23.d1
		trigger = {
			NOT = {
				has_global_flag = GER_dem_poland_trade_failed
			}
		}
	}
	desc = {
		text = r56.ger.23.d2
		trigger = {
			has_global_flag = GER_dem_poland_trade_failed
		}
	}
	picture = GFX_report_event_german_polish_border

	fire_only_once = yes

	is_triggered_only = yes

	option = { #Eyyyy
		name = r56.ger.23.a
		trigger = {
			NOT = {
				has_global_flag = GER_dem_poland_trade_failed
			}
		}
	}
	option = { #Ooof
		name = r56.ger.23.b
		trigger = {
			has_global_flag = GER_dem_poland_trade_failed
		}
	}
}
country_event = { #Trade Lithuania for Gdynia (allows forming Poland-Lithuania)
	id = r56.ger.24
	title = r56.ger.24.t
	desc = r56.ger.24.d
	picture = GFX_report_event_german_polish_border

	fire_only_once = yes

	is_triggered_only = yes

	option = { #Yes
		name = r56.ger.24.a
		ai_chance = { 
			factor = 75
			modifier = { #we're kinda busy
				factor = 0
				has_war = yes
			}
			modifier = { #whoa land to expand on and cores
				factor = 2
				is_major = yes
			}
		}
		GER = {
			transfer_state = 807
			add_state_core = 807
			transfer_state = 762
			add_state_core = 762
			country_event = r56.ger.23
		}
		transfer_state = 814
		transfer_state = 815
		transfer_state = 11
		transfer_state = 189
		activate_decision = form_commonwealth #lost states arent required, but this is a free buff is they lost eastern lands to the soviet or something
	}
	option = { #No
		name = r56.ger.22.b
		ai_chance = { 
			factor = 25
		}
		set_global_flag = GER_dem_poland_trade_failed
		GER = {
			country_event = r56.ger.23
		}
	}
}
country_event = { #Germany civil war
	id = r56.ger.25
	title = erwache.5.t #reused from monarchists
	desc = r56.ger.25.d
	picture = GFX_report_event_german_reichstag_bombed

	fire_only_once = yes

	is_triggered_only = yes

	timeout_days = 7

	immediate = { # just in case we want to manually trigger this event without the focus
		hidden_effect = { 
			if = {
				limit = {
					NOT = {
						has_variable = cw_dem_preview
					}
					NOT = {
						has_variable = cw_com_preview
					}
				}
				GER_civil_war_setup_and_preview = yes
			}
		}
	}

	option = { #Democrats
		name = r56.ger.25.a
		custom_effect_tooltip = GER_civil_war_tt
		custom_effect_tooltip = r56_newline
		effect_tooltip = {
			var:cw_dem_preview = {
				change_tag_from = GER
			}
		}

		if = {
			limit = {
				check_variable = { num_equipment_in_armies_k@infantry_equipment < 20 }
			}
			set_global_flag = GER_invalidate_civil_war_achievement
		}

		hidden_effect = {
			var:cw_dem_preview = {
				GER_erwin_von_witzleben = {
					set_nationality = GER
				}
			}

			# only preview here, since the since we need to reapply this later on due to single tile territory assignment, which gets overwritten by the fascists
			GER_civil_war_make_this_democratic_preview = yes

			GER_civil_war_teleport_armies = yes

			var:cw_dem_preview = {
				GER_civil_war_make_this_fascist = yes
			}
			
			var:cw_com_preview = {
				GER_civil_war_make_this_communist = yes
			}

			GER_civil_war_make_this_democratic = yes
		
			clear_variable = cw_com_preview
			clear_variable = cw_dem_preview

			GER_civil_war_declare_wars = yes
		}
	}
	option = { #Commies
		name = r56.ger.25.b
		custom_effect_tooltip = GER_civil_war_tt
		custom_effect_tooltip = r56_newline
		effect_tooltip = {
			var:cw_com_preview = {
				change_tag_from = GER
			}
		}

		if = {
			limit = {
				check_variable = { num_equipment_in_armies_k@infantry_equipment < 20 }
			}
			set_global_flag = GER_invalidate_civil_war_achievement
		}

		custom_effect_tooltip = GER_communists_are_pretty_hard_tt
		#custom_effect_tooltip = GER_communists_are_pretty_hard_tt_tip

		hidden_effect = {
			var:cw_com_preview = {
				GER_ernst_thalmann = {
					set_nationality = GER
				}
			}

			# only preview here, since the since we need to reapply this later on due to single tile territory assignment, which gets overwritten by the fascists
			GER_civil_war_make_this_communist_preview = yes

			GER_civil_war_teleport_armies = yes

			var:cw_com_preview = {
				GER_civil_war_make_this_fascist = yes
			}

			var:cw_dem_preview = {
				GER_civil_war_make_this_democratic = yes
			}

			GER_civil_war_make_this_communist = yes

			clear_variable = cw_com_preview
			clear_variable = cw_dem_preview


			GER_civil_war_declare_wars = yes
		}
	}
}

country_event = { #based on original anschluss, as some strings still apply
	id = r56.ger.26
	title = news.36.t
	desc = r56.ger.26.d
	picture = GFX_report_event_german_troops
	
	major = yes
	
	is_triggered_only = yes
	
	option = {
		name = news.36.a
		trigger = {
			NOT = {
				TAG = GER
				TAG = ITA
				TAG = FRA
				TAG = ENG
			}
		}
	}
	option = {
		name = r56.ger.26.b
		trigger = { TAG = GER }
	}
	option = {
		name = news.36.c
		trigger = { TAG = ITA }
	}
	option = {
		name = news.36.e
		trigger = {
			OR = {
				TAG = FRA
				TAG = ENG
			}
		}
	}
}
country_event = { #German-Soviet trade treaty, but initiated by Germany
	id = r56.ger.27
	title = r56.ger.27.t
	desc = r56.ger.27.d
	picture = GFX_erwache_reichsbank
	
	is_triggered_only = yes
	
	option = {
		name = r56.ger.27.a #yes
		diplomatic_relation = {
			country = GER
			relation = non_aggression_pact
			active = yes
		}
		give_resource_rights = { receiver = ROOT state = 232 }
		if = {
			limit = {
				has_dlc = "Man the Guns"
			}
			if = {
				limit = {
					NOT = { has_tech = basic_ship_hull_cruiser }
				}
				set_technology = { basic_ship_hull_cruiser = 1 }
			}
			if = {
				limit = {
					NOT = { has_tech = basic_cruiser_armor_scheme }
				}
				set_technology = { basic_cruiser_armor_scheme = 1 }
			}
			
			# CA: Lützow -> Petropavlovsk
			add_equipment_production = {
				equipment = {
					type = ship_hull_cruiser_2
					creator = "SOV"
					version_name = "Hipper Class"
				}
				name = "Petropavlovsk"
				requested_factories = 1
				progress = 0.5
				amount = 1
			}

			if = { #Default name
				limit = {
					has_government = communism
				}
				add_tech_bonus = {
					name = NSB_soviet_soviet_german_trade_agreement_tech_bonus_name
					bonus = 0.5
					uses = 2
					category = ship_modules_tech
					category = bb_tech
					category = dd_tech
				}
			}
			else = { #Alt name
				add_tech_bonus = {
					name = NSB_soviet_soviet_german_trade_agreement_tech_bonus_name_alt
					bonus = 0.5
					uses = 2
					category = ship_modules_tech
					category = bb_tech
					category = dd_tech
				}
			}
		}
		else = { #No MTG
			if = {
				limit = {
					NOT = { has_tech = basic_heavy_cruiser }
				}
				set_technology = { basic_heavy_cruiser = 1 }
			}
			create_equipment_variant = {
				name = "Hipper Class"
				type = heavy_cruiser_2
				parent_version = 0
				upgrades = {
					ship_reliability_upgrade = 1
					ship_engine_upgrade = 1
					ship_armor_upgrade = 2
					ship_gun_upgrade = 2
				}
			}

			add_equipment_production = {
				equipment = {
					type = heavy_cruiser_2
					creator = "SOV"
				}
				requested_factories = 1
				progress = 0.5
				amount = 1
			}

			if = { #Default name
				limit = {
					has_government = communism
				}
				add_tech_bonus = {
					name = NSB_soviet_soviet_german_trade_agreement_tech_bonus_name
					bonus = 0.5
					uses = 2
					category = ca_tech
					category = bb_tech
					category = dd_tech
				}
			}
			else = { #Alt name
				add_tech_bonus = {
					name = NSB_soviet_soviet_german_trade_agreement_tech_bonus_name_alt
					bonus = 0.5
					uses = 2
					category = ca_tech
					category = bb_tech
					category = dd_tech
				}
			}
		}

		if = { #Default name
			limit = {
				has_government = communism
			}
			add_tech_bonus = {
				name = NSB_soviet_soviet_german_trade_agreement_tech_bonus_name
				bonus = 0.5
				uses = 2
				category = air_equipment
			}
		}
		else = { #Alt name
			add_tech_bonus = {
				name = NSB_soviet_soviet_german_trade_agreement_tech_bonus_name_alt
				bonus = 0.5
				uses = 2
				category = air_equipment
			}
		}

		#Effects to Germans
		add_timed_idea = { idea = SOV_soviet_german_trade_agreement days = 545 } #Technically 1 year but really 18 months for Soviet payment 

		add_opinion_modifier = {
			target = GER
			modifier = SOV_strengthened_relations_with_us
		}
		GER = {
			add_opinion_modifier = {
				target = ROOT
				modifier = SOV_strengthened_relations_with_us
			}
		}
	}
	option = {
		name = r56.ger.27.b
	}
}
country_event = { #Germany proposes invading communist Yugoslavia with Italy
	id = r56.ger.28
	title = r56.ger.28.t
	desc = r56.ger.28.d
	picture = GFX_news_event_GER_fate_of_yugoslavia

	fire_only_once = yes

	is_triggered_only = yes

	option = { #Yes
		name = r56.ger.28.a
		ai_chance = { 
			factor = 80
			modifier = { #we're kinda busy
				factor = 0
				any_home_area_neighbor_country = {
					has_war_with = ITA
					is_major = yes
				}
			}
		}
		add_state_claim = 102
		add_state_claim = 958
		add_state_claim = 103
		add_state_claim = 105
		declare_war_on = {
			target = YUG
			type = take_state_focus
		}
		FROM = {
			declare_war_on = {
				target = YUG
				type = puppet_wargoal_focus
			}
		}
	}
	option = { #No
		name = r56.ger.28.b
		ai_chance = { 
			factor = 20
		}
	}
}

country_event = { #Germany proposes to aid Britain in exchange for some colonies
	id = r56.ger.29
	title = r56.ger.29.t
	desc = r56.ger.29.d
	picture = GFX_report_event_generic_sign_treaty2

	fire_only_once = yes

	is_triggered_only = yes

	option = { #Yes
		name = r56.ger.29.a
		ai_chance = { 
			factor = 10
			modifier = {
				add = 8
				any_country = { #at some risk
					is_subject_of = ROOT
					OR = {
						has_capitulated = yes
						surrender_progress > 0.25
					}
				}
			}
			modifier = {
				add = 2
				any_country = { #could be smaller, stacks for puppets
					is_in_faction_with = ROOT
					OR = {
						has_capitulated = yes
						surrender_progress > 0.25
					}
				}
			}
		}
		546 = {
			set_state_owner_to = GER
		}
		1055 = {
			set_state_owner_to = GER
		}
		541 = {
			set_state_owner_to = GER
		}
		737 = {
			set_state_owner_to = GER
		}
		GER = {
			add_war_support = 0.1
			add_stability = 0.05
		}
		every_country = {
			limit = {
				has_war_with = ROOT
			}
			GER = {
				add_to_war = {
					targeted_alliance = ROOT
					enemy = PREV
				}
			}
		}
	}
	option = { #No
		name = r56.ger.29.b
		ai_chance = { 
			factor = 0
			modifier = { #we can handle this
				add = 10
				NOT = {
					any_country = {
						has_war_with = ROOT
						is_major = no
					}
				}
			}
		}
	}
}

country_event = { #Contact Ludendorff
	id = r56.ger.30
	title = r56.ger.30.t
	desc = r56.ger.30.d
	picture = GFX_report_event_GER_ludendorff_gathering

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = r56.ger.30.a
		add_stability = 0.05
		custom_effect_tooltip = GER_ludendorff_will_join
	}
}

country_event = { #Ludendorff's health worsens
	id = r56.ger.31
	title = r56.ger.31.t
	desc = r56.ger.31.d
	picture = GFX_report_event_GER_ludendorff_gathering

	trigger = {
		date > 1937.3.1
		has_completed_focus = GER_contact_ludendorff
	}

	mean_time_to_happen = {
		days = 90
	}

	fire_only_once = yes

	option = { # Give him all the healthcare he needs - he lives longer
		name = r56.ger.31.a
		if = {
			limit = {
				has_power_balance = {
					id = GER_monarchist_power_balance
				}
			}
			GER_monarchist_bop_low_decrease_effect = yes
		}
		GER_erich_ludendorff = {
			remove_unit_leader = yes
		}
		custom_effect_tooltip = available_political_advisor
		show_ideas_tooltip = GER_erich_ludendorff
		set_country_flag = GER_ludendorff_political_advisor
	}
	option = { # Give him all the healthcare he needs - he lives longer
		name = r56.ger.31.b
		if = {
			limit = {
				has_power_balance = {
					id = GER_monarchist_power_balance
				}
			}
			GER_monarchist_bop_very_low_increase_effect = yes
		}
		GER_erich_ludendorff = {
			add_unit_leader_trait = sick
		}
		add_ideas = GER_medical_costs
	}
}

country_event = { #Ludendorff dies (field marshal) 
	id = r56.ger.32
	title = r56.ger.32.t
	desc = r56.ger.32.d
	picture = GFX_report_event_europe_funeral

	trigger = {
		date > 1938.7.1 # Let's just say he gets some good healthcare and lives another 8 months or so
		has_completed_focus = GER_contact_ludendorff
		has_idea = GER_medical_costs
	}

	mean_time_to_happen = {
		days = 90
	}

	fire_only_once = yes

	option = { # Oh dear
		name = r56.ger.32.a
		retire_character = GER_erich_ludendorff
		remove_ideas = GER_medical_costs
	}
}

country_event = { #Ludendorff dies (retired) 
	id = r56.ger.33
	title = r56.ger.33.t
	desc = r56.ger.33.d
	picture = GFX_report_event_europe_funeral

	trigger = {
		date > 1937.10.1 # Died 1937.12.20
		has_completed_focus = GER_contact_ludendorff
		NOT = {
			has_idea = GER_medical_costs
		}
	}

	mean_time_to_happen = {
		days = 70
	}

	fire_only_once = yes

	option = { # Oh dear
		name = r56.ger.33.a
		retire_character = GER_erich_ludendorff
	}
}

country_event = { #Germany proposes economic integration
	id = r56.ger.34
	title = r56.ger.34.t
	desc = r56.ger.34.desc
	picture = GFX_report_event_generic_construction_site

	is_triggered_only = yes

	option = {	#yippie!
		name = r56.ger.34.a
		ai_chance = {
			factor = 10
			modifier = {
				add = 5
				FROM = {
					strength_ratio = {
						tag = ROOT
						ratio > 1.7
					}
				}
			}
			modifier = {
				add = 5
				ROOT = {
					NOT = {
						is_in_faction_with = FROM
					}
					has_opinion = {
						target = FROM
						value > 40
					}
				}
			}
			modifier = {
				add = 5
				ROOT = {
					is_in_faction_with = FROM
					has_opinion = {
						target = FROM
						value > 80
					}
				}
			}
			modifier = {
				add = 5
				any_country = {
					is_neighbor_of = ROOT
					NOT = { tag = FROM }
					has_added_tension_amount > 10
				}
			}
		}
		FROM = {
			country_event = r56.ger.35
		}
		effect_tooltip = {
			FROM = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_dominion
					end_wars = no
					end_civil_wars = no
				}
			}
		}
	}
	option = {	#no!
		name = r56.ger.34.b
		ai_chance = {
			factor = 10
			modifier = {
				add = 5
				FROM = {
					has_added_tension_amount > 45
				}
			}
			modifier = {
				add = 5
				FROM = {
					has_war = yes
				}
			}
			modifier = {
				add = 5
				FROM = {
					strength_ratio = {
						tag = ROOT
						ratio < 1.2
					}
				}
			}
			modifier = {
				add = 5
				has_opinion = {
					target = FROM
					value < 10
				}
			}
		}
		trigger = {	#LIT cant be couped so has to cut ties
			NOT = {
				original_tag = LIT
			}
		}
		FROM = {
			country_event = r56.ger.36
		}
	}
	option = {	#we must purge their influence
		name = r56.ger.34.c
		trigger = {
			NOT = {
				is_in_faction_with = FROM
				has_war_together_with = FROM
			}
		}
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				is_in_faction_with = FROM
			}
			modifier = {
				add = 5
				has_added_tension_amount > 90
			}
			modifier = {
				add = 5 
				FROM = {
					strength_ratio = {
						tag = ROOT
						ratio < 0.7
					}
				}
			}
			modifier = {
				add = 5 
				has_opinion = {
					target = FROM
					value < -50
				}
			}
		}
		FROM = {
			country_event = r56.ger.36
		}
		custom_effect_tooltip = GER_cannot_influence_us_anymore_tt
		set_country_flag = GER_country_cut_all_ties	#has no tooltip
		#downgrade any German-inherited MIO's
		add_timed_idea = { idea = GER_cut_german_trade_ties days = 450 }
	}
}

country_event = { #Integration accepted
	id = r56.ger.35
	title = r56.ger.35.t
	desc = r56.ger.35.desc
	picture = GFX_report_event_generic_sign_treaty3

	is_triggered_only = yes

	option = {
		name = r56.ger.35.a
		if = {
			limit = {
				has_government = fascism
			}
			set_autonomy = {
				target = FROM
				autonomy_state = autonomy_satellite
				end_wars = no
				end_civil_wars = no
			}
		}
		else = {
			set_autonomy = {
				target = FROM
				autonomy_state = autonomy_dominion
				end_wars = no
				end_civil_wars = no
			}
		}
	}
}

country_event = { #Integration refused
	id = r56.ger.36
	title = r56.ger.36.t
	desc = r56.ger.36.desc
	picture = GFX_report_event_generic_read_write

	is_triggered_only = yes

	option = {
		name = r56.ger.36.a
		#nothing
	}
	option = {	#embargo
		name = r56.ger.36.b
		send_embargo = FROM
		if = {
			limit = {
				is_in_faction_with = FROM
				is_faction_leader = yes
			}
			remove_from_faction = FROM
		}
	}
	option = {	#war/overthrow
		name = r56.ger.36.c
		send_embargo = FROM
		# if = {	#undemocratic behaviour - ofc actually acting upon this will give more tension
		# 	limit = {
		# 		has_government = democratic
		# 	}
		# 	add_threat = 0.3	#amount too small to show up, instead link to action on threats
		# }
		# if = {
		# 	limit = {
		# 		is_in_faction_with = FROM
		# 		is_faction_leader = yes
		# 	}
		# 	remove_from_faction = FROM
		# }
		custom_effect_tooltip = GER_hostile_trade_decisions_tt
		hidden_effect = {	#flag setting doesnt have loc anyway
			FROM = {
				set_country_flag = GER_target_for_hostile_trade_influence
			}
		}
	}
}

country_event = { #The military seizes power from Kaiser
	id = r56.ger.37
	title = r56.ger.37.t
	desc = r56.ger.37.d
	picture = GFX_report_event_bul_military_parade_vidin

	is_triggered_only = yes

	option = { # A bloody outrage, that!
		name = r56.ger.37.a
		add_stability = -0.05
		set_party_name = { ideology = neutrality long_name = "Oberste Heeresleitung" name = "Oberste Heeresleitung" }
		if = {
			limit = {
				has_country_leader = {
					character = GER_wilhelm_ii
					ruling_only = yes
				}
			}
			add_ideas = GER_wilhelm_ii_idea
		}
		else_if = {
			limit = {
				has_country_leader = {
					character = GER_wilhelm_iii
					ruling_only = yes
				}
			}
			add_ideas = GER_wilhelm_iii_idea
		}
		else_if = {
			limit = {
				has_country_leader = {
					character = GER_wilhelm_iv
					ruling_only = yes
				}
			}
			add_ideas = GER_wilhelm_iv_idea
		}
		GER_kurt_von_hammerstein_equord = {
			add_country_leader_role = {
				promote_leader = yes
				country_leader = {
					ideology = military_junta
					expire = "1965.1.1"
					traits = { SWE_conservatist }
				}
			}
		}
	}
}

country_event = { #Kaiser takes power back
	id = r56.ger.38
	title = r56.ger.38.t
	desc = r56.ger.38.d
	picture = GFX_report_event_royal_parade

	is_triggered_only = yes

	option = { # Can't keep me away bud
		name = r56.ger.38.a
		add_stability = 0.05
		set_party_name = { ideology = neutrality long_name = "Haus Hohenzollern" name = "Haus Hohenzollern" }
		remove_country_leader_role = {
			character = GER_kurt_von_hammerstein_equord
			ideology = oligarchism
		}
		if = {
			limit = {
				has_idea = GER_wilhelm_ii_idea
			}
			remove_ideas = GER_wilhelm_ii_idea
			GER_wilhelm_ii = {
				add_country_leader_role = {
					country_leader = {
						expire = "1965.1.1"
						ideology = absolute_monarchism
						traits = {
							anti_democrat
							#imperial_connections
						}
					}
					promote_leader = yes
				}
			}
		}
		else_if = {
			limit = {
				has_idea = GER_wilhelm_iii_idea
			}
			remove_ideas = GER_wilhelm_iii_idea
			set_power_balance_gfx = { # If not done already
				id = GER_monarchist_power_balance
				side = GER_wilhelm_ii_side
				gfx = GFX_bop_GER_wilhelm_iii
			}
			GER_wilhelm_iii = {
				set_character_name = { # If not done already
					name = "Wilhelm III" 
				}
				add_country_leader_role = {
					country_leader = {
						expire = "1965.1.1"
						ideology = absolute_monarchism
						traits = {
							popular_figurehead2
						}
					}
					promote_leader = yes
				}
			}
		}
		else_if = {
			limit = {
				has_idea = GER_wilhelm_iv_idea
			}
			remove_ideas = GER_wilhelm_iv_idea
			set_power_balance_gfx = { # If not done already
				id = GER_monarchist_power_balance
				side = GER_wilhelm_ii_side
				gfx = GFX_bop_GER_wilhelm_iv
			}
			GER_wilhelm_iv = {
				add_country_leader_role = {
					country_leader = {
						expire = "1965.1.1"
						ideology = absolute_monarchism
						traits = {
							fierce_patriot
							nationalistic_tendencies
						}
					}
					promote_leader = yes
				}
			}
		}
	}
}

country_event = { #Germany succeeds coup attempt on us
	id = r56.ger.39
	title = r56.ger.39.t
	desc = r56.ger.39.desc
	picture = GFX_report_event_generic_italian_fascists

	option = {
		name = r56.ger.39.a
		ai_chance = {
			factor = 9
		}
		if = {
			limit = {
				OR = {	#neutrality coup, take priority
					has_government = fascism
					AND = {
						NOT = {
							has_government = neutrality
						}
						neutrality > 0.3
					}
				}
			}
			GER = {
				puppet = PREV
				if = {
					limit = {
						has_government = fascism
					}
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_satellite
						end_wars = no
						end_civil_wars = no
					}
				}
				else = {
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_dominion
						end_wars = no
						end_civil_wars = no
					}
				}
			}
			set_politics = {	#after puppeting or ideology taken from Germany
				ruling_party = neutrality
				elections_allowed = no
			}
		}
		else = {	#fascist coup
			GER = {
				puppet = PREV
				if = {
					limit = {
						has_government = fascism
					}
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_satellite
						end_wars = no
						end_civil_wars = no
					}
				}
				else = {
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_dominion
						end_wars = no
						end_civil_wars = no
					}
				}
			}
			set_politics = {	#after puppeting or ideology taken from Germany
				ruling_party = fascism
				elections_allowed = no
			}
		}
	}

	option = {	#civil war
		name = r56.ger.39.b
		ai_chance = {
			factor = 1
		}
		if = {
			limit = {
				OR = {	#neutrality coup, take priority
					has_government = fascism
					AND = {
						NOT = {
							has_government = neutrality
						}
						neutrality > 0.3
					}
				}
			}
			start_civil_war = {
				ideology = neutrality
				size = 0.4
				GER = {
					puppet = PREV
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_dominion
						end_wars = no
						end_civil_wars = no
					}
				}
				set_politics = {
					ruling_party = neutrality
					elections_allowed = no
				}
			}
		}
		else = {	#fascist coup
			start_civil_war = {
				ideology = fascism
				size = 0.4
				GER = {
					puppet = PREV
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_dominion
						end_wars = no
						end_civil_wars = no
					}
				}
				set_politics = {
					ruling_party = fascism
					elections_allowed = no
				}
			}
		}
	}

	is_triggered_only = yes
}

country_event = { #Germany botches coup attempt on us
	id = r56.ger.40
	title = r56.ger.40.t
	desc = r56.ger.40.desc
	picture = GFX_report_event_generic_soldiers_surrendering

	is_triggered_only = yes

	option = {
		name = r56.ger.40.a
		if = {
			limit = {
				is_ai = yes
			}
			if = {
				limit = {
					is_in_faction_with = GER
					NOT = {
						has_war_together_with = GER
					}
				}
				leave_faction = yes
			}
		}
		add_opinion_modifier = {
			target = GER
			modifier = hostile_status
		}
	}
}

country_event = { #We succeeded in a coup
	id = r56.ger.41
	title = r56.ger.41.t
	desc = r56.ger.41.desc
	picture = GFX_report_event_generic_italian_fascists

	is_triggered_only = yes
	
	option = {
		name = r56.ger.41.a

	}
}

country_event = { #We botched a coup
	id = r56.ger.42
	title = r56.ger.42.t
	desc = r56.ger.42.desc
	picture = GFX_report_event_generic_soldiers_surrendering

	is_triggered_only = yes

	option = {
		name = r56.ger.42.a

	}
}

country_event = { #Germany sends military advisors
	id = r56.ger.43
	title = r56.ger.43.t
	desc = r56.ger.43.d
	picture = GFX_report_event_soviet_german_soldier_handshake

	is_triggered_only = yes

	option = { # Weclome them
		name = r56.ger.43.a
		add_ideas = GER_military_advisors
		ai_chance = { 
			base = 2
		}
	}

	option = { # Sorry, no
		name = r56.ger.43.b
		GER = {
			country_event = { id = r56.ger.44 days = 1 random_hours = 12 }
		}
		ai_chance = { 
			base = 1
		}
	}
}

country_event = { #Germany sends military advisors
	id = r56.ger.44
	title = r56.ger.44.t
	desc = r56.ger.44.d
	picture = GFX_report_event_PER_foreign_ministry

	is_triggered_only = yes

	option = { # Alright, their loss
		name = r56.ger.44.a
		ai_chance = { 
			base = 2
		}
	}
}

add_namespace = ger.civil_war

country_event = { #Commie German
	id = ger.civil_war.2
	title = ger.civil_war.2.t
	desc = ger.civil_war.2.desc
	picture = GFX_report_event_generic_sign_treaty2

	fire_only_once = no

	is_triggered_only = yes

	option = { #Yes
		ai_chance = { 
			factor = 10
		}
		name = ger.civil_war.2.a
		hidden_effect={
			set_nationality = { #mid-rank generals that dont go to Spain and are politically reliable but not too important
				target_country = FROM
				character = SOV_nikolay_vatutin
			}
			set_nationality = {
				target_country = FROM
				character = SOV_vasily_kuznetsov
			}
		}
		SOV_nikolay_vatutin = {
			custom_effect_tooltip = character_changes_country_tt
		}
		SOV_vasily_kuznetsov = {
			custom_effect_tooltip = character_changes_country_tt
		}
		add_to_variable = {
			var = GER_commie_soviet_influence
			value = 1
		}
		set_global_flag = GER_soviets_sent_advisors_to_germany
	}
	option = { #No
		name = ger.civil_war.2.b
		ai_chance = { 
			factor = 1
		}
	}
}

add_namespace = ger.renegotiate_versailles

country_event = { # Democratic Germany offers to renegotiate the treaty of Versailles
	id = ger.renegotiate_versailles.1
	title = ger.renegotiate_versailles.1.t
	desc = ger.renegotiate_versailles.1.d
	picture = GFX_report_event_gre_allied_diplomacy

	fire_only_once = no

	is_triggered_only = yes

	option = { # Sure, why not?
		ai_chance = { 
			factor = 10
		}
		name = ger.renegotiate_versailles.1.a
		diplomatic_relation = {
			country = FROM
			relation = guarantee
			active = yes
		}
		add_opinion_modifier = { target = FROM modifier = ger_abided_by_versailles }
		effect_tooltip = {
			FROM = {
				add_ideas = GER_treaty_of_versailles
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = ger.renegotiate_versailles.2 hours = 6 }
			}
		}
	}
	option = { # You wot mate?
		name = ger.renegotiate_versailles.1.b
		ai_chance = { 
			factor = 1
		}
		FROM = {
			country_event = { id = ger.renegotiate_versailles.3 hours = 6 }
		}
	}
}

country_event = { # 
	id = ger.renegotiate_versailles.2
	title = ger.renegotiate_versailles.2.t
	desc = ger.renegotiate_versailles.2.d
	picture = GFX_report_event_generic_sign_treaty3

	fire_only_once = no

	is_triggered_only = yes

	option = { # Sure, why not?
		ai_chance = { 
			factor = 10
		}
		name = ger.renegotiate_versailles.2.a
		if = {
			limit = {
				NOT = {
					has_idea = GER_treaty_of_versailles
				}
			}
			add_ideas = GER_treaty_of_versailles
		}
	}
}

country_event = { # 
	id = ger.renegotiate_versailles.3
	title = ger.renegotiate_versailles.3.t
	desc = ger.renegotiate_versailles.3.d
	picture = GFX_report_event_generic_sign_treaty2

	fire_only_once = yes

	is_triggered_only = yes

	option = { # Sure, why not?
		ai_chance = { 
			factor = 10
		}
		name = ger.renegotiate_versailles.3.a
		add_political_power = 10
	}
}

country_event = {
	id = ger_brest_litovsk.1
	title = ger_brest_litovsk.1.t
	desc = ger_brest_litovsk.1.d
	picture = GFX_report_event_soviet_german_soldier_handshake

	fire_only_once = yes

	is_triggered_only = yes

	option = { # Hell naw
		name = ger_brest_litovsk.1.a
		ai_chance = {
			factor = 10
			modifier = {
				add = 10 
				FROM = {
					strength_ratio = {
						tag = ROOT
						ratio < 0.7
					}
				}
			}
			modifier = {
				add = 5 
				FROM = {
					surrender_progress > 0.1
				}
			}
			modifier = {
				add = 5
				surrender_progress < 0.3
			}
			modifier = {
				add = 5
				surrender_progress < 0.15
			}
			modifier = {
				add = 5
				casualties_k < 700
			}
		}
		news_event = erwache_news.2
	}
	option = { # We give up
		name = ger_brest_litovsk.1.b
		ai_chance = {
			factor = 10000
			modifier = {
				add = 10
				FROM = {
					strength_ratio = {
						tag = ROOT
						ratio > 1.5
					}
				}
			}
			modifier = {
				add = 5
				FROM = {
					surrender_progress < 0.1
				}
			}
			modifier = {
				add = 5
				surrender_progress > 0.35
			}
			modifier = {
				add = 5
				surrender_progress > 0.5
			}
			modifier = {
				add = 5
				casualties_k > 1200
			}
			modifier = {
				add = 5
				casualties_k > 2000
			}
		}
		GER = {
			white_peace = SOV
		}
		### Lithuania
		every_owned_state = {
			limit = {
				is_core_of = LIT
				is_owned_by = SOV
			}
			transfer_state_to = GER
		}
		### Latvia
		every_owned_state = {
			limit = {
				is_core_of = LAT
				is_owned_by = SOV
			}
			transfer_state_to = GER
		}
		### Estonia
		every_owned_state = {
			limit = {
				is_core_of = EST
				is_owned_by = SOV
			}
			transfer_state_to = GER
		}
		### Belarus
		every_owned_state = {
			limit = {
				is_core_of = BLR
				is_owned_by = SOV
			}
			transfer_state_to = GER
		}
		### Ukraine
		every_owned_state = {
			limit = {
				is_core_of = UKR
				is_owned_by = SOV
			}
			transfer_state_to = GER
		}
		if = {
			limit = {
				137 = { is_owned_by = SOV }
			}
			GER = {
				transfer_state = 137
			}
		}
		if = {
			limit = {
				ROM = {
					is_in_faction_with = GER
				}
				78 = { is_owned_by = SOV }
			}
			ROM = {
				transfer_state = 78
			}
		}
		else_if = {
			limit = {
				78 = { is_owned_by = SOV }
			}
			GER = {
				transfer_state = 78
			}
		}
		if = {
			limit = {
				ROM = {
					is_in_faction_with = GER
				}
				80 = { is_owned_by = SOV }
			}
			ROM = {
				transfer_state = 80
			}
		}
		else_if = {
			limit = {
				80 = { is_owned_by = SOV }
			}
			GER = {
				transfer_state = 80
			}
		}
		if = {
			limit = {
				ROM = {
					is_in_faction_with = GER
				}
				766 = { is_owned_by = SOV }
			}
			ROM = {
				transfer_state = 766
			}
		}
		else_if = {
			limit = {
				766 = { is_owned_by = SOV }
			}
			GER = {
				transfer_state = 766
			}
		}
		if = {
			limit = {
				UKR = {
					exists = no
				}
			}
			GER = {
				release_puppet = UKR
			}
		}
		if = {
			limit = {
				137 = {
					is_owned_by = GER
				}
			}
			UKR = {
				transfer_state = 137
			}
			137 = {
				add_core_of = UKR
			}
		}
		if = {
			limit = {
				ROM = {
					NOT = {
						is_in_faction_with = GER
					}
				}
				766 = {
					is_owned_by = GER
				}
				UKR = {
					is_subject_of = GER
				}
			}
			UKR = {
				transfer_state = 766
			}
			766 = {
				add_core_of = UKR
			}
		}
		if = {
			limit = {
				ROM = {
					NOT = {
						is_in_faction_with = GER
					}
				}
				80 = {
					is_owned_by = GER
				}
				UKR = {
					is_subject_of = GER
				}
			}
			UKR = {
				transfer_state = 80
			}
			80 = {
				add_core_of = UKR
			}
		}
		if = {
			limit = {
				BLR = {
					exists = no
				}
			}
			GER = {
				release_puppet = BLR
			}
		}
		if = {
			limit = {
				EST = {
					exists = no
				}
			}
			GER = {
				release_puppet = EST
			}
		}
		if = {
			limit = {
				LAT = {
					exists = no
				}
			}
			GER = {
				release_puppet = LAT
			}
		}
		if = {
			limit = {
				LIT = {
					exists = no
				}
			}
			GER = {
				release_puppet = LIT
			}
		}
		if = {
			limit = {
				146 = { is_owned_by = SOV }
				FIN = {
					NOT = {
						is_in_faction_with = SOV
						has_war_with = GER
					}
				}
			}
			FIN = {
				transfer_state = 146
			}
		}
		if = {
			limit = {
				147 = { is_owned_by = SOV }
				FIN = {
					NOT = {
						is_in_faction_with = SOV
						has_war_with = GER
					}
				}
			}
			FIN = {
				transfer_state = 147
			}
		}
		if = {
			limit = {
				722 = { is_owned_by = SOV }
				FIN = {
					NOT = {
						is_in_faction_with = SOV
						has_war_with = GER
					}
				}
			}
			FIN = {
				transfer_state = 722
			}
		}
		if = {
			limit = {
				215 = { is_owned_by = SOV }
				FIN = {
					NOT = {
						is_in_faction_with = SOV
						has_war_with = GER
					}
				}
			}
			FIN = {
				transfer_state = 215
			}
		}
		if = {
			limit = {
				213 = { is_owned_by = SOV }
				FIN = {
					NOT = {
						is_in_faction_with = SOV
						has_war_with = GER
					}
				}
			}
			FIN = {
				transfer_state = 213
			}
		}
		if = {
			limit = {
				216 = { is_owned_by = SOV }
				FIN = {
					NOT = {
						is_in_faction_with = SOV
						has_war_with = GER
					}
				}
			}
			FIN = {
				transfer_state = 216
			}
		}
	}
}
country_event = {
	id = r56.ger.45
	title = r56.ger.45.t
	desc = r56.ger.45.d
	picture = GFX_report_event_GER_anglo_german_naval_treaty
	
	fire_only_once = yes

	is_triggered_only = yes

	option = { #Let's be historical
		name = r56.ger.45.a
		ai_chance = {
			factor = 0
			modifier = {
				is_historical_focus_on = yes
				add = 1000
			}
			modifier = {
				has_government = fascism
				add = 15
			}
			modifier = {
				has_government = neutrality
				add = 15
			}			
		}
		complete_national_focus = GER_denounce_the_agreement
		set_country_flag = GER_denounced_the_agreement
	}
	option = { #Let's do what they said
		name = r56.ger.45.b
		ai_chance = {
			factor = 0
			modifier = {
				is_historical_focus_on = no
				add = 10
			}
			modifier = {
				has_government = democratic
				add = 10
			}
			modifier = {
				has_government = communism
				add = 10
			}
			modifier = {
				is_in_faction_with = ENG
				add = 10
			}
		}
		complete_national_focus = GER_adhere_to_the_agreement
		set_country_flag = GER_adhere_to_the_agreement
	}
}

country_event = {			# commie leadership change
	id = r56.ger.46
	title = r56.ger.46.t
	desc = r56.ger.46.desc
	picture = GFX_report_event_SWI_assembly_hall

	is_triggered_only = yes

	option = {				# heinrich brandler
		name = r56.ger.46.a
		add_political_power = -20
		promote_character = {
			character = GER_heinrich_brandler
			ideology = marxism
		}
		set_cosmetic_tag = GER_marxist
		if = {
			limit = {
				SOV = {
					has_completed_focus = SOV_the_right_opposition
				}
			}
			add_opinion_modifier = {
				target = SOV
				modifier = large_increase
			}
			reverse_add_opinion_modifier = {
				target = SOV
				modifier = large_increase
			}
		}
		else_if = {
			limit = {
				SOV = {
					has_government = communism
				}
			}
			add_opinion_modifier = {
				target = SOV
				modifier = large_decrease
			}
			reverse_add_opinion_modifier = {
				target = SOV
				modifier = large_decrease
			}
		}
		hidden_effect = {
			news_event = {
				id = r56.ger.50
				hours = 8
			}
		}

		ai_chance = {
			base = 5
		}
	}
	option = {				# keeping thälmann
		name = r56.ger.46.b
		add_political_power = 25
		add_stability = 0.05
		GER_ernst_thalmann = {
			add_trait = {
				trait = ger_civil_war_hero
			}
		}
		if = {
			limit = {
				SOV = {
					has_government = communism
				}
			}
			add_opinion_modifier = {
				target = SOV
				modifier = large_decrease
			}
			reverse_add_opinion_modifier = {
				target = SOV
				modifier = large_decrease
			}
		}
		hidden_effect = {
			news_event = {
				id = r56.ger.49
				hours = 8
			}
		}

		ai_chance = {
			base = 10
		}
	}
	option = {				# soviet alliance
		name = r56.ger.46.c
		trigger = {
			any_country_with_original_tag = {
				original_tag_to_check = SOV
				has_government = communism
				NOT = {
					has_country_leader = {
						character = SOV_nikolay_bukharin
						ruling_only = yes
					}
				}
			}
		}
		add_stability = -0.05
		add_political_power = -50
		hidden_effect = {
			uncomplete_national_focus = {
				focus = GER_world_revolution
			}
			remove_ideas = GER_world_revolution_idea
		}
		complete_national_focus = GER_alliance_with_soviets

		ai_chance = {
			base = 1
		}
	}
}

country_event = {			# heinrich brandler arrives
	id = r56.ger.47
	title = r56.ger.47.t
	desc = r56.ger.47.desc
	picture = GFX_report_event_GER_heinrich_brandler

	fire_only_once = yes
	is_triggered_only = yes
	trigger = {
		has_civil_war = yes
	}

	option = {
		name = r56.ger.47.a
		add_popularity = {
			ideology = communism
			popularity = 0.05
		}

		custom_effect_tooltip = r56_newline
		custom_effect_tooltip = available_political_advisor
		show_ideas_tooltip = heinrich_brandler

		custom_effect_tooltip = r56_newline
		custom_effect_tooltip = kpd_gets_opposition

		set_country_flag = heinrich_brandler_arrived

		ai_chance = {
			base = 1
		}
	}
}

country_event = {			# uncontested thälmann victory
	id = r56.ger.48
	title = r56.ger.48.t
	desc = r56.ger.48.desc
	picture = GFX_report_event_GER_thalmann_meeting

	is_triggered_only = yes

	option = {
		name = r56.ger.48.a
		hidden_effect = {
			GER_ernst_thalmann = {
				add_country_leader_role = {
					character = THIS
					promote_leader = yes
					country_leader = {
						ideology = leninism
						traits = { ger_civil_war_hero }
						expire = "1941.1.1"
					}
				}
			}
			news_event = {
				id = r56.ger.49
				hours = 8
			}
		}
		effect_tooltip = {
			GER_ernst_thalmann = {
				add_country_leader_trait = ger_civil_war_hero
			}
		}

		ai_chance = {
			base = 5
		}
	}
}

news_event = {				# thälmann elected
	id = r56.ger.49
	title = r56.ger.49.t
	desc = r56.ger.49.desc
	picture = GFX_news_event_GER_thalmann_meeting

	is_triggered_only = yes
	fire_for_sender = no

	major = yes
	show_major = {
		OR = {
			capital_scope = {
				is_on_continent = europe
			}
			faction_leader = {
				capital_scope = {
					is_on_continent = europe
				}
			}
			is_major = yes
			has_government = communism
		}
	}

	option = {				# not bad commies
		name = r56.ger.49.a
		trigger = {
			NOT = {
				has_country_leader_ideology = stalinism
				has_country_leader_ideology = leninism
				has_country_leader_ideology = anti_revisionism
				has_country_leader_ideology = juche
				has_country_leader_ideology = national_bolshevism
			}
		}

		ai_chance = {
			base = 5
		}
	}
	option = {				# bad commies
		name = r56.ger.49.b
		trigger = {
			OR = {
				tag = SOV
				has_country_leader_ideology = stalinism
				has_country_leader_ideology = leninism
				has_country_leader_ideology = anti_revisionism
				has_country_leader_ideology = juche
				has_country_leader_ideology = national_bolshevism
			}
		}

		ai_chance = {
			base = 5
		}
	}
}

news_event = {				# brandler elected
	id = r56.ger.50
	title = r56.ger.50.t
	desc = r56.ger.50.desc
	picture = GFX_news_event_GER_heinrich_brandler

	is_triggered_only = yes
	fire_for_sender = no

	major = yes
	show_major = {
		OR = {
			capital_scope = {
				is_on_continent = europe
			}
			faction_leader = {
				capital_scope = {
					is_on_continent = europe
				}
			}
			is_major = yes
			has_government = communism
		}
	}

	option = {				# not bad commies
		name = r56.ger.50.a
		trigger = {
			NOT = {
				has_country_leader_ideology = stalinism
				has_country_leader_ideology = leninism
				has_country_leader_ideology = anti_revisionism
				has_country_leader_ideology = juche
				has_country_leader_ideology = national_bolshevism
			}
		}

		ai_chance = {
			base = 5
		}
	}
	option = {				# bad commies
		name = r56.ger.50.b
		trigger = {
			OR = {
				tag = SOV
				has_country_leader_ideology = stalinism
				has_country_leader_ideology = leninism
				has_country_leader_ideology = anti_revisionism
				has_country_leader_ideology = juche
				has_country_leader_ideology = national_bolshevism
			}
		}

		ai_chance = {
			base = 5
		}
	}
}

news_event = {				# communist german-soviet alliance
	id = r56.ger.51
	title = r56.ger.51.t
	desc = r56.ger.51.desc
	picture = GFX_news_event_GER_german_soviet_pact_communist

	is_triggered_only = yes
	fire_for_sender = no

	major = yes
	show_major = {
		NOT = {
			OR = {
				tag = SOV
				tag = GER
			}
		}
	}

	option = {				# stalinists, rest of world
		name = r56.ger.51.a
		trigger = {
			OR = {
				has_country_leader_ideology = stalinism
				NOT = {
					has_government = communism
				}
			}
		}

		ai_chance = {
			base = 5
		}
	}
	option = {				# non-stalinist communists
		name = r56.ger.51.b
		trigger = {
			NOT = {
				has_country_leader_ideology = stalinism
			}
			has_government = communism
		}

		ai_chance = {
			base = 5
		}
	}
}

country_event = {			# soviets accept communist alliance
	id = r56.ger.52
	title = r56.ger.52.t
	desc = r56.ger.52.desc
	picture = GFX_report_event_GER_german_soviet_pact_communist

	is_triggered_only = yes

	option = {
		name = r56.ger.52.a

		custom_effect_tooltip = ger_cominform_tt
		custom_effect_tooltip = r56_newline
		add_opinion_modifier = {
			target = SOV
			modifier = cominform
		}

		ai_chance = {
			base = 5
		}
	}
}

country_event = {			# SOV; alliance proposal
	id = r56.ger.53
	title = r56.ger.53.t
	desc = r56.ger.53.desc
	picture = GFX_report_event_GER_german_soviet_pact_communist

	is_triggered_only = yes

	option = {				# accept
		name = r56.ger.53.a

		custom_effect_tooltip = cominform_tt
		custom_effect_tooltip = r56_newline
		add_opinion_modifier = {
			target = GER
			modifier = cominform
		}
		hidden_effect = {
			set_faction_name = "cominform"
			GER = {
				if = {
					limit = {
						is_faction_leader = yes
					}
					dismantle_faction = yes
				}
				else_if = {
					limit = {
						is_in_faction = yes
					}
					remove_from_faction = THIS
				}
				else = {
					SOV = {
						add_to_faction = GER
					}
				}
				country_event = {
					id = r56.ger.52
					hours = 8
				}
			}
			news_event = {
				id = r56.ger.51
				hours = 12
			}
			set_global_flag = cominform_formed
		}

		ai_chance = {
			base = 5
		}
	}
	option = {				# refuse
		name = r56.ger.53.b

		reverse_add_opinion_modifier = {
			target = GER
			modifier = cominform_denied
		}

		ai_chance = {
			base = 0
		}
	}
}
country_event = {			# joint exercises request
	id = r56.ger.54
	title = r56.ger.54.t
	desc = r56.ger.54.desc
	picture = GFX_report_event_military_planning

	is_triggered_only = yes

	option = {				# accept
		name = r56.ger.54.a
		GER = {
			country_event = {
				id = r56.ger.55
				hours = 4
			}
		}
		add_ideas = GER_nva_joint_military_exercise_idea
		hidden_effect = {
			add_threat = 2
		}
	}
	option = {				# refuse
		name = r56.ger.54.b
		GER = {
			country_event = {
				id = r56.ger.56
				hours = 4
			}
		}
	}
}
country_event = {			# joint exercise accepted
	id = r56.ger.55
	title = r56.ger.55.t
	desc = r56.ger.55.desc
	picture = GFX_report_event_military_planning

	is_triggered_only = yes

	option = {
		name = r56.ger.55.a
		add_ideas = GER_nva_joint_military_exercise_idea
	}
}
country_event = {			# joint exercise refused
	id = r56.ger.56
	title = r56.ger.56.t
	desc = r56.ger.56.desc
	picture = GFX_report_event_military_planning

	is_triggered_only = yes

	option = {
		name = r56.ger.56.a
		add_political_power = -5
	}
}


country_event = {			# demo elections
	id = r56.ger.60
	title = r56.ger.60.t
	desc = r56.ger.60.desc
	picture = GFX_report_event_GER_ballot

	is_triggered_only = yes
	

	

	option = {			# Zentrum
		name = r56.ger.60.a

		trigger = {
			if = {
				limit = {
					NOT = {
						has_country_flag = GER_demo_coalition
					}
				}
				NOT = {
					has_country_leader = {
						character = GER_konrad_adenauer
						ruling_only = yes
					}
				}
			}
		}

		clr_country_flag = GER_demo_coalition
		if = {
			limit = {
				NOT = {
					has_country_leader = {
						character = GER_konrad_adenauer
						ruling_only = yes
					}
				}
			}
			promote_character = {
				character = GER_konrad_adenauer
				ideology = conservatism
			}
		}

		add_political_power = 50

		set_variable = {
			var = root.gov_count
			value = 0
		}

		set_party_name = {
			ideology = democratic
			long_name = GER_zentrum_long
			name = GER_zentrum
		}

		ai_chance = {
			base = 5
		}
	}
	option = {			# SPD
		name = r56.ger.60.b

		trigger = {
			if = {
				limit = {
					NOT = {
						has_country_flag = GER_demo_coalition
					}
				}
				NOT = {
					has_country_leader = {
						character = GER_otto_wels
						ruling_only = yes
					}
					has_country_leader = {
						character = GER_hans_vogel
						ruling_only = yes
					}
					has_country_leader = {
						character = GER_kurt_schumacher
						ruling_only = yes
					}
				}
			}
		}

		clr_country_flag = GER_demo_coalition
		if = {
			limit = {
				has_character = GER_otto_wels
			}
			promote_character = {
				character = GER_otto_wels
				ideology = socialism
			}
		}
		else_if = {
			limit = {
				has_character = GER_hans_vogel
			}
			promote_character = {
				character = GER_hans_vogel
				ideology = socialism
			}
		}
		else = {
			promote_character = {
				character = GER_kurt_schumacher
				ideology = socialism
			}
		}

		add_political_power = 50

		set_variable = {
			var = root.gov_count
			value = 0
		}

		set_party_name = {
			ideology = democratic
			long_name = GER_spd_long
			name = GER_spd
		}

		ai_chance = {
			base = 5
		}
	}
	option = {			# Zentrum led coalition
		name = r56.ger.60.c

		trigger = {
			neutrality > party_popularity@communism
			if = {
				limit = {
					has_country_flag = GER_demo_coalition
				}
				NOT = {
					has_country_leader = {
						character = GER_konrad_adenauer
						ruling_only = yes
					}
				}
			}
		}

		set_country_flag = GER_demo_coalition
		if = {
			limit = {
				NOT = {
					has_country_leader = {
						character = GER_konrad_adenauer
						ruling_only = yes
					}
				}
			}
			promote_character = {
				character = GER_konrad_adenauer
				ideology = conservatism
			}
		}

		add_political_power = 25
		add_stability = 0.025

		set_variable = {
			var = root.gov_count
			value = 0
		}
		
		set_party_name = {
			ideology = democratic
			long_name = GER_zentrum_coalition_long
			name = GER_zentrum_coalition
		}

		ai_chance = {
			base = 5
		}
	}
	option = {			# SPD led coalition
		name = r56.ger.60.d

		trigger = {
			communism > party_popularity@neutrality
			if = {
				limit = {
					has_country_flag = GER_demo_coalition
				}
				NOT = {
					has_country_leader = {
						character = GER_otto_wels
						ruling_only = yes
					}
					has_country_leader = {
						character = GER_hans_vogel
						ruling_only = yes
					}
					has_country_leader = {
						character = GER_kurt_schumacher
						ruling_only = yes
					}
				}
			}
		}

		set_country_flag = GER_demo_coalition
		if = {
			limit = {
				has_character = GER_otto_wels
			}
			if = {
				limit = {
					NOT = {
						has_country_leader = {
							character = GER_otto_wels
							ruling_only = yes
						}
					}
				}
				promote_character = {
					character = GER_otto_wels
					ideology = socialism
				}
			}
		}
		else_if = {
			limit = {
				has_character = GER_hans_vogel
			}
			if = {
				limit = {
					NOT = {
						has_country_leader = {
							character = GER_hans_vogel
							ruling_only = yes
						}
					}
				}
				promote_character = {
					character = GER_hans_vogel
					ideology = socialism
				}
			}
		}
		else = {
			if = {
				limit = {
					NOT = {
						has_country_leader = {
							character = GER_kurt_schumacher
							ruling_only = yes
						}
					}
				}
				promote_character = {
					character = GER_kurt_schumacher
					ideology = socialism
				}
			}
		}

		add_political_power = 25
		add_stability = 0.025

		set_variable = {
			var = root.gov_count
			value = 0
		}
		
		set_party_name = {
			ideology = democratic
			long_name = GER_spd_coalition_long
			name = GER_spd_coalition
		}

		ai_chance = {
			base = 5
		}
	}
	option = {			# maintain  current government
		name = r56.ger.60.e

		ai_chance = {
			base = 10
			modifier = {
				factor = 0
				check_variable = {
					var = root.gov_count
					value = 2
					compare = greater_than
				}
			}
		}

		add_to_variable = {
			var = root.gov_count
			value = 1
		}
		if = {
			limit = {
				check_variable = {
					var = root.gov_count
					value = 2
					compare = less_than
				}
			}
			add_stability = 0.05
		}
		else_if = {
			limit = {
				check_variable = {
					var = root.gov_count
					value = 2
					compare = greater_than_or_equals
				}
				neutrality < 0.30
			}
			add_popularity = {
				ideology = neutrality
				popularity = 0.10
			}
			add_stability = -0.05
			custom_effect_tooltip = gov_count_middle
		}
		else = {		# presidental dictatorship
			if = {
				limit = {
					has_country_leader = {
						character = GER_konrad_adenauer
						ruling_only = yes
					}
				}
				remove_country_leader_role = {
					character = GER_konrad_adenauer
					ideology = conservatism
				}
				add_country_leader_role = {
					character = GER_konrad_adenauer
					promote_leader = yes
					country_leader = {
						ideology = oligarchic_democracy
						traits = {
							conservative_grandee
							r56_trait_opposed_to_fascism
						}
					}
				}
			}
			if = {
				limit = {
					has_country_leader = {
						character = GER_otto_wels
						ruling_only = yes
					}
				}
				remove_country_leader_role = {
					character = GER_otto_wels
					ideology = socialism
				}
				add_country_leader_role = {
					character = GER_otto_wels
					promote_leader = yes
					country_leader = {
						ideology = oligarchic_democracy
						traits = {
							staunch_anti_fascist
						}
					}
				}
			}
			if = {
				limit = {
					has_country_leader = {
						character = GER_hans_vogel
						ruling_only = yes
					}
				}
				remove_country_leader_role = {
					character = GER_hans_vogel
					ideology = socialism
				}
				add_country_leader_role = {
					character = GER_hans_vogel
					promote_leader = yes
					country_leader = {
						ideology = oligarchic_democracy
						traits = {
							union_organizer
						}
					}
				}
			}
			if = {
				limit = {
					has_country_leader = {
						character = GER_kurt_schumacher
						ruling_only = yes
					}
				}
				remove_country_leader_role = {
					character = GER_kurt_schumacher
					ideology = socialism
				}
				add_country_leader_role = {
					character = GER_kurt_schumacher
					promote_leader = yes
					country_leader = {
						ideology = oligarchic_democracy
						traits = {
							anti_communist
						}
					}
				}
			}

			
			
		}
	}
}

country_event = {
	id = r56.ger.61			# Otto Wels, SPD; country leader
	title = r56.ger.61.t
	desc = r56.ger.61.desc
	picture = GFX_report_event_GER_otto_wels

	is_triggered_only = yes
	fire_only_once = yes
	trigger = {
		has_country_leader = {
			character = GER_otto_wels
			ruling_only = yes
		}
	}

	option = {
		name = r56.ger.61.a
		kill_country_leader = yes
		promote_character = GER_hans_vogel
		add_stability = -0.05
	}
}
# leaders dying, SPD really had a bad run
country_event = {
	id = r56.ger.62		# Otto Wels, SPD; not country leader

	hidden = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_country_leader = {
				character = GER_otto_wels
				ruling_only = yes
			}
		}
	}

	option = {
		name = r56.ger.62.a
		GER_otto_wels = {
			retire = yes
		}
	}
}

country_event = {
	id = r56.ger.63		# Hans Vogel, SPD; country leader
	title = r56.ger.63.t
	desc = r56.ger.63.desc
	picture = GFX_report_event_GER_hans_vogel

	is_triggered_only = yes
	fire_only_once = yes
	trigger = {
		has_country_leader = {
			character = GER_hans_vogel
			ruling_only = yes
		}
	}

	option = {
		name = r56.ger.63.a
		kill_country_leader = yes
		promote_character = GER_kurt_schumacher
		add_stability = -0.02
	}
}

country_event = {
	id = r56.ger.64		# Hans Vogel, SPD; not country leader

	hidden = yes
	is_triggered_only = yes
	
	trigger = {
		has_country_leader = {
			character = GER_hans_vogel
			ruling_only = yes
		}
	}
	
	option = {
		name = r56.ger.64.a
		GER_hans_vogel = {
			retire = yes
		}
	}
}